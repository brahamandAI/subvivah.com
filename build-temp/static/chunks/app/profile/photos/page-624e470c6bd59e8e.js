(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[638],{3734:function(e,t,r){Promise.resolve().then(r.bind(r,40389))},57977:function(e,t,r){"use strict";r.d(t,{Z:function(){return u}});var l=r(64090);/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),o=e=>{let t=a(e);return t.charAt(0).toUpperCase()+t.slice(1)},n=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()},i=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,l.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:o,className:d="",children:u,iconNode:p,...h}=e;return(0,l.createElement)("svg",{ref:t,...c,width:s,height:s,stroke:r,strokeWidth:o?24*Number(a)/Number(s):a,className:n("lucide",d),...!u&&!i(h)&&{"aria-hidden":"true"},...h},[...p.map(e=>{let[t,r]=e;return(0,l.createElement)(t,r)}),...Array.isArray(u)?u:[u]])}),u=(e,t)=>{let r=(0,l.forwardRef)((r,a)=>{let{className:i,...c}=r;return(0,l.createElement)(d,{ref:a,iconNode:t,className:n("lucide-".concat(s(o(e))),"lucide-".concat(e),i),...c})});return r.displayName=o(e),r}},97336:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});let l=(0,r(57977).Z)("camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},49108:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});let l=(0,r(57977).Z)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},37805:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});let l=(0,r(57977).Z)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},55211:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});let l=(0,r(57977).Z)("heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},52235:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});let l=(0,r(57977).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},20703:function(e,t,r){"use strict";r.d(t,{default:function(){return s.a}});var l=r(67447),s=r.n(l)},47907:function(e,t,r){"use strict";var l=r(15313);r.o(l,"usePathname")&&r.d(t,{usePathname:function(){return l.usePathname}}),r.o(l,"useRouter")&&r.d(t,{useRouter:function(){return l.useRouter}}),r.o(l,"useSearchParams")&&r.d(t,{useSearchParams:function(){return l.useSearchParams}})},67447:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{getImageProps:function(){return n},default:function(){return i}});let l=r(84096),s=r(38630),a=r(81749),o=l._(r(10536)),n=e=>{let{props:t}=(0,s.getImgProps)(e,{defaultLoader:o.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}},i=a.Image},40389:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var l=r(3827),s=r(64090),a=r(20703),o=r(47907),n=r(69574),i=r(49108),c=r(57977);let d=(0,c.Z)("upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var u=r(37805),p=r(55211);let h=(0,c.Z)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var x=r(52235),m=r(97336),f=(0,n.Z)(function(){let[e,t]=(0,s.useState)(null),[r,n]=(0,s.useState)(!0),[c,f]=(0,s.useState)(null),[g,b]=(0,s.useState)(!1),[v,w]=(0,s.useState)(null),[y,j]=(0,s.useState)(""),[N,k]=(0,s.useState)(!1),[C,P]=(0,s.useState)(null),[S,Z]=(0,s.useState)(new Set),[z,L]=(0,s.useState)(0),[E,A]=(0,s.useState)("idle"),U=(0,o.useRouter)();(0,s.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/auth/me");if(e.ok){let r=await e.json();t(r.user)}}catch(e){console.error("Error fetching user:",e)}finally{n(!1)}})()},[]);let _=()=>{f(null)},M=t=>{t.stopPropagation(),null!==c&&(null==e?void 0:e.photos)&&f((c-1+e.photos.length)%e.photos.length)},O=t=>{t.stopPropagation(),null!==c&&(null==e?void 0:e.photos)&&f((c+1)%e.photos.length)},R=async()=>{if(v){k(!0),A("uploading");try{let e=new FormData;if(e.append("file",v),e.append("caption",y),(await fetch("/api/photos/upload",{method:"POST",body:e})).ok){A("success");let e=await fetch("/api/auth/me");if(e.ok){let r=await e.json();t(r.user)}b(!1),w(null),j("")}else A("error")}catch(e){A("error"),console.error("Error uploading photo:",e)}finally{k(!1)}}},D=async r=>{if(null==e?void 0:e.photos)try{if((await fetch("/api/photos/delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({photoUrl:e.photos[r].url})})).ok){let e=await fetch("/api/auth/me");if(e.ok){let r=await e.json();t(r.user)}f(null)}}catch(e){console.error("Error deleting photo:",e)}},W=e=>{Z(t=>{let r=new Set(t);return r.has(e)?r.delete(e):r.add(e),r})};if(r)return(0,l.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-indigo-950 via-purple-900 to-indigo-950 flex items-center justify-center relative overflow-hidden",children:[(0,l.jsx)("div",{className:"absolute inset-0 backdrop-blur-md z-0"}),(0,l.jsxs)("div",{className:"relative z-10 flex flex-col items-center",children:[(0,l.jsxs)("svg",{className:"animate-spin h-14 w-14 text-purple-300 mb-4",viewBox:"0 0 50 50",children:[(0,l.jsx)("circle",{className:"opacity-20",cx:"25",cy:"25",r:"20",stroke:"currentColor",strokeWidth:"5",fill:"none"}),(0,l.jsx)("circle",{className:"opacity-70",cx:"25",cy:"25",r:"20",stroke:"currentColor",strokeWidth:"5",fill:"none",strokeDasharray:"31.4 94.2"})]}),(0,l.jsx)("span",{className:"text-purple-200 text-lg font-medium animate-pulse",children:"Loading photos..."})]})]});if(!e)return null;let T=e.photos||[];return T[z],(0,l.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-indigo-950 via-purple-900 to-indigo-950 py-10 flex flex-col items-center relative overflow-hidden",children:[(0,l.jsx)("div",{className:"absolute top-4 right-8 animate-pulse text-amber-200 text-4xl z-10",children:"\uD83D\uDCF8"}),(0,l.jsxs)("div",{className:"w-full max-w-2xl mx-auto px-2 sm:px-4 lg:px-6",children:[(0,l.jsxs)("div",{className:"mb-8 flex flex-col gap-2 items-start w-full",children:[(0,l.jsxs)("button",{onClick:()=>U.back(),className:"flex items-center text-purple-200 hover:text-purple-100 mb-1 transition-colors",children:[(0,l.jsx)(i.Z,{className:"w-5 h-5 mr-1"}),"Back to Profile"]}),(0,l.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,l.jsxs)("div",{className:"text-left",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Photo Gallery"}),(0,l.jsx)("p",{className:"text-purple-200 mt-1 text-base",children:"Swipe or use arrows to browse your photos"})]}),(0,l.jsxs)("button",{onClick:()=>b(!0),className:"flex items-center gap-2 px-4 py-2 bg-purple-500/20 text-purple-200 rounded-lg hover:bg-purple-500/30 transition-colors border border-purple-400/30 shadow-md",children:[(0,l.jsx)(d,{className:"w-5 h-5"}),"Upload Photo"]})]})]}),T.length>0?(0,l.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-6",children:T.map((e,t)=>(0,l.jsxs)("div",{className:"relative group rounded-xl overflow-hidden shadow-lg bg-white/10 hover:shadow-xl transition-all cursor-pointer flex flex-col border border-purple-400/30 hover:bg-white/20",onClick:()=>f(t),children:[(0,l.jsx)("div",{className:"relative w-full aspect-square bg-gradient-to-br from-purple-500/20 to-pink-500/20",children:(0,l.jsx)(a.default,{src:e.url,alt:"Photo ".concat(t+1),fill:!0,className:"object-cover w-full h-full transition-transform duration-200 group-hover:scale-105",sizes:"300px"})}),(0,l.jsx)("div",{className:"p-2 text-center bg-gradient-to-t from-purple-900/90 to-purple-900/60 backdrop-blur-sm",children:(0,l.jsx)("p",{className:"text-sm text-purple-200 truncate min-h-[1.5em]",children:e.caption||(0,l.jsx)("span",{className:"text-purple-300/50",children:"No caption"})})})]},t))}):(0,l.jsx)("div",{className:"text-center text-gray-400 py-12",children:"No photos uploaded yet."}),null!==c&&T.length>0&&(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",onClick:_,children:(0,l.jsxs)("div",{className:"relative flex flex-col items-center bg-gradient-to-br from-indigo-950/95 via-purple-900/95 to-indigo-950/95 backdrop-blur-lg rounded-2xl shadow-xl p-4 transition-all duration-300 max-w-2xl w-full border border-purple-400/30",onClick:e=>e.stopPropagation(),onTouchStart:e=>{P(e.touches[0].clientX)},onTouchEnd:e=>{if(!C)return;let t=C-e.changedTouches[0].clientX;Math.abs(t)>50&&(t>0?O(e):M(e)),P(null)},style:{minHeight:"480px"},children:[T.length>1&&(0,l.jsx)("div",{className:"absolute left-0 top-1/2 -translate-y-1/2 w-1/4 h-3/4 flex items-center justify-end z-10 pointer-events-none",style:{filter:"blur(4px)",opacity:.5},children:(0,l.jsxs)("div",{className:"relative w-24 h-40 rounded-xl overflow-hidden bg-gradient-to-br from-purple-100 to-pink-100 shadow-md",children:[(0,l.jsx)(a.default,{src:T[(c-1+T.length)%T.length].url,alt:"Previous",fill:!0,className:"object-cover",sizes:"100px"}),(0,l.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-white/80 to-transparent"})]})}),T.length>1&&(0,l.jsx)("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 w-1/4 h-3/4 flex items-center justify-start z-10 pointer-events-none",style:{filter:"blur(4px)",opacity:.5},children:(0,l.jsxs)("div",{className:"relative w-24 h-40 rounded-xl overflow-hidden bg-gradient-to-br from-purple-100 to-pink-100 shadow-md",children:[(0,l.jsx)(a.default,{src:T[(c+1)%T.length].url,alt:"Next",fill:!0,className:"object-cover",sizes:"100px"}),(0,l.jsx)("div",{className:"absolute inset-0 bg-gradient-to-l from-white/80 to-transparent"})]})}),(0,l.jsx)("button",{className:"absolute left-2 top-1/2 -translate-y-1/2 bg-white/80 hover:bg-purple-100 text-purple-700 rounded-full p-2 z-20 shadow-md",onClick:M,"aria-label":"Previous photo",style:{transition:"background 0.2s"},children:(0,l.jsx)(i.Z,{className:"w-8 h-8"})}),(0,l.jsx)("button",{className:"absolute right-2 top-1/2 -translate-y-1/2 bg-white/80 hover:bg-purple-100 text-purple-700 rounded-full p-2 z-20 shadow-md",onClick:O,"aria-label":"Next photo",style:{transition:"background 0.2s"},children:(0,l.jsx)(u.Z,{className:"w-8 h-8"})}),(0,l.jsx)("div",{className:"w-full aspect-[4/5] max-h-[400px] relative bg-gradient-to-br from-purple-100 to-pink-100 rounded-xl overflow-hidden flex items-center justify-center transition-all duration-300",children:(0,l.jsx)(a.default,{src:T[c].url,alt:"Photo ".concat(c+1),fill:!0,className:"object-contain",sizes:"400px",priority:!0})}),(0,l.jsx)("button",{className:"mt-6 mb-2 bg-white/80 rounded-full p-3 shadow-md hover:bg-pink-100 transition-colors ".concat(S.has(c)?"text-pink-600":"text-gray-400"),onClick:()=>W(c),"aria-label":"Like photo",children:(0,l.jsx)(p.Z,{className:"w-8 h-8 transition-transform ".concat(S.has(c)?"scale-110 fill-pink-500":""),fill:S.has(c)?"#ec4899":"none"})}),(0,l.jsx)("div",{className:"w-full text-center px-2",children:(0,l.jsx)("p",{className:"text-lg text-gray-800 font-medium min-h-[2em] break-words whitespace-pre-line bg-gradient-to-t from-white/80 to-transparent rounded-lg py-2 px-3 shadow-sm inline-block",children:T[c].caption||(0,l.jsx)("span",{className:"text-gray-400",children:"No caption"})})}),(0,l.jsxs)("div",{className:"mt-2 text-sm text-gray-400",children:[c+1," / ",T.length]}),(0,l.jsxs)("button",{className:"mt-4 flex items-center gap-2 px-4 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors",onClick:()=>D(c),children:[(0,l.jsx)(h,{className:"w-5 h-5"}),"Delete Photo"]}),(0,l.jsx)("button",{className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700 bg-white/80 rounded-full p-2 z-30",onClick:_,"aria-label":"Close modal",children:(0,l.jsx)(x.Z,{className:"w-6 h-6"})})]})}),g&&(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold",children:"Upload Photo"}),(0,l.jsx)("button",{onClick:()=>b(!1),className:"text-gray-500 hover:text-gray-700",children:(0,l.jsx)(x.Z,{className:"w-6 h-6"})})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:v?(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("div",{className:"relative w-[200px] h-[200px] mx-auto",children:(0,l.jsx)(a.default,{src:URL.createObjectURL(v),alt:"Preview",fill:!0,className:"rounded-lg object-cover",sizes:"200px"})}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:v.name})]}):(0,l.jsxs)("label",{className:"cursor-pointer",children:[(0,l.jsx)(m.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Click to select a photo"}),(0,l.jsx)("input",{type:"file",className:"hidden",accept:"image/*",onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];r&&w(r)}})]})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Caption"}),(0,l.jsx)("textarea",{value:y,onChange:e=>j(e.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",rows:3,placeholder:"Add a caption to your photo..."})]}),(0,l.jsx)("button",{onClick:R,disabled:!v||N,className:"w-full py-2 px-4 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed",children:N?"Uploading...":"Upload Photo"}),"uploading"===E&&(0,l.jsx)("div",{className:"text-center text-purple-600 my-2",children:"Uploading..."}),"success"===E&&(0,l.jsx)("div",{className:"text-center text-green-600 my-2",children:"Upload successful!"}),"error"===E&&(0,l.jsx)("div",{className:"text-center text-red-600 my-2",children:"Upload failed. Please try again."})]})]})})]})]})})},69574:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var l=r(3827),s=r(64090),a=r(47907);function o(e){return function(t){let[r,o]=(0,s.useState)(!0),[n,i]=(0,s.useState)(!1),[c,d]=(0,s.useState)(null);return((0,a.useRouter)(),(0,s.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/auth/me"),t=await e.json();t.isAuthenticated&&t.user?(i(!0),d(t.user)):(i(!1),d(null),"function"==typeof window.showLoginPopup&&window.showLoginPopup())}catch(e){console.error("Auth check error:",e),i(!1),d(null),"function"==typeof window.showLoginPopup&&window.showLoginPopup()}finally{o(!1)}})()},[]),r)?(0,l.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-indigo-950 via-purple-900 to-indigo-950 flex items-center justify-center relative overflow-hidden",children:[(0,l.jsx)("div",{className:"absolute inset-0 backdrop-blur-md z-0"}),(0,l.jsxs)("div",{className:"relative z-10 flex flex-col items-center",children:[(0,l.jsxs)("svg",{className:"animate-spin h-14 w-14 text-purple-300 mb-4",viewBox:"0 0 50 50",children:[(0,l.jsx)("circle",{className:"opacity-20",cx:"25",cy:"25",r:"20",stroke:"currentColor",strokeWidth:"5",fill:"none"}),(0,l.jsx)("circle",{className:"opacity-70",cx:"25",cy:"25",r:"20",stroke:"currentColor",strokeWidth:"5",fill:"none",strokeDasharray:"31.4 94.2"})]}),(0,l.jsx)("span",{className:"text-purple-200 text-lg font-medium animate-pulse",children:"Loading..."})]})]}):n&&c?(0,l.jsx)(e,{...t,user:c}):null}}}},function(e){e.O(0,[1749,2971,8069,1744],function(){return e(e.s=3734)}),_N_E=e.O()}]);