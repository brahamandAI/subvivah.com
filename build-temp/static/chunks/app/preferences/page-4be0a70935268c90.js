(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2509],{74197:function(e,r,s){Promise.resolve().then(s.bind(s,37946))},47907:function(e,r,s){"use strict";var n=s(15313);s.o(n,"usePathname")&&s.d(r,{usePathname:function(){return n.usePathname}}),s.o(n,"useRouter")&&s.d(r,{useRouter:function(){return n.useRouter}}),s.o(n,"useSearchParams")&&s.d(r,{useSearchParams:function(){return n.useSearchParams}})},37946:function(e,r,s){"use strict";s.r(r);var n=s(3827),l=s(64090),a=s(47907),o=s(69574);r.default=(0,o.Z)(function(){let e=(0,a.useRouter)(),[r,s]=(0,l.useState)({ageFrom:null,ageTo:null,heightFrom:null,heightTo:null,maritalStatus:null,religion:null,caste:null,education:null,occupation:null,location:null,income:null}),[o,t]=(0,l.useState)(!0),[i,c]=(0,l.useState)(!1),[d,u]=(0,l.useState)(null),[h,m]=(0,l.useState)(null),[p,g]=(0,l.useState)(null);(0,l.useEffect)(()=>{x()},[]);let x=async()=>{try{t(!0);let r=await fetch("/api/auth/me");if(!r.ok){e.push("/login");return}let n=await r.json();g(n.user.id);let l=await fetch("/api/preferences?userId=".concat(n.user.id));if(l.ok){let e=await l.json();s(e)}else if(404===l.status)console.log("No preferences found - will create new ones");else throw Error("Failed to fetch preferences")}catch(e){console.error("Error fetching data:",e),u("Failed to load preferences. Please try again.")}finally{t(!1)}},f=async s=>{if(s.preventDefault(),u(null),m(null),r.ageFrom&&r.ageTo&&r.ageFrom>r.ageTo){u('Age "From" must be less than Age "To"');return}if(!p){u("User not authenticated");return}c(!0);try{let s=await fetch("/api/preferences",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:p,...r})}),n=await s.json();if(!s.ok)throw Error(n.error||"Failed to save preferences");m("Preferences saved successfully!"),setTimeout(()=>{e.push("/matches")},2e3)}catch(e){console.error("Error saving preferences:",e),u(e instanceof Error?e.message:"Failed to save preferences")}finally{c(!1)}};return o?(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-pink-500"})}):(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,n.jsx)("div",{className:"max-w-3xl mx-auto",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Partner Preferences"}),d&&(0,n.jsx)("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md",children:(0,n.jsx)("p",{className:"text-sm text-red-600",children:d})}),h&&(0,n.jsx)("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-md",children:(0,n.jsx)("p",{className:"text-sm text-green-600",children:h})}),(0,n.jsxs)("form",{onSubmit:f,className:"space-y-6",children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Age Range"}),(0,n.jsxs)("div",{className:"mt-1 grid grid-cols-2 gap-4",children:[(0,n.jsx)("input",{type:"number",value:r.ageFrom||"",onChange:e=>s({...r,ageFrom:parseInt(e.target.value)||null}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-pink-500 focus:ring-pink-500",placeholder:"From"}),(0,n.jsx)("input",{type:"number",value:r.ageTo||"",onChange:e=>s({...r,ageTo:parseInt(e.target.value)||null}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-pink-500 focus:ring-pink-500",placeholder:"To"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Height Range"}),(0,n.jsxs)("div",{className:"mt-1 grid grid-cols-2 gap-4",children:[(0,n.jsx)("input",{type:"text",value:r.heightFrom||"",onChange:e=>s({...r,heightFrom:e.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-pink-500 focus:ring-pink-500",placeholder:"From (e.g., 5'6)"}),(0,n.jsx)("input",{type:"text",value:r.heightTo||"",onChange:e=>s({...r,heightTo:e.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-pink-500 focus:ring-pink-500",placeholder:"To (e.g., 6'0)"})]})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Marital Status"}),(0,n.jsxs)("select",{value:r.maritalStatus||"",onChange:e=>s({...r,maritalStatus:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-pink-500 focus:ring-pink-500",children:[(0,n.jsx)("option",{value:"",children:"Select marital status"}),(0,n.jsx)("option",{value:"never_married",children:"Never Married"}),(0,n.jsx)("option",{value:"divorced",children:"Divorced"}),(0,n.jsx)("option",{value:"widowed",children:"Widowed"}),(0,n.jsx)("option",{value:"awaiting_divorce",children:"Awaiting Divorce"})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Religion"}),(0,n.jsxs)("select",{value:r.religion||"",onChange:e=>s({...r,religion:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-pink-500 focus:ring-pink-500",children:[(0,n.jsx)("option",{value:"",children:"Select Religion"}),(0,n.jsx)("option",{value:"hindu",children:"Hindu"}),(0,n.jsx)("option",{value:"muslim",children:"Muslim"}),(0,n.jsx)("option",{value:"christian",children:"Christian"}),(0,n.jsx)("option",{value:"sikh",children:"Sikh"}),(0,n.jsx)("option",{value:"jain",children:"Jain"}),(0,n.jsx)("option",{value:"buddhist",children:"Buddhist"}),(0,n.jsx)("option",{value:"other",children:"Other"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Caste"}),(0,n.jsx)("input",{type:"text",value:r.caste||"",onChange:e=>s({...r,caste:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-pink-500 focus:ring-pink-500",placeholder:"Enter preferred caste"})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Education"}),(0,n.jsxs)("select",{value:r.education||"",onChange:e=>s({...r,education:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-pink-500 focus:ring-pink-500",children:[(0,n.jsx)("option",{value:"",children:"Select Education"}),(0,n.jsx)("option",{value:"B.Tech",children:"B.Tech"}),(0,n.jsx)("option",{value:"MBBS",children:"MBBS"}),(0,n.jsx)("option",{value:"B.Com",children:"B.Com"}),(0,n.jsx)("option",{value:"BBA",children:"BBA"}),(0,n.jsx)("option",{value:"MBA",children:"MBA"}),(0,n.jsx)("option",{value:"MCA",children:"MCA"}),(0,n.jsx)("option",{value:"B.Sc",children:"B.Sc"}),(0,n.jsx)("option",{value:"M.Sc",children:"M.Sc"}),(0,n.jsx)("option",{value:"Ph.D",children:"Ph.D"}),(0,n.jsx)("option",{value:"CA",children:"CA"}),(0,n.jsx)("option",{value:"LLB",children:"LLB"}),(0,n.jsx)("option",{value:"B.Arch",children:"B.Arch"}),(0,n.jsx)("option",{value:"BDS",children:"BDS"}),(0,n.jsx)("option",{value:"B.Pharm",children:"B.Pharm"}),(0,n.jsx)("option",{value:"M.Tech",children:"M.Tech"}),(0,n.jsx)("option",{value:"high_school",children:"High School"}),(0,n.jsx)("option",{value:"any",children:"Any"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Occupation"}),(0,n.jsx)("input",{type:"text",value:r.occupation||"",onChange:e=>s({...r,occupation:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-pink-500 focus:ring-pink-500",placeholder:"Enter preferred occupation"})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Work Location"}),(0,n.jsx)("input",{type:"text",value:r.location||"",onChange:e=>s({...r,location:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-pink-500 focus:ring-pink-500",placeholder:"Enter preferred work location"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Annual Income Range"}),(0,n.jsxs)("select",{value:r.income||"",onChange:e=>s({...r,income:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-pink-500 focus:ring-pink-500",children:[(0,n.jsx)("option",{value:"",children:"Select Income Range"}),(0,n.jsx)("option",{value:"0-3",children:"Below 3 LPA"}),(0,n.jsx)("option",{value:"3-5",children:"3-5 LPA"}),(0,n.jsx)("option",{value:"5-8",children:"5-8 LPA"}),(0,n.jsx)("option",{value:"8-12",children:"8-12 LPA"}),(0,n.jsx)("option",{value:"12-15",children:"12-15 LPA"}),(0,n.jsx)("option",{value:"15-20",children:"15-20 LPA"}),(0,n.jsx)("option",{value:"20+",children:"Above 20 LPA"})]})]})]}),(0,n.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,n.jsx)("button",{type:"button",onClick:()=>e.push("/matches"),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,n.jsx)("button",{type:"submit",disabled:i,className:"px-4 py-2 bg-pink-600 text-white rounded-md hover:bg-pink-700 disabled:opacity-50",children:i?"Saving...":"Save Preferences"})]})]})]})})})})},69574:function(e,r,s){"use strict";s.d(r,{Z:function(){return o}});var n=s(3827),l=s(64090),a=s(47907);function o(e){return function(r){let[s,o]=(0,l.useState)(!0),[t,i]=(0,l.useState)(!1),[c,d]=(0,l.useState)(null);return((0,a.useRouter)(),(0,l.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/auth/me"),r=await e.json();r.isAuthenticated&&r.user?(i(!0),d(r.user)):(i(!1),d(null),"function"==typeof window.showLoginPopup&&window.showLoginPopup())}catch(e){console.error("Auth check error:",e),i(!1),d(null),"function"==typeof window.showLoginPopup&&window.showLoginPopup()}finally{o(!1)}})()},[]),s)?(0,n.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-indigo-950 via-purple-900 to-indigo-950 flex items-center justify-center relative overflow-hidden",children:[(0,n.jsx)("div",{className:"absolute inset-0 backdrop-blur-md z-0"}),(0,n.jsxs)("div",{className:"relative z-10 flex flex-col items-center",children:[(0,n.jsxs)("svg",{className:"animate-spin h-14 w-14 text-purple-300 mb-4",viewBox:"0 0 50 50",children:[(0,n.jsx)("circle",{className:"opacity-20",cx:"25",cy:"25",r:"20",stroke:"currentColor",strokeWidth:"5",fill:"none"}),(0,n.jsx)("circle",{className:"opacity-70",cx:"25",cy:"25",r:"20",stroke:"currentColor",strokeWidth:"5",fill:"none",strokeDasharray:"31.4 94.2"})]}),(0,n.jsx)("span",{className:"text-purple-200 text-lg font-medium animate-pulse",children:"Loading..."})]})]}):t&&c?(0,n.jsx)(e,{...r,user:c}):null}}}},function(e){e.O(0,[2971,8069,1744],function(){return e(e.s=74197)}),_N_E=e.O()}]);