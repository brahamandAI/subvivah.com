"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9417],{9417:function(e,t,a){a.r(t);var i=a(3827),l=a(64090),r=a(43491),n=a(95231),s=a(71399),o=a(69689);let d=["Turn your head LEFT","Turn your head RIGHT","Look straight ahead"];t.default=e=>{let{onNext:t}=e,a=(0,l.useRef)(null),c=(0,l.useRef)(null),[u,h]=(0,l.useState)(0),m=(0,l.useRef)(0),[x,f]=(0,l.useState)(0),[g,b]=(0,l.useState)(0),[p,w]=(0,l.useState)(d[0]),[y,v]=(0,l.useState)(!0),[j,N]=(0,l.useState)([!1,!1,!1]),[k,F]=(0,l.useState)(!1),[P,T]=(0,l.useState)(!1),[S,M]=(0,l.useState)(null),E=(0,l.useRef)(null),I=(0,l.useRef)(null);(0,l.useRef)(0);let C=(0,l.useRef)(null),[R,L]=(0,l.useState)({image:null,mesh:null}),[D,_]=(0,l.useState)(!1),[O,V]=(0,l.useState)(0),W=e=>{N(t=>{let a=[...t];return a[e]=!0,a})},z=()=>{C.current&&(C.current.currentTime=0,C.current.play().catch(()=>{}))},A=e=>{h(e),m.current=e},B=(e,t,a)=>{let i=t/2,l=a/2,r=.3*Math.min(t,a),n=0;0===u?n=.3*r:1===u&&(n=-(.3*r)),e.beginPath(),e.strokeStyle="rgba(255, 255, 255, 0.3)",e.lineWidth=2,e.ellipse(i+n,l,.5*r,.7*r,0,0,2*Math.PI),e.stroke();let s=.1*r,o=.15*r,d=.2*r;e.beginPath(),e.arc(i-d+n,l-o,s,0,2*Math.PI),e.stroke(),e.beginPath(),e.arc(i+d+n,l-o,s,0,2*Math.PI),e.stroke(),e.beginPath(),e.moveTo(i+n,l-o),e.lineTo(i+n,l+o),e.stroke(),e.beginPath(),e.arc(i+n,l+1.5*o,.2*r,0,Math.PI),e.stroke();let c=.4*r,h=.8*r;e.beginPath(),0===u?(e.moveTo(i-h,l),e.lineTo(i-h+c,l-c/2),e.lineTo(i-h+c,l+c/2),e.closePath()):1===u&&(e.moveTo(i+h,l),e.lineTo(i+h-c,l-c/2),e.lineTo(i+h-c,l+c/2),e.closePath()),e.fillStyle="rgba(255, 255, 255, 0.3)",e.fill()},G=e=>{if(!y)return;let i=e.multiFaceLandmarks&&e.multiFaceLandmarks.length>0;if(T(i),!i){w("No face detected. Please position yourself in front of the camera.");return}let l=e.multiFaceLandmarks[0],r=c.current,n=null==r?void 0:r.getContext("2d");if(r&&n&&a.current){for(let e of(n.clearRect(0,0,r.width,r.height),n.drawImage(a.current,0,0,r.width,r.height),B(n,r.width,r.height),n.strokeStyle="#FF69B4",n.lineWidth=2,n.beginPath(),l))n.moveTo(e.x*r.width,e.y*r.height),n.arc(e.x*r.width,e.y*r.height,1,0,2*Math.PI);n.stroke(),b(function(e,t,a){let i=e.getImageData(0,0,t,a),l=0;for(let e=0;e<i.data.length;e+=4)l+=(i.data[e]+i.data[e+1]+i.data[e+2])/3;return l/(i.data.length/4)}(n,r.width,r.height))}let s=function(e){let t=e[234],a=e[454],i=e[1];if(!t||!a||!i)return 0;let l=Math.abs(a.x-t.x),r=(t.x+a.x)/2;return(i.x-r)/l*90}(l);f(s),console.log("Current step:",u,"Yaw:",s);let o=m.current;0===o?s>30&&(A(1),w(d[1]),W(0),z()):1===o?s<-30&&(A(2),w(d[2]),W(1),z()):2===o&&10>Math.abs(s)&&!S&&!D&&(w("Analyzing..."),_(!0),z(),r&&n&&L({image:n.getImageData(0,0,r.width,r.height),mesh:l}),setTimeout(()=>{var e;let a=Math.floor(26*Math.random())+70;M({gender:"male",confidence:a}),w("Verification complete!"),W(2),v(!1),F(!0),null===(e=E.current)||void 0===e||e.stop(),_(!1),setTimeout(()=>{t({success:!0,gender:"male",confidence:a/100})},2e3)},2e3))};return(0,l.useEffect)(()=>{if(!y)return;let e=null,t=null,i=a.current,l=c.current;if(!i||!l)return;let s=window.innerWidth<640;return l.width=s?320:480,l.height=s?240:360,(t=new r.FaceMesh({locateFile:e=>"https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/".concat(e)})).setOptions({maxNumFaces:1,refineLandmarks:!0,minDetectionConfidence:.3,minTrackingConfidence:.3}),t.onResults(G),(e=new n.Camera(i,{onFrame:async()=>{await t.send({image:i})},width:s?320:640,height:s?240:480,facingMode:"user"})).start(),E.current=e,I.current=t,()=>{null==e||e.stop()}},[y]),(0,l.useEffect)(()=>{if(k&&R.image&&c.current){let e=c.current,t=e.getContext("2d");if(t&&(t.putImageData(R.image,0,0),R.mesh)){for(let a of(t.strokeStyle="#FF69B4",t.lineWidth=2,t.beginPath(),R.mesh))t.moveTo(a.x*e.width,a.y*e.height),t.arc(a.x*e.width,a.y*e.height,1,0,2*Math.PI);t.stroke()}}},[k,R]),(0,l.useEffect)(()=>{m.current=u},[u]),(0,i.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-transparent p-4",children:(0,i.jsxs)("div",{className:"w-full max-w-2xl bg-white/5 backdrop-blur-md rounded-2xl shadow-xl p-4 space-y-6 border border-white/10 transition-all duration-500 hover:bg-white/10",children:[(0,i.jsx)("h2",{className:"text-xl font-semibold text-center text-white/90 mb-4",children:"Face Verification"}),(0,i.jsx)("div",{className:"relative aspect-video bg-gradient-to-br from-slate-50/5 to-slate-100/5 rounded-2xl overflow-hidden shadow-lg border border-white/10 transition-all duration-500 hover:border-white/20",children:k?(0,i.jsxs)(o.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,ease:"easeOut"},className:"w-full h-full flex flex-col items-center justify-center bg-emerald-500/20 backdrop-blur-sm",children:[(0,i.jsx)(o.E.div,{initial:{scale:0},animate:{scale:1},transition:{duration:.5,delay:.2},className:"w-24 h-24 rounded-full bg-emerald-500/80 flex items-center justify-center mb-4",children:(0,i.jsx)(s.FJM,{className:"text-white text-5xl"})}),(0,i.jsx)(o.E.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"text-emerald-100 text-xl font-medium",children:"Verification Complete"}),S&&(0,i.jsxs)(o.E.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.6},className:"text-emerald-200/90 text-lg mt-2",children:["Detected: ",S.gender]}),(0,i.jsxs)(o.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.8},className:"mt-6",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-emerald-500/80 border-t-transparent"}),(0,i.jsx)("p",{className:"text-emerald-100/90 text-sm mt-2",children:"Processing..."})]})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("video",{ref:a,className:"w-full h-full object-cover transition-all duration-500 scale-x-[-1]",playsInline:!0,autoPlay:!0,muted:!0}),(0,i.jsx)("canvas",{ref:c,className:"absolute top-0 left-0 w-full h-full transition-all duration-500 scale-x-[-1]"}),!k&&(0,i.jsxs)("div",{className:"absolute top-4 left-4 bg-black/20 backdrop-blur-md p-2 rounded-lg text-white/90 text-sm font-mono transition-all duration-500",children:[(0,i.jsxs)("div",{children:["Face Detected: ",P?"✅":"❌"]}),(0,i.jsxs)("div",{children:["Yaw: ",x.toFixed(1),"\xb0"]}),(0,i.jsxs)("div",{children:["Lighting: ",g.toFixed(0)]})]})]})}),(0,i.jsx)("div",{className:"grid grid-cols-3 gap-3",children:d.map((e,t)=>(0,i.jsxs)(o.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2*t,duration:.5,ease:"easeOut"},className:"flex flex-col items-center p-3 rounded-lg transition-all duration-500 ".concat(j[t]?"bg-emerald-500/10 border border-emerald-200/20 hover:bg-emerald-500/20":"bg-white/5 border border-white/10 hover:bg-white/10"),children:[(0,i.jsx)("div",{className:"flex-shrink-0 mb-2",children:j[t]?(0,i.jsx)(o.E.div,{initial:{scale:0},animate:{scale:1},transition:{duration:.5,ease:"easeOut"},className:"w-10 h-10 rounded-full bg-emerald-500/80 backdrop-blur-sm flex items-center justify-center shadow-md",children:(0,i.jsx)(s.FJM,{className:"text-white text-xl"})}):(0,i.jsx)("div",{className:"w-10 h-10 rounded-full bg-slate-500/10 backdrop-blur-sm flex items-center justify-center shadow-md",children:(0,i.jsx)(s.G5m,{className:"text-slate-300/80 text-xl"})})}),(0,i.jsx)("div",{className:"text-center",children:(0,i.jsx)("p",{className:"font-medium text-xs transition-colors duration-500 ".concat(j[t]?"text-emerald-300/90":"text-white/70"),children:e})})]},t))}),(0,i.jsxs)("div",{className:"text-center space-y-3",children:[!k&&(0,i.jsx)("p",{className:"text-base font-medium text-white/80 transition-all duration-500",children:p}),D&&!k&&(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-4 border-slate-500/80 border-t-transparent mb-2"}),(0,i.jsx)("div",{className:"text-slate-300/90 font-medium",children:"Analyzing..."})]}),(0,i.jsx)("div",{className:"flex justify-center space-x-3 mt-4",children:y&&!k&&(0,i.jsx)(o.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},transition:{duration:.3},onClick:()=>{var e;v(!1),A(0),w("Verification stopped."),f(0),b(0),N([!1,!1,!1]),M(null),F(!1),L({image:null,mesh:null}),null===(e=E.current)||void 0===e||e.stop()},className:"bg-white/10 text-white/90 px-6 py-2 rounded-lg font-medium hover:bg-white/20 transition-all duration-500 shadow-md text-sm backdrop-blur-sm",children:"Stop"})})]}),(0,i.jsx)("audio",{ref:C,src:"/beep.mp3",preload:"auto"})]})})}}}]);