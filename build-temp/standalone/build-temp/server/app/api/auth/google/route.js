(()=>{var e={};e.id=1718,e.ids=[1718],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},32081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},15673:e=>{"use strict";e.exports=require("node:events")},97742:e=>{"use strict";e.exports=require("node:process")},47261:e=>{"use strict";e.exports=require("node:util")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},85477:e=>{"use strict";e.exports=require("punycode")},63477:e=>{"use strict";e.exports=require("querystring")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},87951:(e,t,r)=>{"use strict";r.r(t),r.d(t,{headerHooks:()=>m,originalPathname:()=>_,patchFetch:()=>E,requestAsyncStorage:()=>f,routeModule:()=>p,serverHooks:()=>y,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>v});var i={};r.r(i),r.d(i,{POST:()=>d});var s=r(95419),n=r(69108),o=r(99678),a=r(78070),c=r(84554),l=r(81494),u=r(46082);let h=new c.lv(process.env.GOOGLE_CLIENT_ID);async function d(e){try{let{token:t}=await e.json();if(!t)return console.log("No token provided in request"),a.Z.json({error:"Token is required"},{status:400});console.log("Verifying Google token...");let r=(await h.verifyIdToken({idToken:t,audience:process.env.GOOGLE_CLIENT_ID})).getPayload();if(!r)return console.log("Invalid token payload"),a.Z.json({error:"Invalid token"},{status:400});let{email:i,name:s,picture:n,sub:o}=r;if(!i)return console.log("No email in token payload"),a.Z.json({error:"Email is required"},{status:400});console.log("Finding or creating user for email:",i);let c=await l._.user.findUnique({where:{email:i}});c||(console.log("Creating new user for email:",i),c=await l._.user.create({data:{email:i,firstName:s?.split(" ")[0]||"",lastName:s?.split(" ").slice(1).join(" ")||"",gender:"Not Specified",dob:new Date,password:"",profile:{create:{}}}})),console.log("Creating JWT token for user:",c.id);let d=(0,u.sign)({userId:c.id},process.env.JWT_SECRET||"your-secret-key",{expiresIn:"7d"}),p=a.Z.json({user:{id:c.id,email:c.email,firstName:c.firstName,lastName:c.lastName}});return console.log("Setting authentication cookie"),p.cookies.set("token",d,{httpOnly:!0,secure:!0,sameSite:"lax",domain:".subvivah.com",path:"/",maxAge:604800}),p}catch(e){return console.error("Google authentication error:",e),a.Z.json({error:"Authentication failed",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let p=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/auth/google/route",pathname:"/api/auth/google",filename:"route",bundlePath:"app/api/auth/google/route"},resolvedPagePath:"/home/subvivah/htdocs/subvivah.com/src/app/api/auth/google/route.ts",nextConfigOutput:"standalone",userland:i}),{requestAsyncStorage:f,staticGenerationAsyncStorage:g,serverHooks:y,headerHooks:m,staticGenerationBailout:v}=p,_="/api/auth/google/route";function E(){return(0,o.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:g})}},82445:(e,t,r)=>{"use strict";var i=Object.create?function(e,t,r,i){void 0===i&&(i=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,s)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]},s=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.req=t.json=t.toBuffer=void 0;let o=n(r(13685)),a=n(r(95687));async function c(e){let t=0,r=[];for await(let i of e)t+=i.length,r.push(i);return Buffer.concat(r,t)}async function l(e){let t=(await c(e)).toString("utf8");try{return JSON.parse(t)}catch(e){throw e.message+=` (input: ${t})`,e}}t.toBuffer=c,t.json=l,t.req=function(e,t={}){let r=(("string"==typeof e?e:e.href).startsWith("https:")?a:o).request(e,t),i=new Promise((e,t)=>{r.once("response",e).once("error",t).end()});return r.then=i.then.bind(i),r}},43041:(e,t,r)=>{"use strict";var i=Object.create?function(e,t,r,i){void 0===i&&(i=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,s)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]},s=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Agent=void 0;let o=n(r(41808)),a=n(r(13685)),c=r(95687);!function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)}(r(82445),t);let l=Symbol("AgentBaseInternalState");class u extends a.Agent{constructor(e){super(e),this[l]={}}isSecureEndpoint(e){if(e){if("boolean"==typeof e.secureEndpoint)return e.secureEndpoint;if("string"==typeof e.protocol)return"https:"===e.protocol}let{stack:t}=Error();return"string"==typeof t&&t.split("\n").some(e=>-1!==e.indexOf("(https.js:")||-1!==e.indexOf("node:https:"))}incrementSockets(e){if(this.maxSockets===1/0&&this.maxTotalSockets===1/0)return null;this.sockets[e]||(this.sockets[e]=[]);let t=new o.Socket({writable:!1});return this.sockets[e].push(t),this.totalSocketCount++,t}decrementSockets(e,t){if(!this.sockets[e]||null===t)return;let r=this.sockets[e],i=r.indexOf(t);-1!==i&&(r.splice(i,1),this.totalSocketCount--,0===r.length&&delete this.sockets[e])}getName(e){return("boolean"==typeof e.secureEndpoint?e.secureEndpoint:this.isSecureEndpoint(e))?c.Agent.prototype.getName.call(this,e):super.getName(e)}createSocket(e,t,r){let i={...t,secureEndpoint:this.isSecureEndpoint(t)},s=this.getName(i),n=this.incrementSockets(s);Promise.resolve().then(()=>this.connect(e,i)).then(o=>{if(this.decrementSockets(s,n),o instanceof a.Agent)try{return o.addRequest(e,i)}catch(e){return r(e)}this[l].currentSocket=o,super.createSocket(e,t,r)},e=>{this.decrementSockets(s,n),r(e)})}createConnection(){let e=this[l].currentSocket;if(this[l].currentSocket=void 0,!e)throw Error("No socket was returned in the `connect()` function");return e}get defaultPort(){return this[l].defaultPort??("https:"===this.protocol?443:80)}set defaultPort(e){this[l]&&(this[l].defaultPort=e)}get protocol(){return this[l].protocol??(this.isSecureEndpoint()?"https:":"http:")}set protocol(e){this[l]&&(this[l].protocol=e)}}t.Agent=u},73083:(e,t)=>{"use strict";t.byteLength=function(e){var t=c(e),r=t[0],i=t[1];return(r+i)*3/4-i},t.toByteArray=function(e){var t,r,n=c(e),o=n[0],a=n[1],l=new s((o+a)*3/4-a),u=0,h=a>0?o-4:o;for(r=0;r<h;r+=4)t=i[e.charCodeAt(r)]<<18|i[e.charCodeAt(r+1)]<<12|i[e.charCodeAt(r+2)]<<6|i[e.charCodeAt(r+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=255&t;return 2===a&&(t=i[e.charCodeAt(r)]<<2|i[e.charCodeAt(r+1)]>>4,l[u++]=255&t),1===a&&(t=i[e.charCodeAt(r)]<<10|i[e.charCodeAt(r+1)]<<4|i[e.charCodeAt(r+2)]>>2,l[u++]=t>>8&255,l[u++]=255&t),l},t.fromByteArray=function(e){for(var t,i=e.length,s=i%3,n=[],o=0,a=i-s;o<a;o+=16383)n.push(function(e,t,i){for(var s,n=[],o=t;o<i;o+=3)n.push(r[(s=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]))>>18&63]+r[s>>12&63]+r[s>>6&63]+r[63&s]);return n.join("")}(e,o,o+16383>a?a:o+16383));return 1===s?n.push(r[(t=e[i-1])>>2]+r[t<<4&63]+"=="):2===s&&n.push(r[(t=(e[i-2]<<8)+e[i-1])>>10]+r[t>>4&63]+r[t<<2&63]+"="),n.join("")};for(var r=[],i=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=n.length;o<a;++o)r[o]=n[o],i[n.charCodeAt(o)]=o;function c(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var i=r===t?0:4-r%4;return[r,i]}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},69146:(e,t,r)=>{"use strict";var i;!function(s){var n,o=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,a=Math.ceil,c=Math.floor,l="[BigNumber Error] ",u=l+"Number primitive has more than 15 significant digits: ",h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13];function d(e){var t=0|e;return e>0||e===t?t:t-1}function p(e){for(var t,r,i=1,s=e.length,n=e[0]+"";i<s;){for(r=14-(t=e[i++]+"").length;r--;t="0"+t);n+=t}for(s=n.length;48===n.charCodeAt(--s););return n.slice(0,s+1||1)}function f(e,t){var r,i,s=e.c,n=t.c,o=e.s,a=t.s,c=e.e,l=t.e;if(!o||!a)return null;if(r=s&&!s[0],i=n&&!n[0],r||i)return r?i?0:-a:o;if(o!=a)return o;if(r=o<0,i=c==l,!s||!n)return i?0:!s^r?1:-1;if(!i)return c>l^r?1:-1;for(o=0,a=(c=s.length)<(l=n.length)?c:l;o<a;o++)if(s[o]!=n[o])return s[o]>n[o]^r?1:-1;return c==l?0:c>l^r?1:-1}function g(e,t,r,i){if(e<t||e>r||e!==c(e))throw Error(l+(i||"Argument")+("number"==typeof e?e<t||e>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function y(e){var t=e.c.length-1;return d(e.e/14)==t&&e.c[t]%2!=0}function m(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function v(e,t,r){var i,s;if(t<0){for(s=r+".";++t;s+=r);e=s+e}else if(i=e.length,++t>i){for(s=r,t-=i;--t;s+=r);e+=s}else t<i&&(e=e.slice(0,t)+"."+e.slice(t));return e}(n=function e(t){var r,i,s,n,_,E,w,A,T,b=F.prototype={constructor:F,toString:null,valueOf:null},S=new F(1),k=20,O=4,C=-7,R=21,x=-1e7,N=1e7,j=!1,P=1,I=0,D={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xa0",suffix:""},U="0123456789abcdefghijklmnopqrstuvwxyz",M=!0;function F(e,t){var r,i,s,n,a,l,h,d,p=this;if(!(p instanceof F))return new F(e,t);if(null==t){if(e&&!0===e._isBigNumber){p.s=e.s,!e.c||e.e>N?p.c=p.e=null:e.e<x?p.c=[p.e=0]:(p.e=e.e,p.c=e.c.slice());return}if((l="number"==typeof e)&&0*e==0){if(p.s=1/e<0?(e=-e,-1):1,e===~~e){for(n=0,a=e;a>=10;a/=10,n++);n>N?p.c=p.e=null:(p.e=n,p.c=[e]);return}d=String(e)}else{if(!o.test(d=String(e)))return T(p,d,l);p.s=45==d.charCodeAt(0)?(d=d.slice(1),-1):1}(n=d.indexOf("."))>-1&&(d=d.replace(".","")),(a=d.search(/e/i))>0?(n<0&&(n=a),n+=+d.slice(a+1),d=d.substring(0,a)):n<0&&(n=d.length)}else{if(g(t,2,U.length,"Base"),10==t&&M)return B(p=new F(e),k+p.e+1,O);if(d=String(e),l="number"==typeof e){if(0*e!=0)return T(p,d,l,t);if(p.s=1/e<0?(d=d.slice(1),-1):1,F.DEBUG&&d.replace(/^0\.0*|\./,"").length>15)throw Error(u+e)}else p.s=45===d.charCodeAt(0)?(d=d.slice(1),-1):1;for(r=U.slice(0,t),n=a=0,h=d.length;a<h;a++)if(0>r.indexOf(i=d.charAt(a))){if("."==i){if(a>n){n=h;continue}}else if(!s&&(d==d.toUpperCase()&&(d=d.toLowerCase())||d==d.toLowerCase()&&(d=d.toUpperCase()))){s=!0,a=-1,n=0;continue}return T(p,String(e),l,t)}l=!1,(n=(d=A(d,t,10,p.s)).indexOf("."))>-1?d=d.replace(".",""):n=d.length}for(a=0;48===d.charCodeAt(a);a++);for(h=d.length;48===d.charCodeAt(--h););if(d=d.slice(a,++h)){if(h-=a,l&&F.DEBUG&&h>15&&(e>9007199254740991||e!==c(e)))throw Error(u+p.s*e);if((n=n-a-1)>N)p.c=p.e=null;else if(n<x)p.c=[p.e=0];else{if(p.e=n,p.c=[],a=(n+1)%14,n<0&&(a+=14),a<h){for(a&&p.c.push(+d.slice(0,a)),h-=14;a<h;)p.c.push(+d.slice(a,a+=14));a=14-(d=d.slice(a)).length}else a-=h;for(;a--;d+="0");p.c.push(+d)}}else p.c=[p.e=0]}function L(e,t,r,i){var s,n,o,a,c;if(null==r?r=O:g(r,0,8),!e.c)return e.toString();if(s=e.c[0],o=e.e,null==t)c=p(e.c),c=1==i||2==i&&(o<=C||o>=R)?m(c,o):v(c,o,"0");else if(n=(e=B(new F(e),t,r)).e,a=(c=p(e.c)).length,1==i||2==i&&(t<=n||n<=C)){for(;a<t;c+="0",a++);c=m(c,n)}else if(t-=o,c=v(c,n,"0"),n+1>a){if(--t>0)for(c+=".";t--;c+="0");}else if((t+=n-a)>0)for(n+1==a&&(c+=".");t--;c+="0");return e.s<0&&s?"-"+c:c}function G(e,t){for(var r,i,s=1,n=new F(e[0]);s<e.length;s++)(i=new F(e[s])).s&&(r=f(n,i))!==t&&(0!==r||n.s!==t)||(n=i);return n}function $(e,t,r){for(var i=1,s=t.length;!t[--s];t.pop());for(s=t[0];s>=10;s/=10,i++);return(r=i+14*r-1)>N?e.c=e.e=null:r<x?e.c=[e.e=0]:(e.e=r,e.c=t),e}function B(e,t,r,i){var s,n,o,l,u,d,p,f=e.c;if(f){e:{for(s=1,l=f[0];l>=10;l/=10,s++);if((n=t-s)<0)n+=14,o=t,p=c((u=f[d=0])/h[s-o-1]%10);else if((d=a((n+1)/14))>=f.length){if(i){for(;f.length<=d;f.push(0));u=p=0,s=1,n%=14,o=n-14+1}else break e}else{for(s=1,u=l=f[d];l>=10;l/=10,s++);n%=14,p=(o=n-14+s)<0?0:c(u/h[s-o-1]%10)}if(i=i||t<0||null!=f[d+1]||(o<0?u:u%h[s-o-1]),i=r<4?(p||i)&&(0==r||r==(e.s<0?3:2)):p>5||5==p&&(4==r||i||6==r&&(n>0?o>0?u/h[s-o]:0:f[d-1])%10&1||r==(e.s<0?8:7)),t<1||!f[0])return f.length=0,i?(t-=e.e+1,f[0]=h[(14-t%14)%14],e.e=-t||0):f[0]=e.e=0,e;if(0==n?(f.length=d,l=1,d--):(f.length=d+1,l=h[14-n],f[d]=o>0?c(u/h[s-o]%h[o])*l:0),i)for(;;){if(0==d){for(n=1,o=f[0];o>=10;o/=10,n++);for(o=f[0]+=l,l=1;o>=10;o/=10,l++);n!=l&&(e.e++,1e14==f[0]&&(f[0]=1));break}if(f[d]+=l,1e14!=f[d])break;f[d--]=0,l=1}for(n=f.length;0===f[--n];f.pop());}e.e>N?e.c=e.e=null:e.e<x&&(e.c=[e.e=0])}return e}function q(e){var t,r=e.e;return null===r?e.toString():(t=p(e.c),t=r<=C||r>=R?m(t,r):v(t,r,"0"),e.s<0?"-"+t:t)}return F.clone=e,F.ROUND_UP=0,F.ROUND_DOWN=1,F.ROUND_CEIL=2,F.ROUND_FLOOR=3,F.ROUND_HALF_UP=4,F.ROUND_HALF_DOWN=5,F.ROUND_HALF_EVEN=6,F.ROUND_HALF_CEIL=7,F.ROUND_HALF_FLOOR=8,F.EUCLID=9,F.config=F.set=function(e){var t,r;if(null!=e){if("object"==typeof e){if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(g(r=e[t],0,1e9,t),k=r),e.hasOwnProperty(t="ROUNDING_MODE")&&(g(r=e[t],0,8,t),O=r),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((r=e[t])&&r.pop?(g(r[0],-1e9,0,t),g(r[1],0,1e9,t),C=r[0],R=r[1]):(g(r,-1e9,1e9,t),C=-(R=r<0?-r:r))),e.hasOwnProperty(t="RANGE")){if((r=e[t])&&r.pop)g(r[0],-1e9,-1,t),g(r[1],1,1e9,t),x=r[0],N=r[1];else if(g(r,-1e9,1e9,t),r)x=-(N=r<0?-r:r);else throw Error(l+t+" cannot be zero: "+r)}if(e.hasOwnProperty(t="CRYPTO")){if(!!(r=e[t])===r){if(r){if("undefined"!=typeof crypto&&crypto&&(crypto.getRandomValues||crypto.randomBytes))j=r;else throw j=!r,Error(l+"crypto unavailable")}else j=r}else throw Error(l+t+" not true or false: "+r)}if(e.hasOwnProperty(t="MODULO_MODE")&&(g(r=e[t],0,9,t),P=r),e.hasOwnProperty(t="POW_PRECISION")&&(g(r=e[t],0,1e9,t),I=r),e.hasOwnProperty(t="FORMAT")){if("object"==typeof(r=e[t]))D=r;else throw Error(l+t+" not an object: "+r)}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(r=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(r))throw Error(l+t+" invalid: "+r);M="0123456789"==r.slice(0,10),U=r}}else throw Error(l+"Object expected: "+e)}return{DECIMAL_PLACES:k,ROUNDING_MODE:O,EXPONENTIAL_AT:[C,R],RANGE:[x,N],CRYPTO:j,MODULO_MODE:P,POW_PRECISION:I,FORMAT:D,ALPHABET:U}},F.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!F.DEBUG)return!0;var t,r,i=e.c,s=e.e,n=e.s;e:if("[object Array]"==({}).toString.call(i)){if((1===n||-1===n)&&s>=-1e9&&s<=1e9&&s===c(s)){if(0===i[0]){if(0===s&&1===i.length)return!0;break e}if((t=(s+1)%14)<1&&(t+=14),String(i[0]).length==t){for(t=0;t<i.length;t++)if((r=i[t])<0||r>=1e14||r!==c(r))break e;if(0!==r)return!0}}}else if(null===i&&null===s&&(null===n||1===n||-1===n))return!0;throw Error(l+"Invalid BigNumber: "+e)},F.maximum=F.max=function(){return G(arguments,-1)},F.minimum=F.min=function(){return G(arguments,1)},F.random=(r=9007199254740992*Math.random()&2097151?function(){return c(9007199254740992*Math.random())}:function(){return(1073741824*Math.random()|0)*8388608+(8388608*Math.random()|0)},function(e){var t,i,s,n,o,u=0,d=[],p=new F(S);if(null==e?e=k:g(e,0,1e9),n=a(e/14),j){if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(n*=2));u<n;)(o=131072*t[u]+(t[u+1]>>>11))>=9e15?(i=crypto.getRandomValues(new Uint32Array(2)),t[u]=i[0],t[u+1]=i[1]):(d.push(o%1e14),u+=2);u=n/2}else if(crypto.randomBytes){for(t=crypto.randomBytes(n*=7);u<n;)(o=(31&t[u])*281474976710656+1099511627776*t[u+1]+4294967296*t[u+2]+16777216*t[u+3]+(t[u+4]<<16)+(t[u+5]<<8)+t[u+6])>=9e15?crypto.randomBytes(7).copy(t,u):(d.push(o%1e14),u+=7);u=n/7}else throw j=!1,Error(l+"crypto unavailable")}if(!j)for(;u<n;)(o=r())<9e15&&(d[u++]=o%1e14);for(n=d[--u],e%=14,n&&e&&(o=h[14-e],d[u]=c(n/o)*o);0===d[u];d.pop(),u--);if(u<0)d=[s=0];else{for(s=-1;0===d[0];d.splice(0,1),s-=14);for(u=1,o=d[0];o>=10;o/=10,u++);u<14&&(s-=14-u)}return p.e=s,p.c=d,p}),F.sum=function(){for(var e=1,t=arguments,r=new F(t[0]);e<t.length;)r=r.plus(t[e++]);return r},A=function(){var e="0123456789";function t(e,t,r,i){for(var s,n,o=[0],a=0,c=e.length;a<c;){for(n=o.length;n--;o[n]*=t);for(o[0]+=i.indexOf(e.charAt(a++)),s=0;s<o.length;s++)o[s]>r-1&&(null==o[s+1]&&(o[s+1]=0),o[s+1]+=o[s]/r|0,o[s]%=r)}return o.reverse()}return function(r,i,s,n,o){var a,c,l,u,h,d,f,g,y=r.indexOf("."),m=k,_=O;for(y>=0&&(u=I,I=0,r=r.replace(".",""),d=(g=new F(i)).pow(r.length-y),I=u,g.c=t(v(p(d.c),d.e,"0"),10,s,e),g.e=g.c.length),l=u=(f=t(r,i,s,o?(a=U,e):(a=e,U))).length;0==f[--u];f.pop());if(!f[0])return a.charAt(0);if(y<0?--l:(d.c=f,d.e=l,d.s=n,f=(d=w(d,g,m,_,s)).c,h=d.r,l=d.e),y=f[c=l+m+1],u=s/2,h=h||c<0||null!=f[c+1],h=_<4?(null!=y||h)&&(0==_||_==(d.s<0?3:2)):y>u||y==u&&(4==_||h||6==_&&1&f[c-1]||_==(d.s<0?8:7)),c<1||!f[0])r=h?v(a.charAt(1),-m,a.charAt(0)):a.charAt(0);else{if(f.length=c,h)for(--s;++f[--c]>s;)f[c]=0,c||(++l,f=[1].concat(f));for(u=f.length;!f[--u];);for(y=0,r="";y<=u;r+=a.charAt(f[y++]));r=v(r,l,a.charAt(0))}return r}}(),w=function(){function e(e,t,r){var i,s,n,o,a=0,c=e.length,l=t%1e7,u=t/1e7|0;for(e=e.slice();c--;)i=u*(n=e[c]%1e7)+(o=e[c]/1e7|0)*l,a=((s=l*n+i%1e7*1e7+a)/r|0)+(i/1e7|0)+u*o,e[c]=s%r;return a&&(e=[a].concat(e)),e}function t(e,t,r,i){var s,n;if(r!=i)n=r>i?1:-1;else for(s=n=0;s<r;s++)if(e[s]!=t[s]){n=e[s]>t[s]?1:-1;break}return n}function r(e,t,r,i){for(var s=0;r--;)e[r]-=s,s=e[r]<t[r]?1:0,e[r]=s*i+e[r]-t[r];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(i,s,n,o,a){var l,u,h,p,f,g,y,m,v,_,E,w,A,T,b,S,k,O=i.s==s.s?1:-1,C=i.c,R=s.c;if(!C||!C[0]||!R||!R[0])return new F(i.s&&s.s&&(C?!R||C[0]!=R[0]:R)?C&&0==C[0]||!R?0*O:O/0:NaN);for(v=(m=new F(O)).c=[],O=n+(u=i.e-s.e)+1,a||(a=1e14,u=d(i.e/14)-d(s.e/14),O=O/14|0),h=0;R[h]==(C[h]||0);h++);if(R[h]>(C[h]||0)&&u--,O<0)v.push(1),p=!0;else{for(T=C.length,S=R.length,h=0,O+=2,(f=c(a/(R[0]+1)))>1&&(R=e(R,f,a),C=e(C,f,a),S=R.length,T=C.length),A=S,E=(_=C.slice(0,S)).length;E<S;_[E++]=0);k=[0].concat(k=R.slice()),b=R[0],R[1]>=a/2&&b++;do{if(f=0,(l=t(R,_,S,E))<0){if(w=_[0],S!=E&&(w=w*a+(_[1]||0)),(f=c(w/b))>1)for(f>=a&&(f=a-1),y=(g=e(R,f,a)).length,E=_.length;1==t(g,_,y,E);)f--,r(g,S<y?k:R,y,a),y=g.length,l=1;else 0==f&&(l=f=1),y=(g=R.slice()).length;if(y<E&&(g=[0].concat(g)),r(_,g,E,a),E=_.length,-1==l)for(;1>t(R,_,S,E);)f++,r(_,S<E?k:R,E,a),E=_.length}else 0===l&&(f++,_=[0]);v[h++]=f,_[0]?_[E++]=C[A]||0:(_=[C[A]],E=1)}while((A++<T||null!=_[0])&&O--);p=null!=_[0],v[0]||v.splice(0,1)}if(1e14==a){for(h=1,O=v[0];O>=10;O/=10,h++);B(m,n+(m.e=h+14*u-1)+1,o,p)}else m.e=u,m.r=+p;return m}}(),i=/^(-?)0([xbo])(?=\w[\w.]*$)/i,s=/^([^.]+)\.$/,n=/^\.([^.]+)$/,_=/^-?(Infinity|NaN)$/,E=/^\s*\+(?=[\w.])|^\s+|\s+$/g,T=function(e,t,r,o){var a,c=r?t:t.replace(E,"");if(_.test(c))e.s=isNaN(c)?null:c<0?-1:1;else{if(!r&&(c=c.replace(i,function(e,t,r){return a="x"==(r=r.toLowerCase())?16:"b"==r?2:8,o&&o!=a?e:t}),o&&(a=o,c=c.replace(s,"$1").replace(n,"0.$1")),t!=c))return new F(c,a);if(F.DEBUG)throw Error(l+"Not a"+(o?" base "+o:"")+" number: "+t);e.s=null}e.c=e.e=null},b.absoluteValue=b.abs=function(){var e=new F(this);return e.s<0&&(e.s=1),e},b.comparedTo=function(e,t){return f(this,new F(e,t))},b.decimalPlaces=b.dp=function(e,t){var r,i,s;if(null!=e)return g(e,0,1e9),null==t?t=O:g(t,0,8),B(new F(this),e+this.e+1,t);if(!(r=this.c))return null;if(i=((s=r.length-1)-d(this.e/14))*14,s=r[s])for(;s%10==0;s/=10,i--);return i<0&&(i=0),i},b.dividedBy=b.div=function(e,t){return w(this,new F(e,t),k,O)},b.dividedToIntegerBy=b.idiv=function(e,t){return w(this,new F(e,t),0,1)},b.exponentiatedBy=b.pow=function(e,t){var r,i,s,n,o,u,h,d,p,f=this;if((e=new F(e)).c&&!e.isInteger())throw Error(l+"Exponent not an integer: "+q(e));if(null!=t&&(t=new F(t)),u=e.e>14,!f.c||!f.c[0]||1==f.c[0]&&!f.e&&1==f.c.length||!e.c||!e.c[0])return p=new F(Math.pow(+q(f),u?e.s*(2-y(e)):+q(e))),t?p.mod(t):p;if(h=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new F(NaN);(i=!h&&f.isInteger()&&t.isInteger())&&(f=f.mod(t))}else{if(e.e>9&&(f.e>0||f.e<-1||(0==f.e?f.c[0]>1||u&&f.c[1]>=24e7:f.c[0]<8e13||u&&f.c[0]<=9999975e7)))return n=f.s<0&&y(e)?-0:0,f.e>-1&&(n=1/n),new F(h?1/n:n);I&&(n=a(I/14+2))}for(u?(r=new F(.5),h&&(e.s=1),d=y(e)):d=(s=Math.abs(+q(e)))%2,p=new F(S);;){if(d){if(!(p=p.times(f)).c)break;n?p.c.length>n&&(p.c.length=n):i&&(p=p.mod(t))}if(s){if(0===(s=c(s/2)))break;d=s%2}else if(B(e=e.times(r),e.e+1,1),e.e>14)d=y(e);else{if(0==(s=+q(e)))break;d=s%2}f=f.times(f),n?f.c&&f.c.length>n&&(f.c.length=n):i&&(f=f.mod(t))}return i?p:(h&&(p=S.div(p)),t?p.mod(t):n?B(p,I,O,o):p)},b.integerValue=function(e){var t=new F(this);return null==e?e=O:g(e,0,8),B(t,t.e+1,e)},b.isEqualTo=b.eq=function(e,t){return 0===f(this,new F(e,t))},b.isFinite=function(){return!!this.c},b.isGreaterThan=b.gt=function(e,t){return f(this,new F(e,t))>0},b.isGreaterThanOrEqualTo=b.gte=function(e,t){return 1===(t=f(this,new F(e,t)))||0===t},b.isInteger=function(){return!!this.c&&d(this.e/14)>this.c.length-2},b.isLessThan=b.lt=function(e,t){return 0>f(this,new F(e,t))},b.isLessThanOrEqualTo=b.lte=function(e,t){return -1===(t=f(this,new F(e,t)))||0===t},b.isNaN=function(){return!this.s},b.isNegative=function(){return this.s<0},b.isPositive=function(){return this.s>0},b.isZero=function(){return!!this.c&&0==this.c[0]},b.minus=function(e,t){var r,i,s,n,o=this.s;if(t=(e=new F(e,t)).s,!o||!t)return new F(NaN);if(o!=t)return e.s=-t,this.plus(e);var a=this.e/14,c=e.e/14,l=this.c,u=e.c;if(!a||!c){if(!l||!u)return l?(e.s=-t,e):new F(u?this:NaN);if(!l[0]||!u[0])return u[0]?(e.s=-t,e):new F(l[0]?this:3==O?-0:0)}if(a=d(a),c=d(c),l=l.slice(),o=a-c){for((n=o<0)?(o=-o,s=l):(c=a,s=u),s.reverse(),t=o;t--;s.push(0));s.reverse()}else for(i=(n=(o=l.length)<(t=u.length))?o:t,o=t=0;t<i;t++)if(l[t]!=u[t]){n=l[t]<u[t];break}if(n&&(s=l,l=u,u=s,e.s=-e.s),(t=(i=u.length)-(r=l.length))>0)for(;t--;l[r++]=0);for(t=1e14-1;i>o;){if(l[--i]<u[i]){for(r=i;r&&!l[--r];l[r]=t);--l[r],l[i]+=1e14}l[i]-=u[i]}for(;0==l[0];l.splice(0,1),--c);return l[0]?$(e,l,c):(e.s=3==O?-1:1,e.c=[e.e=0],e)},b.modulo=b.mod=function(e,t){var r,i;return(e=new F(e,t),this.c&&e.s&&(!e.c||e.c[0]))?e.c&&(!this.c||this.c[0])?(9==P?(i=e.s,e.s=1,r=w(this,e,0,3),e.s=i,r.s*=i):r=w(this,e,0,P),(e=this.minus(r.times(e))).c[0]||1!=P||(e.s=this.s),e):new F(this):new F(NaN)},b.multipliedBy=b.times=function(e,t){var r,i,s,n,o,a,c,l,u,h,p,f,g,y=this.c,m=(e=new F(e,t)).c;if(!y||!m||!y[0]||!m[0])return this.s&&e.s&&(!y||y[0]||m)&&(!m||m[0]||y)?(e.s*=this.s,y&&m?(e.c=[0],e.e=0):e.c=e.e=null):e.c=e.e=e.s=null,e;for(i=d(this.e/14)+d(e.e/14),e.s*=this.s,(c=y.length)<(h=m.length)&&(g=y,y=m,m=g,s=c,c=h,h=s),s=c+h,g=[];s--;g.push(0));for(s=h;--s>=0;){for(r=0,p=m[s]%1e7,f=m[s]/1e7|0,n=s+(o=c);n>s;)a=f*(l=y[--o]%1e7)+(u=y[o]/1e7|0)*p,r=((l=p*l+a%1e7*1e7+g[n]+r)/1e14|0)+(a/1e7|0)+f*u,g[n--]=l%1e14;g[n]=r}return r?++i:g.splice(0,1),$(e,g,i)},b.negated=function(){var e=new F(this);return e.s=-e.s||null,e},b.plus=function(e,t){var r,i=this.s;if(t=(e=new F(e,t)).s,!i||!t)return new F(NaN);if(i!=t)return e.s=-t,this.minus(e);var s=this.e/14,n=e.e/14,o=this.c,a=e.c;if(!s||!n){if(!o||!a)return new F(i/0);if(!o[0]||!a[0])return a[0]?e:new F(o[0]?this:0*i)}if(s=d(s),n=d(n),o=o.slice(),i=s-n){for(i>0?(n=s,r=a):(i=-i,r=o),r.reverse();i--;r.push(0));r.reverse()}for((i=o.length)-(t=a.length)<0&&(r=a,a=o,o=r,t=i),i=0;t;)i=(o[--t]=o[t]+a[t]+i)/1e14|0,o[t]=1e14===o[t]?0:o[t]%1e14;return i&&(o=[i].concat(o),++n),$(e,o,n)},b.precision=b.sd=function(e,t){var r,i,s;if(null!=e&&!!e!==e)return g(e,1,1e9),null==t?t=O:g(t,0,8),B(new F(this),e,t);if(!(r=this.c))return null;if(i=14*(s=r.length-1)+1,s=r[s]){for(;s%10==0;s/=10,i--);for(s=r[0];s>=10;s/=10,i++);}return e&&this.e+1>i&&(i=this.e+1),i},b.shiftedBy=function(e){return g(e,-9007199254740991,9007199254740991),this.times("1e"+e)},b.squareRoot=b.sqrt=function(){var e,t,r,i,s,n=this.c,o=this.s,a=this.e,c=k+4,l=new F("0.5");if(1!==o||!n||!n[0])return new F(!o||o<0&&(!n||n[0])?NaN:n?this:1/0);if(0==(o=Math.sqrt(+q(this)))||o==1/0?(((t=p(n)).length+a)%2==0&&(t+="0"),o=Math.sqrt(+t),a=d((a+1)/2)-(a<0||a%2),r=new F(t=o==1/0?"5e"+a:(t=o.toExponential()).slice(0,t.indexOf("e")+1)+a)):r=new F(o+""),r.c[0]){for((o=(a=r.e)+c)<3&&(o=0);;)if(s=r,r=l.times(s.plus(w(this,s,c,1))),p(s.c).slice(0,o)===(t=p(r.c)).slice(0,o)){if(r.e<a&&--o,"9999"!=(t=t.slice(o-3,o+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(B(r,r.e+k+2,1),e=!r.times(r).eq(this));break}if(!i&&(B(s,s.e+k+2,0),s.times(s).eq(this))){r=s;break}c+=4,o+=4,i=1}}return B(r,r.e+k+1,O,e)},b.toExponential=function(e,t){return null!=e&&(g(e,0,1e9),e++),L(this,e,t,1)},b.toFixed=function(e,t){return null!=e&&(g(e,0,1e9),e=e+this.e+1),L(this,e,t)},b.toFormat=function(e,t,r){var i;if(null==r)null!=e&&t&&"object"==typeof t?(r=t,t=null):e&&"object"==typeof e?(r=e,e=t=null):r=D;else if("object"!=typeof r)throw Error(l+"Argument not an object: "+r);if(i=this.toFixed(e,t),this.c){var s,n=i.split("."),o=+r.groupSize,a=+r.secondaryGroupSize,c=r.groupSeparator||"",u=n[0],h=n[1],d=this.s<0,p=d?u.slice(1):u,f=p.length;if(a&&(s=o,o=a,a=s,f-=s),o>0&&f>0){for(s=f%o||o,u=p.substr(0,s);s<f;s+=o)u+=c+p.substr(s,o);a>0&&(u+=c+p.slice(s)),d&&(u="-"+u)}i=h?u+(r.decimalSeparator||"")+((a=+r.fractionGroupSize)?h.replace(RegExp("\\d{"+a+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):h):u}return(r.prefix||"")+i+(r.suffix||"")},b.toFraction=function(e){var t,r,i,s,n,o,a,c,u,d,f,g,y=this.c;if(null!=e&&(!(a=new F(e)).isInteger()&&(a.c||1!==a.s)||a.lt(S)))throw Error(l+"Argument "+(a.isInteger()?"out of range: ":"not an integer: ")+q(a));if(!y)return new F(this);for(t=new F(S),u=r=new F(S),i=c=new F(S),g=p(y),n=t.e=g.length-this.e-1,t.c[0]=h[(o=n%14)<0?14+o:o],e=!e||a.comparedTo(t)>0?n>0?t:u:a,o=N,N=1/0,a=new F(g),c.c[0]=0;d=w(a,t,0,1),1!=(s=r.plus(d.times(i))).comparedTo(e);)r=i,i=s,u=c.plus(d.times(s=u)),c=s,t=a.minus(d.times(s=t)),a=s;return s=w(e.minus(r),i,0,1),c=c.plus(s.times(u)),r=r.plus(s.times(i)),c.s=u.s=this.s,n*=2,f=1>w(u,i,n,O).minus(this).abs().comparedTo(w(c,r,n,O).minus(this).abs())?[u,i]:[c,r],N=o,f},b.toNumber=function(){return+q(this)},b.toPrecision=function(e,t){return null!=e&&g(e,1,1e9),L(this,e,t,2)},b.toString=function(e){var t,r=this,i=r.s,s=r.e;return null===s?i?(t="Infinity",i<0&&(t="-"+t)):t="NaN":(null==e?t=s<=C||s>=R?m(p(r.c),s):v(p(r.c),s,"0"):10===e&&M?t=v(p((r=B(new F(r),k+s+1,O)).c),r.e,"0"):(g(e,2,U.length,"Base"),t=A(v(p(r.c),s,"0"),10,e,i,!0)),i<0&&r.c[0]&&(t="-"+t)),t},b.valueOf=b.toJSON=function(){return q(this)},b._isBigNumber=!0,null!=t&&F.set(t),F}()).default=n.BigNumber=n,void 0!==(i=(function(){return n}).call(t,r,t,e))&&(e.exports=i)}(0)},97381:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r=Object.prototype.toString,i=Object.defineProperty,s=Object.getOwnPropertyDescriptor,n=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===r.call(e)},o=function(e){if(!e||"[object Object]"!==r.call(e))return!1;var i,s=t.call(e,"constructor"),n=e.constructor&&e.constructor.prototype&&t.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!s&&!n)return!1;for(i in e);return void 0===i||t.call(e,i)},a=function(e,t){i&&"__proto__"===t.name?i(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},c=function(e,r){if("__proto__"===r){if(!t.call(e,r))return;if(s)return s(e,r).value}return e[r]};e.exports=function e(){var t,r,i,s,l,u,h=arguments[0],d=1,p=arguments.length,f=!1;for("boolean"==typeof h&&(f=h,h=arguments[1]||{},d=2),(null==h||"object"!=typeof h&&"function"!=typeof h)&&(h={});d<p;++d)if(t=arguments[d],null!=t)for(r in t)i=c(h,r),h!==(s=c(t,r))&&(f&&s&&(o(s)||(l=n(s)))?(l?(l=!1,u=i&&n(i)?i:[]):u=i&&o(i)?i:{},a(h,{name:r,newValue:e(f,u,s)})):void 0!==s&&a(h,{name:r,newValue:s}));return h}},48207:(e,t,r)=>{"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.GaxiosError=t.GAXIOS_ERROR_SYMBOL=void 0,t.defaultErrorRedactor=function e(t){let r="<<REDACTED> - See `errorRedactor` option in `gaxios` for configuration>.";function i(e){if(e)for(let t of Object.keys(e))/^authentication$/i.test(t)&&(e[t]=r),/^authorization$/i.test(t)&&(e[t]=r),/secret/i.test(t)&&(e[t]=r)}function n(e,t){if("object"==typeof e&&null!==e&&"string"==typeof e[t]){let i=e[t];(/grant_type=/i.test(i)||/assertion=/i.test(i)||/secret/i.test(i))&&(e[t]=r)}}function o(e){"object"==typeof e&&null!==e&&("grant_type"in e&&(e.grant_type=r),"assertion"in e&&(e.assertion=r),"client_secret"in e&&(e.client_secret=r))}if(t.config){i(t.config.headers),n(t.config,"data"),o(t.config.data),n(t.config,"body"),o(t.config.body);try{let e=new s.URL("",t.config.url);e.searchParams.has("token")&&e.searchParams.set("token",r),e.searchParams.has("client_secret")&&e.searchParams.set("client_secret",r),t.config.url=e.toString()}catch(e){}}return t.response&&(e({config:t.response.config}),i(t.response.headers),n(t.response,"data"),o(t.response.data)),t};let s=r(57310),n=r(54645),o=function(e){return e&&e.__esModule?e:{default:e}}(r(97381));t.GAXIOS_ERROR_SYMBOL=Symbol.for(`${n.pkg.name}-gaxios-error`);class a extends Error{static[(i=t.GAXIOS_ERROR_SYMBOL,Symbol.hasInstance)](e){return!!e&&"object"==typeof e&&t.GAXIOS_ERROR_SYMBOL in e&&e[t.GAXIOS_ERROR_SYMBOL]===n.pkg.version||Function.prototype[Symbol.hasInstance].call(a,e)}constructor(e,t,r,s){var a;if(super(e),this.config=t,this.response=r,this.error=s,this[i]=n.pkg.version,this.config=(0,o.default)(!0,{},t),this.response&&(this.response.config=(0,o.default)(!0,{},this.response.config)),this.response){try{this.response.data=function(e,t){switch(e){case"stream":default:return t;case"json":return JSON.parse(JSON.stringify(t));case"arraybuffer":return JSON.parse(Buffer.from(t).toString("utf8"));case"blob":return JSON.parse(t.text())}}(this.config.responseType,null===(a=this.response)||void 0===a?void 0:a.data)}catch(e){}this.status=this.response.status}s&&"code"in s&&s.code&&(this.code=s.code),t.errorRedactor&&t.errorRedactor({config:this.config,response:this.response})}}t.GaxiosError=a},13521:(e,t,r)=>{"use strict";var i,s,n,o,a,c,l,u=Object.create?function(e,t,r,i){void 0===i&&(i=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,s)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]},h=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&u(t,e,r);return h(t,e),t},p=function(e,t,r,i){if("a"===r&&!i)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)},f=function(e,t,r,i,s){if("m"===i)throw TypeError("Private method is not writable");if("a"===i&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?s.call(e,r):s?s.value=r:t.set(e,r),r},g=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Gaxios=void 0;let y=g(r(97381)),m=r(95687),v=g(r(319)),_=g(r(63477)),E=g(r(50761)),w=r(57310),A=r(48207),T=r(64268),b=r(12781),S=r(45251),k=r(981),O=v.default;function C(e,t){for(let r of(t=t.toLowerCase(),Object.keys((null==e?void 0:e.headers)||{})))if(t===r.toLowerCase())return e.headers[r]}class R{constructor(e){i.add(this),this.agentCache=new Map,this.defaults=e||{},this.interceptors={request:new k.GaxiosInterceptorManager,response:new k.GaxiosInterceptorManager}}async request(e={}){return e=await p(this,i,"m",a).call(this,e),e=await p(this,i,"m",n).call(this,e),p(this,i,"m",o).call(this,this._request(e))}async _defaultAdapter(e){let t=e.fetchImplementation||O,r=await t(e.url,e),i=await this.getResponseData(e,r);return this.translateResponse(e,r,i)}async _request(e={}){var t;try{let t;if(t=e.adapter?await e.adapter(e,this._defaultAdapter.bind(this)):await this._defaultAdapter(e),!e.validateStatus(t.status)){if("stream"===e.responseType){let e="";await new Promise(r=>{(null==t?void 0:t.data).on("data",t=>{e+=t}),(null==t?void 0:t.data).on("end",r)}),t.data=e}throw new A.GaxiosError(`Request failed with status code ${t.status}`,e,t)}return t}catch(n){let r=n instanceof A.GaxiosError?n:new A.GaxiosError(n.message,e,void 0,n),{shouldRetry:i,config:s}=await (0,T.getRetryConfig)(r);if(i&&s)return r.config.retryConfig.currentRetryAttempt=s.retryConfig.currentRetryAttempt,e.retryConfig=null===(t=r.config)||void 0===t?void 0:t.retryConfig,this._request(e);throw r}}async getResponseData(e,t){switch(e.responseType){case"stream":return t.body;case"json":{let e=await t.text();try{e=JSON.parse(e)}catch(e){}return e}case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"text":return t.text();default:return this.getResponseDataFromContentType(t)}}validateStatus(e){return e>=200&&e<300}paramsSerializer(e){return _.default.stringify(e)}translateResponse(e,t,r){let i={};return t.headers.forEach((e,t)=>{i[t]=e}),{config:e,data:r,headers:i,status:t.status,statusText:t.statusText,request:{responseURL:t.url}}}async getResponseDataFromContentType(e){let t=e.headers.get("Content-Type");if(null===t)return e.text();if((t=t.toLowerCase()).includes("application/json")){let t=await e.text();try{t=JSON.parse(t)}catch(e){}return t}return t.match(/^text\//)?e.text():e.blob()}async *getMultipartRequest(e,t){let r=`--${t}--`;for(let r of e){let e=r.headers["Content-Type"]||"application/octet-stream",i=`--${t}\r
Content-Type: ${e}\r
\r
`;yield i,"string"==typeof r.content?yield r.content:yield*r.content,yield"\r\n"}yield r}}t.Gaxios=R,i=new WeakSet,s=function(e,t=[]){var r,i;let s=new w.URL(e),n=[...t];for(let e of(null===(i=null!==(r=process.env.NO_PROXY)&&void 0!==r?r:process.env.no_proxy)||void 0===i?void 0:i.split(","))||[])n.push(e.trim());for(let e of n)if(e instanceof RegExp){if(e.test(s.toString()))return!1}else if(e instanceof w.URL){if(e.origin===s.origin)return!1}else if(e.startsWith("*.")||e.startsWith(".")){let t=e.replace(/^\*\./,".");if(s.hostname.endsWith(t))return!1}else if(e===s.origin||e===s.hostname||e===s.href)return!1;return!0},n=async function(e){let t=Promise.resolve(e);for(let e of this.interceptors.request.values())e&&(t=t.then(e.resolved,e.rejected));return t},o=async function(e){let t=Promise.resolve(e);for(let e of this.interceptors.response.values())e&&(t=t.then(e.resolved,e.rejected));return t},a=async function(e){var t,r,n,o;let a=(0,y.default)(!0,{},this.defaults,e);if(!a.url)throw Error("URL is required.");let c=a.baseUrl||a.baseURL;if(c&&(a.url=c.toString()+a.url),a.paramsSerializer=a.paramsSerializer||this.paramsSerializer,a.params&&Object.keys(a.params).length>0){let e=a.paramsSerializer(a.params);e.startsWith("?")&&(e=e.slice(1));let t=a.url.toString().includes("?")?"&":"?";a.url=a.url+t+e}if("number"==typeof e.maxContentLength&&(a.size=e.maxContentLength),"number"==typeof e.maxRedirects&&(a.follow=e.maxRedirects),a.headers=a.headers||{},void 0===a.multipart&&a.data){let e="undefined"!=typeof FormData&&(null==a?void 0:a.data)instanceof FormData;E.default.readable(a.data)?a.body=a.data:"undefined"!=typeof Buffer&&Buffer.isBuffer(a.data)?(a.body=a.data,C(a,"Content-Type")||(a.headers["Content-Type"]="application/json")):"object"==typeof a.data?e||("application/x-www-form-urlencoded"===C(a,"content-type")?a.body=a.paramsSerializer(a.data):(C(a,"Content-Type")||(a.headers["Content-Type"]="application/json"),a.body=JSON.stringify(a.data))):a.body=a.data}else if(a.multipart&&a.multipart.length>0){let e=(0,S.v4)();a.headers["Content-Type"]=`multipart/related; boundary=${e}`;let t=new b.PassThrough;a.body=t,(0,b.pipeline)(this.getMultipartRequest(a.multipart,e),t,()=>{})}a.validateStatus=a.validateStatus||this.validateStatus,a.responseType=a.responseType||"unknown",a.headers.Accept||"json"!==a.responseType||(a.headers.Accept="application/json"),a.method=a.method||"GET";let u=a.proxy||(null===(t=null==process?void 0:process.env)||void 0===t?void 0:t.HTTPS_PROXY)||(null===(r=null==process?void 0:process.env)||void 0===r?void 0:r.https_proxy)||(null===(n=null==process?void 0:process.env)||void 0===n?void 0:n.HTTP_PROXY)||(null===(o=null==process?void 0:process.env)||void 0===o?void 0:o.http_proxy),h=p(this,i,"m",s).call(this,a.url,a.noProxy);if(a.agent);else if(u&&h){let e=await p(R,R,"m",l).call(R);this.agentCache.has(u)?a.agent=this.agentCache.get(u):(a.agent=new e(u,{cert:a.cert,key:a.key}),this.agentCache.set(u,a.agent))}else a.cert&&a.key&&(this.agentCache.has(a.key)?a.agent=this.agentCache.get(a.key):(a.agent=new m.Agent({cert:a.cert,key:a.key}),this.agentCache.set(a.key,a.agent)));return"function"!=typeof a.errorRedactor&&!1!==a.errorRedactor&&(a.errorRedactor=A.defaultErrorRedactor),a},l=async function(){return f(this,R,p(this,R,"f",c)||(await Promise.resolve().then(()=>d(r(46489)))).HttpsProxyAgent,"f",c),p(this,R,"f",c)},c={value:void 0}},49741:(e,t,r)=>{"use strict";var i=Object.create?function(e,t,r,i){void 0===i&&(i=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,s)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]};Object.defineProperty(t,"__esModule",{value:!0}),t.instance=t.Gaxios=t.GaxiosError=void 0,t.request=o;let s=r(13521);Object.defineProperty(t,"Gaxios",{enumerable:!0,get:function(){return s.Gaxios}});var n=r(48207);async function o(e){return t.instance.request(e)}Object.defineProperty(t,"GaxiosError",{enumerable:!0,get:function(){return n.GaxiosError}}),function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)}(r(981),t),t.instance=new s.Gaxios},981:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GaxiosInterceptorManager=void 0;class r extends Set{}t.GaxiosInterceptorManager=r},64268:(e,t)=>{"use strict";async function r(e){var t,r;let n=s(e);if(!e||!e.config||!n&&!e.config.retry)return{shouldRetry:!1};(n=n||{}).currentRetryAttempt=n.currentRetryAttempt||0,n.retry=void 0===n.retry||null===n.retry?3:n.retry,n.httpMethodsToRetry=n.httpMethodsToRetry||["GET","HEAD","PUT","OPTIONS","DELETE"],n.noResponseRetries=void 0===n.noResponseRetries||null===n.noResponseRetries?2:n.noResponseRetries,n.retryDelayMultiplier=n.retryDelayMultiplier?n.retryDelayMultiplier:2,n.timeOfFirstRequest=n.timeOfFirstRequest?n.timeOfFirstRequest:Date.now(),n.totalTimeout=n.totalTimeout?n.totalTimeout:Number.MAX_SAFE_INTEGER,n.maxRetryDelay=n.maxRetryDelay?n.maxRetryDelay:Number.MAX_SAFE_INTEGER,n.statusCodesToRetry=n.statusCodesToRetry||[[100,199],[408,408],[429,429],[500,599]],e.config.retryConfig=n;let o=n.shouldRetry||i;if(!await o(e))return{shouldRetry:!1,config:e.config};let a=Math.min(((t=n).currentRetryAttempt?0:null!==(r=t.retryDelay)&&void 0!==r?r:100)+(Math.pow(t.retryDelayMultiplier,t.currentRetryAttempt)-1)/2*1e3,t.totalTimeout-(Date.now()-t.timeOfFirstRequest),t.maxRetryDelay);e.config.retryConfig.currentRetryAttempt+=1;let c=n.retryBackoff?n.retryBackoff(e,a):new Promise(e=>{setTimeout(e,a)});return n.onRetryAttempt&&n.onRetryAttempt(e),await c,{shouldRetry:!0,config:e.config}}function i(e){var t;let r=s(e);if("AbortError"===e.name||(null===(t=e.error)||void 0===t?void 0:t.name)==="AbortError"||!r||0===r.retry||!e.response&&(r.currentRetryAttempt||0)>=r.noResponseRetries||!e.config.method||0>r.httpMethodsToRetry.indexOf(e.config.method.toUpperCase()))return!1;if(e.response&&e.response.status){let t=!1;for(let[i,s]of r.statusCodesToRetry){let r=e.response.status;if(r>=i&&r<=s){t=!0;break}}if(!t)return!1}return r.currentRetryAttempt=r.currentRetryAttempt||0,!(r.currentRetryAttempt>=r.retry)}function s(e){if(e&&e.config&&e.config.retryConfig)return e.config.retryConfig}Object.defineProperty(t,"__esModule",{value:!0}),t.getRetryConfig=r},54645:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pkg=void 0,t.pkg=r(17408)},45251:(e,t,r)=>{"use strict";let i,s;r.r(t),r.d(t,{NIL:()=>b,parse:()=>v,stringify:()=>f,v1:()=>m,v3:()=>E,v4:()=>A,v5:()=>T,validate:()=>h,version:()=>S});var n=r(6113),o=r.n(n);let a=new Uint8Array(256),c=a.length;function l(){return c>a.length-16&&(o().randomFillSync(a),c=0),a.slice(c,c+=16)}let u=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,h=function(e){return"string"==typeof e&&u.test(e)},d=[];for(let e=0;e<256;++e)d.push((e+256).toString(16).slice(1));function p(e,t=0){return d[e[t+0]]+d[e[t+1]]+d[e[t+2]]+d[e[t+3]]+"-"+d[e[t+4]]+d[e[t+5]]+"-"+d[e[t+6]]+d[e[t+7]]+"-"+d[e[t+8]]+d[e[t+9]]+"-"+d[e[t+10]]+d[e[t+11]]+d[e[t+12]]+d[e[t+13]]+d[e[t+14]]+d[e[t+15]]}let f=function(e,t=0){let r=p(e,t);if(!h(r))throw TypeError("Stringified UUID is invalid");return r},g=0,y=0,m=function(e,t,r){let n=t&&r||0,o=t||Array(16),a=(e=e||{}).node||i,c=void 0!==e.clockseq?e.clockseq:s;if(null==a||null==c){let t=e.random||(e.rng||l)();null==a&&(a=i=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==c&&(c=s=(t[6]<<8|t[7])&16383)}let u=void 0!==e.msecs?e.msecs:Date.now(),h=void 0!==e.nsecs?e.nsecs:y+1,d=u-g+(h-y)/1e4;if(d<0&&void 0===e.clockseq&&(c=c+1&16383),(d<0||u>g)&&void 0===e.nsecs&&(h=0),h>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");g=u,y=h,s=c;let f=((268435455&(u+=122192928e5))*1e4+h)%4294967296;o[n++]=f>>>24&255,o[n++]=f>>>16&255,o[n++]=f>>>8&255,o[n++]=255&f;let m=u/4294967296*1e4&268435455;o[n++]=m>>>8&255,o[n++]=255&m,o[n++]=m>>>24&15|16,o[n++]=m>>>16&255,o[n++]=c>>>8|128,o[n++]=255&c;for(let e=0;e<6;++e)o[n+e]=a[e];return t||p(o)},v=function(e){let t;if(!h(e))throw TypeError("Invalid UUID");let r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};function _(e,t,r){function i(e,i,s,n){var o;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof i&&(i=v(i)),(null===(o=i)||void 0===o?void 0:o.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let a=new Uint8Array(16+e.length);if(a.set(i),a.set(e,i.length),(a=r(a))[6]=15&a[6]|t,a[8]=63&a[8]|128,s){n=n||0;for(let e=0;e<16;++e)s[n+e]=a[e];return s}return p(a)}try{i.name=e}catch(e){}return i.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",i.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",i}let E=_("v3",48,function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),o().createHash("md5").update(e).digest()}),w={randomUUID:o().randomUUID},A=function(e,t,r){if(w.randomUUID&&!t&&!e)return w.randomUUID();let i=(e=e||{}).random||(e.rng||l)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=i[e];return t}return p(i)},T=_("v5",80,function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),o().createHash("sha1").update(e).digest()}),b="00000000-0000-0000-0000-000000000000",S=function(e){if(!h(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}},85292:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthClient=t.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS=t.DEFAULT_UNIVERSE=void 0;let i=r(82361),s=r(49741),n=r(43273),o=r(44598);t.DEFAULT_UNIVERSE="googleapis.com",t.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS=3e5;class a extends i.EventEmitter{constructor(e={}){var r,i,s,a,c;super(),this.credentials={},this.eagerRefreshThresholdMillis=t.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS,this.forceRefreshOnFailure=!1,this.universeDomain=t.DEFAULT_UNIVERSE;let l=(0,o.originalOrCamelOptions)(e);this.apiKey=e.apiKey,this.projectId=null!==(r=l.get("project_id"))&&void 0!==r?r:null,this.quotaProjectId=l.get("quota_project_id"),this.credentials=null!==(i=l.get("credentials"))&&void 0!==i?i:{},this.universeDomain=null!==(s=l.get("universe_domain"))&&void 0!==s?s:t.DEFAULT_UNIVERSE,this.transporter=null!==(a=e.transporter)&&void 0!==a?a:new n.DefaultTransporter,e.transporterOptions&&(this.transporter.defaults=e.transporterOptions),e.eagerRefreshThresholdMillis&&(this.eagerRefreshThresholdMillis=e.eagerRefreshThresholdMillis),this.forceRefreshOnFailure=null!==(c=e.forceRefreshOnFailure)&&void 0!==c&&c}get gaxios(){return this.transporter instanceof s.Gaxios?this.transporter:this.transporter instanceof n.DefaultTransporter||"instance"in this.transporter&&this.transporter.instance instanceof s.Gaxios?this.transporter.instance:null}setCredentials(e){this.credentials=e}addSharedMetadataHeaders(e){return!e["x-goog-user-project"]&&this.quotaProjectId&&(e["x-goog-user-project"]=this.quotaProjectId),e}static get RETRY_CONFIG(){return{retry:!0,retryConfig:{httpMethodsToRetry:["GET","PUT","POST","HEAD","OPTIONS","DELETE"]}}}}t.AuthClient=a},99130:(e,t,r)=>{"use strict";var i,s,n=function(e,t,r,i){if("a"===r&&!i)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.AwsClient=void 0;let o=r(54409),a=r(45966),c=r(81522),l=r(44598);class u extends a.BaseExternalAccountClient{constructor(e,t){super(e,t);let r=(0,l.originalOrCamelOptions)(e),o=r.get("credential_source"),a=r.get("aws_security_credentials_supplier");if(!o&&!a)throw Error("A credential source or AWS security credentials supplier must be specified.");if(o&&a)throw Error("Only one of credential source or AWS security credentials supplier can be specified.");if(a)this.awsSecurityCredentialsSupplier=a,this.regionalCredVerificationUrl=n(i,i,"f",s),this.credentialSourceType="programmatic";else{let e=(0,l.originalOrCamelOptions)(o);this.environmentId=e.get("environment_id");let t=e.get("region_url"),r=e.get("url"),i=e.get("imdsv2_session_token_url");this.awsSecurityCredentialsSupplier=new c.DefaultAwsSecurityCredentialsSupplier({regionUrl:t,securityCredentialsUrl:r,imdsV2SessionTokenUrl:i}),this.regionalCredVerificationUrl=e.get("regional_cred_verification_url"),this.credentialSourceType="aws",this.validateEnvironmentId()}this.awsRequestSigner=null,this.region=""}validateEnvironmentId(){var e;let t=null===(e=this.environmentId)||void 0===e?void 0:e.match(/^(aws)(\d+)$/);if(t&&this.regionalCredVerificationUrl){if(1!==parseInt(t[2],10))throw Error(`aws version "${t[2]}" is not supported in the current build.`)}else throw Error('No valid AWS "credential_source" provided')}async retrieveSubjectToken(){this.awsRequestSigner||(this.region=await this.awsSecurityCredentialsSupplier.getAwsRegion(this.supplierContext),this.awsRequestSigner=new o.AwsRequestSigner(async()=>this.awsSecurityCredentialsSupplier.getAwsSecurityCredentials(this.supplierContext),this.region));let e=await this.awsRequestSigner.getRequestOptions({...i.RETRY_CONFIG,url:this.regionalCredVerificationUrl.replace("{region}",this.region),method:"POST"}),t=[],r=Object.assign({"x-goog-cloud-target-resource":this.audience},e.headers);for(let e in r)t.push({key:e,value:r[e]});return encodeURIComponent(JSON.stringify({url:e.url,method:e.method,headers:t}))}}t.AwsClient=u,i=u,s={value:"https://sts.{region}.amazonaws.com?Action=GetCallerIdentity&Version=2011-06-15"},u.AWS_EC2_METADATA_IPV4_ADDRESS="169.254.169.254",u.AWS_EC2_METADATA_IPV6_ADDRESS="fd00:ec2::254"},54409:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AwsRequestSigner=void 0;let i=r(83365),s="AWS4-HMAC-SHA256";class n{constructor(e,t){this.getCredentials=e,this.region=t,this.crypto=(0,i.createCrypto)()}async getRequestOptions(e){if(!e.url)throw Error('"url" is required in "amzOptions"');let t="object"==typeof e.data?JSON.stringify(e.data):e.data,r=e.url,i=e.method||"GET",s=e.body||t,n=e.headers,o=await this.getCredentials(),a=new URL(r),l=await c({crypto:this.crypto,host:a.host,canonicalUri:a.pathname,canonicalQuerystring:a.search.substr(1),method:i,region:this.region,securityCredentials:o,requestPayload:s,additionalAmzHeaders:n}),u=Object.assign(l.amzDate?{"x-amz-date":l.amzDate}:{},{Authorization:l.authorizationHeader,host:a.host},n||{});o.token&&Object.assign(u,{"x-amz-security-token":o.token});let h={url:r,method:i,headers:u};return void 0!==s&&(h.body=s),h}}async function o(e,t,r){return await e.signWithHmacSha256(t,r)}async function a(e,t,r,i,s){let n=await o(e,`AWS4${t}`,r),a=await o(e,n,i),c=await o(e,a,s);return await o(e,c,"aws4_request")}async function c(e){let t=e.additionalAmzHeaders||{},r=e.requestPayload||"",n=e.host.split(".")[0],c=new Date,l=c.toISOString().replace(/[-:]/g,"").replace(/\.[0-9]+/,""),u=c.toISOString().replace(/[-]/g,"").replace(/T.*/,""),h={};Object.keys(t).forEach(e=>{h[e.toLowerCase()]=t[e]}),e.securityCredentials.token&&(h["x-amz-security-token"]=e.securityCredentials.token);let d=Object.assign({host:e.host},h.date?{}:{"x-amz-date":l},h),p="",f=Object.keys(d).sort();f.forEach(e=>{p+=`${e}:${d[e]}
`});let g=f.join(";"),y=await e.crypto.sha256DigestHex(r),m=`${e.method}
${e.canonicalUri}
${e.canonicalQuerystring}
${p}
${g}
${y}`,v=`${u}/${e.region}/${n}/aws4_request`,_=`${s}
${l}
${v}
`+await e.crypto.sha256DigestHex(m),E=await a(e.crypto,e.securityCredentials.secretAccessKey,u,e.region,n),w=await o(e.crypto,E,_),A=`${s} Credential=${e.securityCredentials.accessKeyId}/${v}, SignedHeaders=${g}, Signature=${(0,i.fromArrayBufferToHex)(w)}`;return{amzDate:h.date?void 0:l,authorizationHeader:A,canonicalQuerystring:e.canonicalQuerystring}}t.AwsRequestSigner=n},45966:(e,t,r)=>{"use strict";var i,s,n,o=function(e,t,r,i){if("a"===r&&!i)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)},a=function(e,t,r,i,s){if("m"===i)throw TypeError("Private method is not writable");if("a"===i&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?s.call(e,r):s?s.value=r:t.set(e,r),r};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseExternalAccountClient=t.DEFAULT_UNIVERSE=t.CLOUD_RESOURCE_MANAGER=t.EXTERNAL_ACCOUNT_TYPE=t.EXPIRATION_TIME_OFFSET=void 0;let c=r(12781),l=r(85292),u=r(58440),h=r(44598),d="https://www.googleapis.com/auth/cloud-platform";t.EXPIRATION_TIME_OFFSET=3e5,t.EXTERNAL_ACCOUNT_TYPE="external_account",t.CLOUD_RESOURCE_MANAGER="https://cloudresourcemanager.googleapis.com/v1/projects/";let p=r(78688);var f=r(85292);Object.defineProperty(t,"DEFAULT_UNIVERSE",{enumerable:!0,get:function(){return f.DEFAULT_UNIVERSE}});class g extends l.AuthClient{constructor(e,r){var n;super({...e,...r}),i.add(this),s.set(this,null);let o=(0,h.originalOrCamelOptions)(e),a=o.get("type");if(a&&a!==t.EXTERNAL_ACCOUNT_TYPE)throw Error(`Expected "${t.EXTERNAL_ACCOUNT_TYPE}" type but received "${e.type}"`);let c=o.get("client_id"),l=o.get("client_secret"),p=null!==(n=o.get("token_url"))&&void 0!==n?n:"https://sts.{universeDomain}/v1/token".replace("{universeDomain}",this.universeDomain),f=o.get("subject_token_type"),g=o.get("workforce_pool_user_project"),y=o.get("service_account_impersonation_url"),m=o.get("service_account_impersonation"),v=(0,h.originalOrCamelOptions)(m).get("token_lifetime_seconds");this.cloudResourceManagerURL=new URL(o.get("cloud_resource_manager_url")||`https://cloudresourcemanager.${this.universeDomain}/v1/projects/`),c&&(this.clientAuth={confidentialClientType:"basic",clientId:c,clientSecret:l}),this.stsCredential=new u.StsCredentials(p,this.clientAuth),this.scopes=o.get("scopes")||[d],this.cachedAccessToken=null,this.audience=o.get("audience"),this.subjectTokenType=f,this.workforcePoolUserProject=g;let _=RegExp("//iam\\.googleapis\\.com/locations/[^/]+/workforcePools/[^/]+/providers/.+");if(this.workforcePoolUserProject&&!this.audience.match(_))throw Error("workforcePoolUserProject should not be set for non-workforce pool credentials.");this.serviceAccountImpersonationUrl=y,this.serviceAccountImpersonationLifetime=v,this.serviceAccountImpersonationLifetime?this.configLifetimeRequested=!0:(this.configLifetimeRequested=!1,this.serviceAccountImpersonationLifetime=3600),this.projectNumber=this.getProjectNumber(this.audience),this.supplierContext={audience:this.audience,subjectTokenType:this.subjectTokenType,transporter:this.transporter}}getServiceAccountEmail(){var e;if(this.serviceAccountImpersonationUrl){if(this.serviceAccountImpersonationUrl.length>256)throw RangeError(`URL is too long: ${this.serviceAccountImpersonationUrl}`);let t=/serviceAccounts\/(?<email>[^:]+):generateAccessToken$/.exec(this.serviceAccountImpersonationUrl);return(null===(e=null==t?void 0:t.groups)||void 0===e?void 0:e.email)||null}return null}setCredentials(e){super.setCredentials(e),this.cachedAccessToken=e}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){let e=await this.getAccessToken(),t={Authorization:`Bearer ${e.token}`};return this.addSharedMetadataHeaders(t)}request(e,t){if(!t)return this.requestAsync(e);this.requestAsync(e).then(e=>t(null,e),e=>t(e,e.response))}async getProjectId(){let e=this.projectNumber||this.workforcePoolUserProject;if(this.projectId)return this.projectId;if(e){let t=await this.getRequestHeaders(),r=await this.transporter.request({...g.RETRY_CONFIG,headers:t,url:`${this.cloudResourceManagerURL.toString()}${e}`,responseType:"json"});return this.projectId=r.data.projectId,this.projectId}return null}async requestAsync(e,t=!1){let r;try{let t=await this.getRequestHeaders();e.headers=e.headers||{},t&&t["x-goog-user-project"]&&(e.headers["x-goog-user-project"]=t["x-goog-user-project"]),t&&t.Authorization&&(e.headers.Authorization=t.Authorization),r=await this.transporter.request(e)}catch(i){let r=i.response;if(r){let i=r.status,s=r.config.data instanceof c.Readable;if(!t&&(401===i||403===i)&&!s&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(e,!0)}throw i}return r}async refreshAccessTokenAsync(){a(this,s,o(this,s,"f")||o(this,i,"m",n).call(this),"f");try{return await o(this,s,"f")}finally{a(this,s,null,"f")}}getProjectNumber(e){let t=e.match(/\/projects\/([^/]+)/);return t?t[1]:null}async getImpersonatedAccessToken(e){let t={...g.RETRY_CONFIG,url:this.serviceAccountImpersonationUrl,method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},data:{scope:this.getScopesArray(),lifetime:this.serviceAccountImpersonationLifetime+"s"},responseType:"json"},r=await this.transporter.request(t),i=r.data;return{access_token:i.accessToken,expiry_date:new Date(i.expireTime).getTime(),res:r}}isExpired(e){let t=new Date().getTime();return!!e.expiry_date&&t>=e.expiry_date-this.eagerRefreshThresholdMillis}getScopesArray(){return"string"==typeof this.scopes?[this.scopes]:this.scopes||[d]}getMetricsHeaderValue(){let e=process.version.replace(/^v/,""),t=void 0!==this.serviceAccountImpersonationUrl,r=this.credentialSourceType?this.credentialSourceType:"unknown";return`gl-node/${e} auth/${p.version} google-byoid-sdk source/${r} sa-impersonation/${t} config-lifetime/${this.configLifetimeRequested}`}}t.BaseExternalAccountClient=g,s=new WeakMap,i=new WeakSet,n=async function(){let e=await this.retrieveSubjectToken(),t={grantType:"urn:ietf:params:oauth:grant-type:token-exchange",audience:this.audience,requestedTokenType:"urn:ietf:params:oauth:token-type:access_token",subjectToken:e,subjectTokenType:this.subjectTokenType,scope:this.serviceAccountImpersonationUrl?[d]:this.getScopesArray()},r=!this.clientAuth&&this.workforcePoolUserProject?{userProject:this.workforcePoolUserProject}:void 0,i={"x-goog-api-client":this.getMetricsHeaderValue()},s=await this.stsCredential.exchangeToken(t,i,r);return this.serviceAccountImpersonationUrl?this.cachedAccessToken=await this.getImpersonatedAccessToken(s.access_token):s.expires_in?this.cachedAccessToken={access_token:s.access_token,expiry_date:new Date().getTime()+1e3*s.expires_in,res:s.res}:this.cachedAccessToken={access_token:s.access_token,res:s.res},this.credentials={},Object.assign(this.credentials,this.cachedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedAccessToken.expiry_date,access_token:this.cachedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedAccessToken}},42977:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Compute=void 0;let i=r(49741),s=r(21394),n=r(57170);class o extends n.OAuth2Client{constructor(e={}){super(e),this.credentials={expiry_date:1,refresh_token:"compute-placeholder"},this.serviceAccountEmail=e.serviceAccountEmail||"default",this.scopes=Array.isArray(e.scopes)?e.scopes:e.scopes?[e.scopes]:[]}async refreshTokenNoCache(e){let t;let r=`service-accounts/${this.serviceAccountEmail}/token`;try{let e={property:r};this.scopes.length>0&&(e.params={scopes:this.scopes.join(",")}),t=await s.instance(e)}catch(e){throw e instanceof i.GaxiosError&&(e.message=`Could not refresh access token: ${e.message}`,this.wrapError(e)),e}let n=t;return t&&t.expires_in&&(n.expiry_date=new Date().getTime()+1e3*t.expires_in,delete n.expires_in),this.emit("tokens",n),{tokens:n,res:null}}async fetchIdToken(e){let t;let r=`service-accounts/${this.serviceAccountEmail}/identity?format=full&audience=${e}`;try{t=await s.instance({property:r})}catch(e){throw e instanceof Error&&(e.message=`Could not fetch ID token: ${e.message}`),e}return t}wrapError(e){let t=e.response;t&&t.status&&(e.status=t.status,403===t.status?e.message="A Forbidden error was returned while attempting to retrieve an access token for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have the correct permission scopes specified: "+e.message:404===t.status&&(e.message="A Not Found error was returned while attempting to retrieve an accesstoken for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have any permission scopes specified: "+e.message))}}t.Compute=o},81522:(e,t)=>{"use strict";var r,i,s,n,o,a,c=function(e,t,r,i){if("a"===r&&!i)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultAwsSecurityCredentialsSupplier=void 0;class l{constructor(e){r.add(this),this.regionUrl=e.regionUrl,this.securityCredentialsUrl=e.securityCredentialsUrl,this.imdsV2SessionTokenUrl=e.imdsV2SessionTokenUrl,this.additionalGaxiosOptions=e.additionalGaxiosOptions}async getAwsRegion(e){if(c(this,r,"a",o))return c(this,r,"a",o);let t={};if(!c(this,r,"a",o)&&this.imdsV2SessionTokenUrl&&(t["x-aws-ec2-metadata-token"]=await c(this,r,"m",i).call(this,e.transporter)),!this.regionUrl)throw Error('Unable to determine AWS region due to missing "options.credential_source.region_url"');let s={...this.additionalGaxiosOptions,url:this.regionUrl,method:"GET",responseType:"text",headers:t},n=await e.transporter.request(s);return n.data.substr(0,n.data.length-1)}async getAwsSecurityCredentials(e){if(c(this,r,"a",a))return c(this,r,"a",a);let t={};this.imdsV2SessionTokenUrl&&(t["x-aws-ec2-metadata-token"]=await c(this,r,"m",i).call(this,e.transporter));let o=await c(this,r,"m",s).call(this,t,e.transporter),l=await c(this,r,"m",n).call(this,o,t,e.transporter);return{accessKeyId:l.AccessKeyId,secretAccessKey:l.SecretAccessKey,token:l.Token}}}t.DefaultAwsSecurityCredentialsSupplier=l,r=new WeakSet,i=async function(e){let t={...this.additionalGaxiosOptions,url:this.imdsV2SessionTokenUrl,method:"PUT",responseType:"text",headers:{"x-aws-ec2-metadata-token-ttl-seconds":"300"}};return(await e.request(t)).data},s=async function(e,t){if(!this.securityCredentialsUrl)throw Error('Unable to determine AWS role name due to missing "options.credential_source.url"');let r={...this.additionalGaxiosOptions,url:this.securityCredentialsUrl,method:"GET",responseType:"text",headers:e};return(await t.request(r)).data},n=async function(e,t,r){return(await r.request({...this.additionalGaxiosOptions,url:`${this.securityCredentialsUrl}/${e}`,responseType:"json",headers:t})).data},o=function(){return process.env.AWS_REGION||process.env.AWS_DEFAULT_REGION||null},a=function(){return process.env.AWS_ACCESS_KEY_ID&&process.env.AWS_SECRET_ACCESS_KEY?{accessKeyId:process.env.AWS_ACCESS_KEY_ID,secretAccessKey:process.env.AWS_SECRET_ACCESS_KEY,token:process.env.AWS_SESSION_TOKEN}:null}},39200:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DownscopedClient=t.EXPIRATION_TIME_OFFSET=t.MAX_ACCESS_BOUNDARY_RULES_COUNT=void 0;let i=r(12781),s=r(85292),n=r(58440);t.MAX_ACCESS_BOUNDARY_RULES_COUNT=10,t.EXPIRATION_TIME_OFFSET=3e5;class o extends s.AuthClient{constructor(e,r,i,s){if(super({...i,quotaProjectId:s}),this.authClient=e,this.credentialAccessBoundary=r,0===r.accessBoundary.accessBoundaryRules.length)throw Error("At least one access boundary rule needs to be defined.");if(r.accessBoundary.accessBoundaryRules.length>t.MAX_ACCESS_BOUNDARY_RULES_COUNT)throw Error(`The provided access boundary has more than ${t.MAX_ACCESS_BOUNDARY_RULES_COUNT} access boundary rules.`);for(let e of r.accessBoundary.accessBoundaryRules)if(0===e.availablePermissions.length)throw Error("At least one permission should be defined in access boundary rules.");this.stsCredential=new n.StsCredentials(`https://sts.${this.universeDomain}/v1/token`),this.cachedDownscopedAccessToken=null}setCredentials(e){if(!e.expiry_date)throw Error("The access token expiry_date field is missing in the provided credentials.");super.setCredentials(e),this.cachedDownscopedAccessToken=e}async getAccessToken(){return(!this.cachedDownscopedAccessToken||this.isExpired(this.cachedDownscopedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedDownscopedAccessToken.access_token,expirationTime:this.cachedDownscopedAccessToken.expiry_date,res:this.cachedDownscopedAccessToken.res}}async getRequestHeaders(){let e=await this.getAccessToken(),t={Authorization:`Bearer ${e.token}`};return this.addSharedMetadataHeaders(t)}request(e,t){if(!t)return this.requestAsync(e);this.requestAsync(e).then(e=>t(null,e),e=>t(e,e.response))}async requestAsync(e,t=!1){let r;try{let t=await this.getRequestHeaders();e.headers=e.headers||{},t&&t["x-goog-user-project"]&&(e.headers["x-goog-user-project"]=t["x-goog-user-project"]),t&&t.Authorization&&(e.headers.Authorization=t.Authorization),r=await this.transporter.request(e)}catch(s){let r=s.response;if(r){let s=r.status,n=r.config.data instanceof i.Readable;if(!t&&(401===s||403===s)&&!n&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(e,!0)}throw s}return r}async refreshAccessTokenAsync(){var e;let t=(await this.authClient.getAccessToken()).token,r=await this.stsCredential.exchangeToken({grantType:"urn:ietf:params:oauth:grant-type:token-exchange",requestedTokenType:"urn:ietf:params:oauth:token-type:access_token",subjectToken:t,subjectTokenType:"urn:ietf:params:oauth:token-type:access_token"},void 0,this.credentialAccessBoundary),i=(null===(e=this.authClient.credentials)||void 0===e?void 0:e.expiry_date)||null,s=r.expires_in?new Date().getTime()+1e3*r.expires_in:i;return this.cachedDownscopedAccessToken={access_token:r.access_token,expiry_date:s,res:r.res},this.credentials={},Object.assign(this.credentials,this.cachedDownscopedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedDownscopedAccessToken.expiry_date,access_token:this.cachedDownscopedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedDownscopedAccessToken}isExpired(e){let t=new Date().getTime();return!!e.expiry_date&&t>=e.expiry_date-this.eagerRefreshThresholdMillis}}t.DownscopedClient=o},75698:(e,t,r)=>{"use strict";var i;let s;Object.defineProperty(t,"__esModule",{value:!0}),t.GCPEnv=void 0,t.clear=function(){s=void 0},t.getEnv=o;let n=r(21394);async function o(){return s||(s=a())}async function a(){return i.NONE,process.env.GAE_SERVICE||process.env.GAE_MODULE_NAME?i.APP_ENGINE:process.env.FUNCTION_NAME||process.env.FUNCTION_TARGET?i.CLOUD_FUNCTIONS:await l()?await c()?i.KUBERNETES_ENGINE:process.env.K_CONFIGURATION?i.CLOUD_RUN:i.COMPUTE_ENGINE:i.NONE}async function c(){try{return await n.instance("attributes/cluster-name"),!0}catch(e){return!1}}async function l(){return n.isAvailable()}!function(e){e.APP_ENGINE="APP_ENGINE",e.KUBERNETES_ENGINE="KUBERNETES_ENGINE",e.CLOUD_FUNCTIONS="CLOUD_FUNCTIONS",e.COMPUTE_ENGINE="COMPUTE_ENGINE",e.CLOUD_RUN="CLOUD_RUN",e.NONE="NONE"}(i||(t.GCPEnv=i={}))},96882:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidSubjectTokenError=t.InvalidMessageFieldError=t.InvalidCodeFieldError=t.InvalidTokenTypeFieldError=t.InvalidExpirationTimeFieldError=t.InvalidSuccessFieldError=t.InvalidVersionFieldError=t.ExecutableResponseError=t.ExecutableResponse=void 0;let r="urn:ietf:params:oauth:token-type:saml2",i="urn:ietf:params:oauth:token-type:id_token",s="urn:ietf:params:oauth:token-type:jwt";class n{constructor(e){if(!e.version)throw new a("Executable response must contain a 'version' field.");if(void 0===e.success)throw new c("Executable response must contain a 'success' field.");if(this.version=e.version,this.success=e.success,this.success){if(this.expirationTime=e.expiration_time,this.tokenType=e.token_type,this.tokenType!==r&&this.tokenType!==i&&this.tokenType!==s)throw new u(`Executable response must contain a 'token_type' field when successful and it must be one of ${i}, ${s}, or ${r}.`);if(this.tokenType===r){if(!e.saml_response)throw new p(`Executable response must contain a 'saml_response' field when token_type=${r}.`);this.subjectToken=e.saml_response}else{if(!e.id_token)throw new p(`Executable response must contain a 'id_token' field when token_type=${i} or ${s}.`);this.subjectToken=e.id_token}}else{if(!e.code)throw new h("Executable response must contain a 'code' field when unsuccessful.");if(!e.message)throw new d("Executable response must contain a 'message' field when unsuccessful.");this.errorCode=e.code,this.errorMessage=e.message}}isValid(){return!this.isExpired()&&this.success}isExpired(){return void 0!==this.expirationTime&&this.expirationTime<Math.round(Date.now()/1e3)}}t.ExecutableResponse=n;class o extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}t.ExecutableResponseError=o;class a extends o{}t.InvalidVersionFieldError=a;class c extends o{}t.InvalidSuccessFieldError=c;class l extends o{}t.InvalidExpirationTimeFieldError=l;class u extends o{}t.InvalidTokenTypeFieldError=u;class h extends o{}t.InvalidCodeFieldError=h;class d extends o{}t.InvalidMessageFieldError=d;class p extends o{}t.InvalidSubjectTokenError=p},38650:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExternalAccountAuthorizedUserClient=t.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE=void 0;let i=r(85292),s=r(42937),n=r(49741),o=r(12781),a=r(45966);t.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE="external_account_authorized_user";class c extends s.OAuthClientAuthHandler{constructor(e,t,r){super(r),this.url=e,this.transporter=t}async refreshToken(e,t){let r=new URLSearchParams({grant_type:"refresh_token",refresh_token:e}),i={"Content-Type":"application/x-www-form-urlencoded",...t},o={...c.RETRY_CONFIG,url:this.url,method:"POST",headers:i,data:r.toString(),responseType:"json"};this.applyClientAuthenticationOptions(o);try{let e=await this.transporter.request(o),t=e.data;return t.res=e,t}catch(e){if(e instanceof n.GaxiosError&&e.response)throw(0,s.getErrorFromOAuthErrorResponse)(e.response.data,e);throw e}}}class l extends i.AuthClient{constructor(e,t){var r;super({...e,...t}),e.universe_domain&&(this.universeDomain=e.universe_domain),this.refreshToken=e.refresh_token;let i={confidentialClientType:"basic",clientId:e.client_id,clientSecret:e.client_secret};this.externalAccountAuthorizedUserHandler=new c(null!==(r=e.token_url)&&void 0!==r?r:"https://sts.{universeDomain}/v1/oauthtoken".replace("{universeDomain}",this.universeDomain),this.transporter,i),this.cachedAccessToken=null,this.quotaProjectId=e.quota_project_id,"number"!=typeof(null==t?void 0:t.eagerRefreshThresholdMillis)?this.eagerRefreshThresholdMillis=a.EXPIRATION_TIME_OFFSET:this.eagerRefreshThresholdMillis=t.eagerRefreshThresholdMillis,this.forceRefreshOnFailure=!!(null==t?void 0:t.forceRefreshOnFailure)}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){let e=await this.getAccessToken(),t={Authorization:`Bearer ${e.token}`};return this.addSharedMetadataHeaders(t)}request(e,t){if(!t)return this.requestAsync(e);this.requestAsync(e).then(e=>t(null,e),e=>t(e,e.response))}async requestAsync(e,t=!1){let r;try{let t=await this.getRequestHeaders();e.headers=e.headers||{},t&&t["x-goog-user-project"]&&(e.headers["x-goog-user-project"]=t["x-goog-user-project"]),t&&t.Authorization&&(e.headers.Authorization=t.Authorization),r=await this.transporter.request(e)}catch(i){let r=i.response;if(r){let i=r.status,s=r.config.data instanceof o.Readable;if(!t&&(401===i||403===i)&&!s&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(e,!0)}throw i}return r}async refreshAccessTokenAsync(){let e=await this.externalAccountAuthorizedUserHandler.refreshToken(this.refreshToken);return this.cachedAccessToken={access_token:e.access_token,expiry_date:new Date().getTime()+1e3*e.expires_in,res:e.res},void 0!==e.refresh_token&&(this.refreshToken=e.refresh_token),this.cachedAccessToken}isExpired(e){let t=new Date().getTime();return!!e.expiry_date&&t>=e.expiry_date-this.eagerRefreshThresholdMillis}}t.ExternalAccountAuthorizedUserClient=l},45643:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExternalAccountClient=void 0;let i=r(45966),s=r(36157),n=r(99130),o=r(17612);class a{constructor(){throw Error("ExternalAccountClients should be initialized via: ExternalAccountClient.fromJSON(), directly via explicit constructors, eg. new AwsClient(options), new IdentityPoolClient(options), newPluggableAuthClientOptions, or via new GoogleAuth(options).getClient()")}static fromJSON(e,t){var r,a;return e&&e.type===i.EXTERNAL_ACCOUNT_TYPE?(null===(r=e.credential_source)||void 0===r?void 0:r.environment_id)?new n.AwsClient(e,t):(null===(a=e.credential_source)||void 0===a?void 0:a.executable)?new o.PluggableAuthClient(e,t):new s.IdentityPoolClient(e,t):null}}t.ExternalAccountClient=a},42190:(e,t,r)=>{"use strict";var i,s,n;Object.defineProperty(t,"__esModule",{value:!0}),t.FileSubjectTokenSupplier=void 0;let o=r(73837),a=r(57147),c=(0,o.promisify)(null!==(i=a.readFile)&&void 0!==i?i:()=>{}),l=(0,o.promisify)(null!==(s=a.realpath)&&void 0!==s?s:()=>{}),u=(0,o.promisify)(null!==(n=a.lstat)&&void 0!==n?n:()=>{});class h{constructor(e){this.filePath=e.filePath,this.formatType=e.formatType,this.subjectTokenFieldName=e.subjectTokenFieldName}async getSubjectToken(e){let t,r=this.filePath;try{if(r=await l(r),!(await u(r)).isFile())throw Error()}catch(e){throw e instanceof Error&&(e.message=`The file at ${r} does not exist, or it is not a file. ${e.message}`),e}let i=await c(r,{encoding:"utf8"});if("text"===this.formatType?t=i:"json"===this.formatType&&this.subjectTokenFieldName&&(t=JSON.parse(i)[this.subjectTokenFieldName]),!t)throw Error("Unable to parse the subject_token from the credential_source file");return t}}t.FileSubjectTokenSupplier=h},27090:(e,t,r)=>{"use strict";var i,s,n,o,a=function(e,t,r,i){if("a"===r&&!i)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)},c=function(e,t,r,i,s){if("m"===i)throw TypeError("Private method is not writable");if("a"===i&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?s.call(e,r):s?s.value=r:t.set(e,r),r};Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleAuth=t.GoogleAuthExceptionMessages=t.CLOUD_SDK_CLIENT_ID=void 0;let l=r(32081),u=r(57147),h=r(21394),d=r(22037),p=r(71017),f=r(83365),g=r(43273),y=r(42977),m=r(79376),v=r(75698),_=r(97536),E=r(95314),w=r(14625),A=r(45643),T=r(45966),b=r(85292),S=r(38650),k=r(44598);t.CLOUD_SDK_CLIENT_ID="764086051850-6qr4p6gpi6hn506pt8ejuq83di341hur.apps.googleusercontent.com",t.GoogleAuthExceptionMessages={API_KEY_WITH_CREDENTIALS:"API Keys and Credentials are mutually exclusive authentication methods and cannot be used together.",NO_PROJECT_ID_FOUND:"Unable to detect a Project Id in the current environment. \nTo learn more about authentication and Google APIs, visit: \nhttps://cloud.google.com/docs/authentication/getting-started",NO_CREDENTIALS_FOUND:"Unable to find credentials in current environment. \nTo learn more about authentication and Google APIs, visit: \nhttps://cloud.google.com/docs/authentication/getting-started",NO_ADC_FOUND:"Could not load the default credentials. Browse to https://cloud.google.com/docs/authentication/getting-started for more information.",NO_UNIVERSE_DOMAIN_FOUND:"Unable to detect a Universe Domain in the current environment.\nTo learn more about Universe Domain retrieval, visit: \nhttps://cloud.google.com/compute/docs/metadata/predefined-metadata-keys"};class O{get isGCE(){return this.checkIsGCE}constructor(e={}){if(i.add(this),this.checkIsGCE=void 0,this.jsonContent=null,this.cachedCredential=null,s.set(this,null),this.clientOptions={},this._cachedProjectId=e.projectId||null,this.cachedCredential=e.authClient||null,this.keyFilename=e.keyFilename||e.keyFile,this.scopes=e.scopes,this.clientOptions=e.clientOptions||{},this.jsonContent=e.credentials||null,this.apiKey=e.apiKey||this.clientOptions.apiKey||null,this.apiKey&&(this.jsonContent||this.clientOptions.credentials))throw RangeError(t.GoogleAuthExceptionMessages.API_KEY_WITH_CREDENTIALS);e.universeDomain&&(this.clientOptions.universeDomain=e.universeDomain)}setGapicJWTValues(e){e.defaultServicePath=this.defaultServicePath,e.useJWTAccessWithScope=this.useJWTAccessWithScope,e.defaultScopes=this.defaultScopes}getProjectId(e){if(!e)return this.getProjectIdAsync();this.getProjectIdAsync().then(t=>e(null,t),e)}async getProjectIdOptional(){try{return await this.getProjectId()}catch(e){if(e instanceof Error&&e.message===t.GoogleAuthExceptionMessages.NO_PROJECT_ID_FOUND)return null;throw e}}async findAndCacheProjectId(){let e=null;if((e=await this.getProductionProjectId())||(e=await this.getFileProjectId()),e||(e=await this.getDefaultServiceProjectId()),e||(e=await this.getGCEProjectId()),e||(e=await this.getExternalAccountClientProjectId()),e)return this._cachedProjectId=e,e;throw Error(t.GoogleAuthExceptionMessages.NO_PROJECT_ID_FOUND)}async getProjectIdAsync(){return this._cachedProjectId?this._cachedProjectId:(this._findProjectIdPromise||(this._findProjectIdPromise=this.findAndCacheProjectId()),this._findProjectIdPromise)}async getUniverseDomainFromMetadataServer(){var e;let t;try{(t=await h.universe("universe-domain"))||(t=b.DEFAULT_UNIVERSE)}catch(r){if(r&&(null===(e=null==r?void 0:r.response)||void 0===e?void 0:e.status)===404)t=b.DEFAULT_UNIVERSE;else throw r}return t}async getUniverseDomain(){let e=(0,k.originalOrCamelOptions)(this.clientOptions).get("universe_domain");try{null!=e||(e=(await this.getClient()).universeDomain)}catch(t){null!=e||(e=b.DEFAULT_UNIVERSE)}return e}getAnyScopes(){return this.scopes||this.defaultScopes}getApplicationDefault(e={},t){let r;if("function"==typeof e?t=e:r=e,!t)return this.getApplicationDefaultAsync(r);this.getApplicationDefaultAsync(r).then(e=>t(null,e.credential,e.projectId),t)}async getApplicationDefaultAsync(e={}){let r;if(this.cachedCredential)return await a(this,i,"m",n).call(this,this.cachedCredential,null);if((r=await this._tryGetApplicationCredentialsFromEnvironmentVariable(e))||(r=await this._tryGetApplicationCredentialsFromWellKnownFile(e)))return r instanceof _.JWT?r.scopes=this.scopes:r instanceof T.BaseExternalAccountClient&&(r.scopes=this.getAnyScopes()),await a(this,i,"m",n).call(this,r);if(await this._checkIsGCE())return e.scopes=this.getAnyScopes(),await a(this,i,"m",n).call(this,new y.Compute(e));throw Error(t.GoogleAuthExceptionMessages.NO_ADC_FOUND)}async _checkIsGCE(){return void 0===this.checkIsGCE&&(this.checkIsGCE=h.getGCPResidency()||await h.isAvailable()),this.checkIsGCE}async _tryGetApplicationCredentialsFromEnvironmentVariable(e){let t=process.env.GOOGLE_APPLICATION_CREDENTIALS||process.env.google_application_credentials;if(!t||0===t.length)return null;try{return this._getApplicationCredentialsFromFilePath(t,e)}catch(e){throw e instanceof Error&&(e.message=`Unable to read the credential file specified by the GOOGLE_APPLICATION_CREDENTIALS environment variable: ${e.message}`),e}}async _tryGetApplicationCredentialsFromWellKnownFile(e){let t=null;if(this._isWindows())t=process.env.APPDATA;else{let e=process.env.HOME;e&&(t=p.join(e,".config"))}return(t&&(t=p.join(t,"gcloud","application_default_credentials.json"),u.existsSync(t)||(t=null)),t)?await this._getApplicationCredentialsFromFilePath(t,e):null}async _getApplicationCredentialsFromFilePath(e,t={}){if(!e||0===e.length)throw Error("The file path is invalid.");try{if(e=u.realpathSync(e),!u.lstatSync(e).isFile())throw Error()}catch(t){throw t instanceof Error&&(t.message=`The file at ${e} does not exist, or it is not a file. ${t.message}`),t}let r=u.createReadStream(e);return this.fromStream(r,t)}fromImpersonatedJSON(e){var t,r,i,s;if(!e)throw Error("Must pass in a JSON object containing an  impersonated refresh token");if(e.type!==w.IMPERSONATED_ACCOUNT_TYPE)throw Error(`The incoming JSON object does not have the "${w.IMPERSONATED_ACCOUNT_TYPE}" type`);if(!e.source_credentials)throw Error("The incoming JSON object does not contain a source_credentials field");if(!e.service_account_impersonation_url)throw Error("The incoming JSON object does not contain a service_account_impersonation_url field");let n=this.fromJSON(e.source_credentials);if((null===(t=e.service_account_impersonation_url)||void 0===t?void 0:t.length)>256)throw RangeError(`Target principal is too long: ${e.service_account_impersonation_url}`);let o=null===(i=null===(r=/(?<target>[^/]+):(generateAccessToken|generateIdToken)$/.exec(e.service_account_impersonation_url))||void 0===r?void 0:r.groups)||void 0===i?void 0:i.target;if(!o)throw RangeError(`Cannot extract target principal from ${e.service_account_impersonation_url}`);let a=null!==(s=this.getAnyScopes())&&void 0!==s?s:[];return new w.Impersonated({...e,sourceClient:n,targetPrincipal:o,targetScopes:Array.isArray(a)?a:[a]})}fromJSON(e,t={}){let r;let i=(0,k.originalOrCamelOptions)(t).get("universe_domain");return e.type===E.USER_REFRESH_ACCOUNT_TYPE?(r=new E.UserRefreshClient(t)).fromJSON(e):e.type===w.IMPERSONATED_ACCOUNT_TYPE?r=this.fromImpersonatedJSON(e):e.type===T.EXTERNAL_ACCOUNT_TYPE?(r=A.ExternalAccountClient.fromJSON(e,t)).scopes=this.getAnyScopes():e.type===S.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE?r=new S.ExternalAccountAuthorizedUserClient(e,t):(t.scopes=this.scopes,r=new _.JWT(t),this.setGapicJWTValues(r),r.fromJSON(e)),i&&(r.universeDomain=i),r}_cacheClientFromJSON(e,t){let r=this.fromJSON(e,t);return this.jsonContent=e,this.cachedCredential=r,r}fromStream(e,t={},r){let i={};if("function"==typeof t?r=t:i=t,!r)return this.fromStreamAsync(e,i);this.fromStreamAsync(e,i).then(e=>r(null,e),r)}fromStreamAsync(e,t){return new Promise((r,i)=>{if(!e)throw Error("Must pass in a stream containing the Google auth settings.");let s=[];e.setEncoding("utf8").on("error",i).on("data",e=>s.push(e)).on("end",()=>{try{try{let e=JSON.parse(s.join("")),i=this._cacheClientFromJSON(e,t);return r(i)}catch(t){if(!this.keyFilename)throw t;let e=new _.JWT({...this.clientOptions,keyFile:this.keyFilename});return this.cachedCredential=e,this.setGapicJWTValues(e),r(e)}}catch(e){return i(e)}})})}fromAPIKey(e,t={}){return new _.JWT({...t,apiKey:e})}_isWindows(){let e=d.platform();return!!e&&e.length>=3&&"win"===e.substring(0,3).toLowerCase()}async getDefaultServiceProjectId(){return new Promise(e=>{(0,l.exec)("gcloud config config-helper --format json",(t,r)=>{if(!t&&r)try{let t=JSON.parse(r).configuration.properties.core.project;e(t);return}catch(e){}e(null)})})}getProductionProjectId(){return process.env.GCLOUD_PROJECT||process.env.GOOGLE_CLOUD_PROJECT||process.env.gcloud_project||process.env.google_cloud_project}async getFileProjectId(){if(this.cachedCredential)return this.cachedCredential.projectId;if(this.keyFilename){let e=await this.getClient();if(e&&e.projectId)return e.projectId}let e=await this._tryGetApplicationCredentialsFromEnvironmentVariable();return e?e.projectId:null}async getExternalAccountClientProjectId(){if(!this.jsonContent||this.jsonContent.type!==T.EXTERNAL_ACCOUNT_TYPE)return null;let e=await this.getClient();return await e.getProjectId()}async getGCEProjectId(){try{return await h.project("project-id")}catch(e){return null}}getCredentials(e){if(!e)return this.getCredentialsAsync();this.getCredentialsAsync().then(t=>e(null,t),e)}async getCredentialsAsync(){let e=await this.getClient();if(e instanceof w.Impersonated)return{client_email:e.getTargetPrincipal()};if(e instanceof T.BaseExternalAccountClient){let t=e.getServiceAccountEmail();if(t)return{client_email:t,universe_domain:e.universeDomain}}if(this.jsonContent)return{client_email:this.jsonContent.client_email,private_key:this.jsonContent.private_key,universe_domain:this.jsonContent.universe_domain};if(await this._checkIsGCE()){let[e,t]=await Promise.all([h.instance("service-accounts/default/email"),this.getUniverseDomain()]);return{client_email:e,universe_domain:t}}throw Error(t.GoogleAuthExceptionMessages.NO_CREDENTIALS_FOUND)}async getClient(){if(this.cachedCredential)return this.cachedCredential;c(this,s,a(this,s,"f")||a(this,i,"m",o).call(this),"f");try{return await a(this,s,"f")}finally{c(this,s,null,"f")}}async getIdTokenClient(e){let t=await this.getClient();if(!("fetchIdToken"in t))throw Error("Cannot fetch ID token in this environment, use GCE or set the GOOGLE_APPLICATION_CREDENTIALS environment variable to a service account credentials JSON file.");return new m.IdTokenClient({targetAudience:e,idTokenProvider:t})}async getAccessToken(){let e=await this.getClient();return(await e.getAccessToken()).token}async getRequestHeaders(e){return(await this.getClient()).getRequestHeaders(e)}async authorizeRequest(e){let t=(e=e||{}).url||e.uri,r=await this.getClient(),i=await r.getRequestHeaders(t);return e.headers=Object.assign(e.headers||{},i),e}async request(e){return(await this.getClient()).request(e)}getEnv(){return(0,v.getEnv)()}async sign(e,t){let r=await this.getClient(),i=await this.getUniverseDomain();if(t=t||`https://iamcredentials.${i}/v1/projects/-/serviceAccounts/`,r instanceof w.Impersonated)return(await r.sign(e)).signedBlob;let s=(0,f.createCrypto)();if(r instanceof _.JWT&&r.key)return await s.sign(r.key,e);let n=await this.getCredentials();if(!n.client_email)throw Error("Cannot sign data without `client_email`.");return this.signBlob(s,n.client_email,e,t)}async signBlob(e,t,r,i){let s=new URL(i+`${t}:signBlob`);return(await this.request({method:"POST",url:s.href,data:{payload:e.encodeBase64StringUtf8(r)},retry:!0,retryConfig:{httpMethodsToRetry:["POST"]}})).data.signedBlob}}t.GoogleAuth=O,s=new WeakMap,i=new WeakSet,n=async function(e,t=process.env.GOOGLE_CLOUD_QUOTA_PROJECT||null){let r=await this.getProjectIdOptional();return t&&(e.quotaProjectId=t),this.cachedCredential=e,{credential:e,projectId:r}},o=async function(){if(this.jsonContent)return this._cacheClientFromJSON(this.jsonContent,this.clientOptions);if(this.keyFilename){let e=p.resolve(this.keyFilename),t=u.createReadStream(e);return await this.fromStreamAsync(t,this.clientOptions)}if(this.apiKey){let e=await this.fromAPIKey(this.apiKey,this.clientOptions);e.scopes=this.scopes;let{credential:t}=await a(this,i,"m",n).call(this,e);return t}{let{credential:e}=await this.getApplicationDefaultAsync(this.clientOptions);return e}},O.DefaultTransporter=g.DefaultTransporter},29309:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IAMAuth=void 0;class r{constructor(e,t){this.selector=e,this.token=t,this.selector=e,this.token=t}getRequestHeaders(){return{"x-goog-iam-authority-selector":this.selector,"x-goog-iam-authorization-token":this.token}}}t.IAMAuth=r},36157:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdentityPoolClient=void 0;let i=r(45966),s=r(44598),n=r(42190),o=r(48486);class a extends i.BaseExternalAccountClient{constructor(e,t){super(e,t);let r=(0,s.originalOrCamelOptions)(e),i=r.get("credential_source"),c=r.get("subject_token_supplier");if(!i&&!c)throw Error("A credential source or subject token supplier must be specified.");if(i&&c)throw Error("Only one of credential source or subject token supplier can be specified.");if(c)this.subjectTokenSupplier=c,this.credentialSourceType="programmatic";else{let e=(0,s.originalOrCamelOptions)(i),t=(0,s.originalOrCamelOptions)(e.get("format")),r=t.get("type")||"text",c=t.get("subject_token_field_name");if("json"!==r&&"text"!==r)throw Error(`Invalid credential_source format "${r}"`);if("json"===r&&!c)throw Error("Missing subject_token_field_name for JSON credential_source format");let l=e.get("file"),u=e.get("url"),h=e.get("headers");if(l&&u)throw Error('No valid Identity Pool "credential_source" provided, must be either file or url.');if(l&&!u)this.credentialSourceType="file",this.subjectTokenSupplier=new n.FileSubjectTokenSupplier({filePath:l,formatType:r,subjectTokenFieldName:c});else if(!l&&u)this.credentialSourceType="url",this.subjectTokenSupplier=new o.UrlSubjectTokenSupplier({url:u,formatType:r,subjectTokenFieldName:c,headers:h,additionalGaxiosOptions:a.RETRY_CONFIG});else throw Error('No valid Identity Pool "credential_source" provided, must be either file or url.')}}async retrieveSubjectToken(){return this.subjectTokenSupplier.getSubjectToken(this.supplierContext)}}t.IdentityPoolClient=a},79376:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdTokenClient=void 0;let i=r(57170);class s extends i.OAuth2Client{constructor(e){super(e),this.targetAudience=e.targetAudience,this.idTokenProvider=e.idTokenProvider}async getRequestMetadataAsync(e){if(!this.credentials.id_token||!this.credentials.expiry_date||this.isTokenExpiring()){let e=await this.idTokenProvider.fetchIdToken(this.targetAudience);this.credentials={id_token:e,expiry_date:this.getIdTokenExpiryDate(e)}}return{headers:{Authorization:"Bearer "+this.credentials.id_token}}}getIdTokenExpiryDate(e){let t=e.split(".")[1];if(t)return 1e3*JSON.parse(Buffer.from(t,"base64").toString("ascii")).exp}}t.IdTokenClient=s},14625:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Impersonated=t.IMPERSONATED_ACCOUNT_TYPE=void 0;let i=r(57170),s=r(49741),n=r(44598);t.IMPERSONATED_ACCOUNT_TYPE="impersonated_service_account";class o extends i.OAuth2Client{constructor(e={}){var t,r,s,o,a,c;if(super(e),this.credentials={expiry_date:1,refresh_token:"impersonated-placeholder"},this.sourceClient=null!==(t=e.sourceClient)&&void 0!==t?t:new i.OAuth2Client,this.targetPrincipal=null!==(r=e.targetPrincipal)&&void 0!==r?r:"",this.delegates=null!==(s=e.delegates)&&void 0!==s?s:[],this.targetScopes=null!==(o=e.targetScopes)&&void 0!==o?o:[],this.lifetime=null!==(a=e.lifetime)&&void 0!==a?a:3600,(0,n.originalOrCamelOptions)(e).get("universe_domain")){if(this.sourceClient.universeDomain!==this.universeDomain)throw RangeError(`Universe domain ${this.sourceClient.universeDomain} in source credentials does not match ${this.universeDomain} universe domain set for impersonated credentials.`)}else this.universeDomain=this.sourceClient.universeDomain;this.endpoint=null!==(c=e.endpoint)&&void 0!==c?c:`https://iamcredentials.${this.universeDomain}`}async sign(e){await this.sourceClient.getAccessToken();let t=`projects/-/serviceAccounts/${this.targetPrincipal}`,r=`${this.endpoint}/v1/${t}:signBlob`,i={delegates:this.delegates,payload:Buffer.from(e).toString("base64")};return(await this.sourceClient.request({...o.RETRY_CONFIG,url:r,data:i,method:"POST"})).data}getTargetPrincipal(){return this.targetPrincipal}async refreshToken(){var e,t,r,i,n,a;try{await this.sourceClient.getAccessToken();let e="projects/-/serviceAccounts/"+this.targetPrincipal,t=`${this.endpoint}/v1/${e}:generateAccessToken`,r={delegates:this.delegates,scope:this.targetScopes,lifetime:this.lifetime+"s"},i=await this.sourceClient.request({...o.RETRY_CONFIG,url:t,data:r,method:"POST"}),s=i.data;return this.credentials.access_token=s.accessToken,this.credentials.expiry_date=Date.parse(s.expireTime),{tokens:this.credentials,res:i}}catch(l){if(!(l instanceof Error))throw l;let o=0,c="";if(l instanceof s.GaxiosError&&(o=null===(r=null===(t=null===(e=null==l?void 0:l.response)||void 0===e?void 0:e.data)||void 0===t?void 0:t.error)||void 0===r?void 0:r.status,c=null===(a=null===(n=null===(i=null==l?void 0:l.response)||void 0===i?void 0:i.data)||void 0===n?void 0:n.error)||void 0===a?void 0:a.message),o&&c)throw l.message=`${o}: unable to impersonate: ${c}`,l;throw l.message=`unable to impersonate: ${l}`,l}}async fetchIdToken(e,t){var r,i;await this.sourceClient.getAccessToken();let s=`projects/-/serviceAccounts/${this.targetPrincipal}`,n=`${this.endpoint}/v1/${s}:generateIdToken`,a={delegates:this.delegates,audience:e,includeEmail:null===(r=null==t?void 0:t.includeEmail)||void 0===r||r,useEmailAzp:null===(i=null==t?void 0:t.includeEmail)||void 0===i||i};return(await this.sourceClient.request({...o.RETRY_CONFIG,url:n,data:a,method:"POST"})).data.token}}t.Impersonated=o},68946:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JWTAccess=void 0;let i=r(30826),s=r(44598),n={alg:"RS256",typ:"JWT"};class o{constructor(e,t,r,i){this.cache=new s.LRUCache({capacity:500,maxAge:36e5}),this.email=e,this.key=t,this.keyId=r,this.eagerRefreshThresholdMillis=null!=i?i:3e5}getCachedKey(e,t){let r=e;if(t&&Array.isArray(t)&&t.length?r=e?`${e}_${t.join("_")}`:`${t.join("_")}`:"string"==typeof t&&(r=e?`${e}_${t}`:t),!r)throw Error("Scopes or url must be provided");return r}getRequestHeaders(e,t,r){let s;let a=this.getCachedKey(e,r),c=this.cache.get(a),l=Date.now();if(c&&c.expiration-l>this.eagerRefreshThresholdMillis)return c.headers;let u=Math.floor(Date.now()/1e3),h=o.getExpirationTime(u);if(Array.isArray(r)&&(r=r.join(" ")),s=r?{iss:this.email,sub:this.email,scope:r,exp:h,iat:u}:{iss:this.email,sub:this.email,aud:e,exp:h,iat:u},t){for(let e in s)if(t[e])throw Error(`The '${e}' property is not allowed when passing additionalClaims. This claim is included in the JWT by default.`)}let d=this.keyId?{...n,kid:this.keyId}:n,p=Object.assign(s,t),f=i.sign({header:d,payload:p,secret:this.key}),g={Authorization:`Bearer ${f}`};return this.cache.set(a,{expiration:1e3*h,headers:g}),g}static getExpirationTime(e){return e+3600}fromJSON(e){if(!e)throw Error("Must pass in a JSON object containing the service account auth settings.");if(!e.client_email)throw Error("The incoming JSON object does not contain a client_email field");if(!e.private_key)throw Error("The incoming JSON object does not contain a private_key field");this.email=e.client_email,this.key=e.private_key,this.keyId=e.private_key_id,this.projectId=e.project_id}fromStream(e,t){if(!t)return this.fromStreamAsync(e);this.fromStreamAsync(e).then(()=>t(),t)}fromStreamAsync(e){return new Promise((t,r)=>{e||r(Error("Must pass in a stream containing the service account auth settings."));let i="";e.setEncoding("utf8").on("data",e=>i+=e).on("error",r).on("end",()=>{try{let e=JSON.parse(i);this.fromJSON(e),t()}catch(e){r(e)}})})}}t.JWTAccess=o},97536:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JWT=void 0;let i=r(63184),s=r(68946),n=r(57170),o=r(85292);class a extends n.OAuth2Client{constructor(e,t,r,i,s,n){let o=e&&"object"==typeof e?e:{email:e,keyFile:t,key:r,keyId:n,scopes:i,subject:s};super(o),this.email=o.email,this.keyFile=o.keyFile,this.key=o.key,this.keyId=o.keyId,this.scopes=o.scopes,this.subject=o.subject,this.additionalClaims=o.additionalClaims,this.credentials={refresh_token:"jwt-placeholder",expiry_date:1}}createScoped(e){let t=new a(this);return t.scopes=e,t}async getRequestMetadataAsync(e){e=this.defaultServicePath?`https://${this.defaultServicePath}/`:e;let t=!this.hasUserScopes()&&e||this.useJWTAccessWithScope&&this.hasAnyScopes()||this.universeDomain!==o.DEFAULT_UNIVERSE;if(this.subject&&this.universeDomain!==o.DEFAULT_UNIVERSE)throw RangeError(`Service Account user is configured for the credential. Domain-wide delegation is not supported in universes other than ${o.DEFAULT_UNIVERSE}`);if(!this.apiKey&&t){if(this.additionalClaims&&this.additionalClaims.target_audience){let{tokens:e}=await this.refreshToken();return{headers:this.addSharedMetadataHeaders({Authorization:`Bearer ${e.id_token}`})}}{let t;this.access||(this.access=new s.JWTAccess(this.email,this.key,this.keyId,this.eagerRefreshThresholdMillis)),this.hasUserScopes()?t=this.scopes:e||(t=this.defaultScopes);let r=this.useJWTAccessWithScope||this.universeDomain!==o.DEFAULT_UNIVERSE,i=await this.access.getRequestHeaders(null!=e?e:void 0,this.additionalClaims,r?t:void 0);return{headers:this.addSharedMetadataHeaders(i)}}}return this.hasAnyScopes()||this.apiKey?super.getRequestMetadataAsync(e):{headers:{}}}async fetchIdToken(e){let t=new i.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:{target_audience:e},transporter:this.transporter});if(await t.getToken({forceRefresh:!0}),!t.idToken)throw Error("Unknown error: Failed to fetch ID token");return t.idToken}hasUserScopes(){return!!this.scopes&&this.scopes.length>0}hasAnyScopes(){return!!this.scopes&&this.scopes.length>0||!!this.defaultScopes&&this.defaultScopes.length>0}authorize(e){if(!e)return this.authorizeAsync();this.authorizeAsync().then(t=>e(null,t),e)}async authorizeAsync(){let e=await this.refreshToken();if(!e)throw Error("No result returned");return this.credentials=e.tokens,this.credentials.refresh_token="jwt-placeholder",this.key=this.gtoken.key,this.email=this.gtoken.iss,e.tokens}async refreshTokenNoCache(e){let t=this.createGToken(),r={access_token:(await t.getToken({forceRefresh:this.isTokenExpiring()})).access_token,token_type:"Bearer",expiry_date:t.expiresAt,id_token:t.idToken};return this.emit("tokens",r),{res:null,tokens:r}}createGToken(){return this.gtoken||(this.gtoken=new i.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:this.additionalClaims,transporter:this.transporter})),this.gtoken}fromJSON(e){if(!e)throw Error("Must pass in a JSON object containing the service account auth settings.");if(!e.client_email)throw Error("The incoming JSON object does not contain a client_email field");if(!e.private_key)throw Error("The incoming JSON object does not contain a private_key field");this.email=e.client_email,this.key=e.private_key,this.keyId=e.private_key_id,this.projectId=e.project_id,this.quotaProjectId=e.quota_project_id,this.universeDomain=e.universe_domain||this.universeDomain}fromStream(e,t){if(!t)return this.fromStreamAsync(e);this.fromStreamAsync(e).then(()=>t(),t)}fromStreamAsync(e){return new Promise((t,r)=>{if(!e)throw Error("Must pass in a stream containing the service account auth settings.");let i="";e.setEncoding("utf8").on("error",r).on("data",e=>i+=e).on("end",()=>{try{let e=JSON.parse(i);this.fromJSON(e),t()}catch(e){r(e)}})})}fromAPIKey(e){if("string"!=typeof e)throw Error("Must provide an API Key string.");this.apiKey=e}async getCredentials(){if(this.key)return{private_key:this.key,client_email:this.email};if(this.keyFile){let e=this.createGToken(),t=await e.getCredentials(this.keyFile);return{private_key:t.privateKey,client_email:t.clientEmail}}throw Error("A key or a keyFile must be provided to getCredentials.")}}t.JWT=a},72159:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoginTicket=void 0;class r{constructor(e,t){this.envelope=e,this.payload=t}getEnvelope(){return this.envelope}getPayload(){return this.payload}getUserId(){let e=this.getPayload();return e&&e.sub?e.sub:null}getAttributes(){return{envelope:this.getEnvelope(),payload:this.getPayload()}}}t.LoginTicket=r},57170:(e,t,r)=>{"use strict";var i,s,n;Object.defineProperty(t,"__esModule",{value:!0}),t.OAuth2Client=t.ClientAuthentication=t.CertificateFormat=t.CodeChallengeMethod=void 0;let o=r(49741),a=r(63477),c=r(12781),l=r(28516),u=r(83365),h=r(85292),d=r(72159);(function(e){e.Plain="plain",e.S256="S256"})(i||(t.CodeChallengeMethod=i={})),function(e){e.PEM="PEM",e.JWK="JWK"}(s||(t.CertificateFormat=s={})),function(e){e.ClientSecretPost="ClientSecretPost",e.ClientSecretBasic="ClientSecretBasic",e.None="None"}(n||(t.ClientAuthentication=n={}));class p extends h.AuthClient{constructor(e,t,r){let i=e&&"object"==typeof e?e:{clientId:e,clientSecret:t,redirectUri:r};super(i),this.certificateCache={},this.certificateExpiry=null,this.certificateCacheFormat=s.PEM,this.refreshTokenPromises=new Map,this._clientId=i.clientId,this._clientSecret=i.clientSecret,this.redirectUri=i.redirectUri,this.endpoints={tokenInfoUrl:"https://oauth2.googleapis.com/tokeninfo",oauth2AuthBaseUrl:"https://accounts.google.com/o/oauth2/v2/auth",oauth2TokenUrl:"https://oauth2.googleapis.com/token",oauth2RevokeUrl:"https://oauth2.googleapis.com/revoke",oauth2FederatedSignonPemCertsUrl:"https://www.googleapis.com/oauth2/v1/certs",oauth2FederatedSignonJwkCertsUrl:"https://www.googleapis.com/oauth2/v3/certs",oauth2IapPublicKeyUrl:"https://www.gstatic.com/iap/verify/public_key",...i.endpoints},this.clientAuthentication=i.clientAuthentication||n.ClientSecretPost,this.issuers=i.issuers||["accounts.google.com","https://accounts.google.com",this.universeDomain]}generateAuthUrl(e={}){if(e.code_challenge_method&&!e.code_challenge)throw Error("If a code_challenge_method is provided, code_challenge must be included.");return e.response_type=e.response_type||"code",e.client_id=e.client_id||this._clientId,e.redirect_uri=e.redirect_uri||this.redirectUri,Array.isArray(e.scope)&&(e.scope=e.scope.join(" ")),this.endpoints.oauth2AuthBaseUrl.toString()+"?"+a.stringify(e)}generateCodeVerifier(){throw Error("generateCodeVerifier is removed, please use generateCodeVerifierAsync instead.")}async generateCodeVerifierAsync(){let e=(0,u.createCrypto)(),t=e.randomBytesBase64(96).replace(/\+/g,"~").replace(/=/g,"_").replace(/\//g,"-"),r=(await e.sha256DigestBase64(t)).split("=")[0].replace(/\+/g,"-").replace(/\//g,"_");return{codeVerifier:t,codeChallenge:r}}getToken(e,t){let r="string"==typeof e?{code:e}:e;if(!t)return this.getTokenAsync(r);this.getTokenAsync(r).then(e=>t(null,e.tokens,e.res),e=>t(e,null,e.response))}async getTokenAsync(e){let t=this.endpoints.oauth2TokenUrl.toString(),r={"Content-Type":"application/x-www-form-urlencoded"},i={client_id:e.client_id||this._clientId,code_verifier:e.codeVerifier,code:e.code,grant_type:"authorization_code",redirect_uri:e.redirect_uri||this.redirectUri};if(this.clientAuthentication===n.ClientSecretBasic){let e=Buffer.from(`${this._clientId}:${this._clientSecret}`);r.Authorization=`Basic ${e.toString("base64")}`}this.clientAuthentication===n.ClientSecretPost&&(i.client_secret=this._clientSecret);let s=await this.transporter.request({...p.RETRY_CONFIG,method:"POST",url:t,data:a.stringify(i),headers:r}),o=s.data;return s.data&&s.data.expires_in&&(o.expiry_date=new Date().getTime()+1e3*s.data.expires_in,delete o.expires_in),this.emit("tokens",o),{tokens:o,res:s}}async refreshToken(e){if(!e)return this.refreshTokenNoCache(e);if(this.refreshTokenPromises.has(e))return this.refreshTokenPromises.get(e);let t=this.refreshTokenNoCache(e).then(t=>(this.refreshTokenPromises.delete(e),t),t=>{throw this.refreshTokenPromises.delete(e),t});return this.refreshTokenPromises.set(e,t),t}async refreshTokenNoCache(e){var t;let r;if(!e)throw Error("No refresh token is set.");let i=this.endpoints.oauth2TokenUrl.toString(),s={refresh_token:e,client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token"};try{r=await this.transporter.request({...p.RETRY_CONFIG,method:"POST",url:i,data:a.stringify(s),headers:{"Content-Type":"application/x-www-form-urlencoded"}})}catch(e){throw e instanceof o.GaxiosError&&"invalid_grant"===e.message&&(null===(t=e.response)||void 0===t?void 0:t.data)&&/ReAuth/i.test(e.response.data.error_description)&&(e.message=JSON.stringify(e.response.data)),e}let n=r.data;return r.data&&r.data.expires_in&&(n.expiry_date=new Date().getTime()+1e3*r.data.expires_in,delete n.expires_in),this.emit("tokens",n),{tokens:n,res:r}}refreshAccessToken(e){if(!e)return this.refreshAccessTokenAsync();this.refreshAccessTokenAsync().then(t=>e(null,t.credentials,t.res),e)}async refreshAccessTokenAsync(){let e=await this.refreshToken(this.credentials.refresh_token),t=e.tokens;return t.refresh_token=this.credentials.refresh_token,this.credentials=t,{credentials:this.credentials,res:e.res}}getAccessToken(e){if(!e)return this.getAccessTokenAsync();this.getAccessTokenAsync().then(t=>e(null,t.token,t.res),e)}async getAccessTokenAsync(){if(!(!this.credentials.access_token||this.isTokenExpiring()))return{token:this.credentials.access_token};{if(!this.credentials.refresh_token){if(this.refreshHandler){let e=await this.processAndValidateRefreshHandler();if(null==e?void 0:e.access_token)return this.setCredentials(e),{token:this.credentials.access_token}}else throw Error("No refresh token or refresh handler callback is set.")}let e=await this.refreshAccessTokenAsync();if(!e.credentials||e.credentials&&!e.credentials.access_token)throw Error("Could not refresh access token.");return{token:e.credentials.access_token,res:e.res}}}async getRequestHeaders(e){return(await this.getRequestMetadataAsync(e)).headers}async getRequestMetadataAsync(e){let t=this.credentials;if(!t.access_token&&!t.refresh_token&&!this.apiKey&&!this.refreshHandler)throw Error("No access, refresh token, API key or refresh handler callback is set.");if(t.access_token&&!this.isTokenExpiring()){t.token_type=t.token_type||"Bearer";let e={Authorization:t.token_type+" "+t.access_token};return{headers:this.addSharedMetadataHeaders(e)}}if(this.refreshHandler){let e=await this.processAndValidateRefreshHandler();if(null==e?void 0:e.access_token){this.setCredentials(e);let t={Authorization:"Bearer "+this.credentials.access_token};return{headers:this.addSharedMetadataHeaders(t)}}}if(this.apiKey)return{headers:{"X-Goog-Api-Key":this.apiKey}};let r=null,i=null;try{i=(r=await this.refreshToken(t.refresh_token)).tokens}catch(e){throw e.response&&(403===e.response.status||404===e.response.status)&&(e.message=`Could not refresh access token: ${e.message}`),e}let s=this.credentials;s.token_type=s.token_type||"Bearer",i.refresh_token=s.refresh_token,this.credentials=i;let n={Authorization:s.token_type+" "+i.access_token};return{headers:this.addSharedMetadataHeaders(n),res:r.res}}static getRevokeTokenUrl(e){return new p().getRevokeTokenURL(e).toString()}getRevokeTokenURL(e){let t=new URL(this.endpoints.oauth2RevokeUrl);return t.searchParams.append("token",e),t}revokeToken(e,t){let r={...p.RETRY_CONFIG,url:this.getRevokeTokenURL(e).toString(),method:"POST"};if(!t)return this.transporter.request(r);this.transporter.request(r).then(e=>t(null,e),t)}revokeCredentials(e){if(!e)return this.revokeCredentialsAsync();this.revokeCredentialsAsync().then(t=>e(null,t),e)}async revokeCredentialsAsync(){let e=this.credentials.access_token;if(this.credentials={},e)return this.revokeToken(e);throw Error("No access token to revoke.")}request(e,t){if(!t)return this.requestAsync(e);this.requestAsync(e).then(e=>t(null,e),e=>t(e,e.response))}async requestAsync(e,t=!1){let r;try{let t=await this.getRequestMetadataAsync(e.url);e.headers=e.headers||{},t.headers&&t.headers["x-goog-user-project"]&&(e.headers["x-goog-user-project"]=t.headers["x-goog-user-project"]),t.headers&&t.headers.Authorization&&(e.headers.Authorization=t.headers.Authorization),this.apiKey&&(e.headers["X-Goog-Api-Key"]=this.apiKey),r=await this.transporter.request(e)}catch(i){let r=i.response;if(r){let i=r.status,s=this.credentials&&this.credentials.access_token&&this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure),n=this.credentials&&this.credentials.access_token&&!this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure)&&this.refreshHandler,o=r.config.data instanceof c.Readable,a=401===i||403===i;if(!t&&a&&!o&&s)return await this.refreshAccessTokenAsync(),this.requestAsync(e,!0);if(!t&&a&&!o&&n){let t=await this.processAndValidateRefreshHandler();return(null==t?void 0:t.access_token)&&this.setCredentials(t),this.requestAsync(e,!0)}}throw i}return r}verifyIdToken(e,t){if(t&&"function"!=typeof t)throw Error("This method accepts an options object as the first parameter, which includes the idToken, audience, and maxExpiry.");if(!t)return this.verifyIdTokenAsync(e);this.verifyIdTokenAsync(e).then(e=>t(null,e),t)}async verifyIdTokenAsync(e){if(!e.idToken)throw Error("The verifyIdToken method requires an ID Token");let t=await this.getFederatedSignonCertsAsync();return await this.verifySignedJwtWithCertsAsync(e.idToken,t.certs,e.audience,this.issuers,e.maxExpiry)}async getTokenInfo(e){let{data:t}=await this.transporter.request({...p.RETRY_CONFIG,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Bearer ${e}`},url:this.endpoints.tokenInfoUrl.toString()}),r=Object.assign({expiry_date:new Date().getTime()+1e3*t.expires_in,scopes:t.scope.split(" ")},t);return delete r.expires_in,delete r.scope,r}getFederatedSignonCerts(e){if(!e)return this.getFederatedSignonCertsAsync();this.getFederatedSignonCertsAsync().then(t=>e(null,t.certs,t.res),e)}async getFederatedSignonCertsAsync(){let e,t;let r=new Date().getTime(),i=(0,u.hasBrowserCrypto)()?s.JWK:s.PEM;if(this.certificateExpiry&&r<this.certificateExpiry.getTime()&&this.certificateCacheFormat===i)return{certs:this.certificateCache,format:i};switch(i){case s.PEM:t=this.endpoints.oauth2FederatedSignonPemCertsUrl.toString();break;case s.JWK:t=this.endpoints.oauth2FederatedSignonJwkCertsUrl.toString();break;default:throw Error(`Unsupported certificate format ${i}`)}try{e=await this.transporter.request({...p.RETRY_CONFIG,url:t})}catch(e){throw e instanceof Error&&(e.message=`Failed to retrieve verification certificates: ${e.message}`),e}let n=e?e.headers["cache-control"]:void 0,o=-1;if(n){let e=RegExp("max-age=([0-9]*)").exec(n);e&&2===e.length&&(o=1e3*Number(e[1]))}let a={};switch(i){case s.PEM:a=e.data;break;case s.JWK:for(let t of e.data.keys)a[t.kid]=t;break;default:throw Error(`Unsupported certificate format ${i}`)}let c=new Date;return this.certificateExpiry=-1===o?null:new Date(c.getTime()+o),this.certificateCache=a,this.certificateCacheFormat=i,{certs:a,format:i,res:e}}getIapPublicKeys(e){if(!e)return this.getIapPublicKeysAsync();this.getIapPublicKeysAsync().then(t=>e(null,t.pubkeys,t.res),e)}async getIapPublicKeysAsync(){let e;let t=this.endpoints.oauth2IapPublicKeyUrl.toString();try{e=await this.transporter.request({...p.RETRY_CONFIG,url:t})}catch(e){throw e instanceof Error&&(e.message=`Failed to retrieve verification certificates: ${e.message}`),e}return{pubkeys:e.data,res:e}}verifySignedJwtWithCerts(){throw Error("verifySignedJwtWithCerts is removed, please use verifySignedJwtWithCertsAsync instead.")}async verifySignedJwtWithCertsAsync(e,t,r,i,s){let n,o;let a=(0,u.createCrypto)();s||(s=p.DEFAULT_MAX_TOKEN_LIFETIME_SECS_);let c=e.split(".");if(3!==c.length)throw Error("Wrong number of segments in token: "+e);let h=c[0]+"."+c[1],f=c[2];try{n=JSON.parse(a.decodeBase64StringUtf8(c[0]))}catch(e){throw e instanceof Error&&(e.message=`Can't parse token envelope: ${c[0]}': ${e.message}`),e}if(!n)throw Error("Can't parse token envelope: "+c[0]);try{o=JSON.parse(a.decodeBase64StringUtf8(c[1]))}catch(e){throw e instanceof Error&&(e.message=`Can't parse token payload '${c[0]}`),e}if(!o)throw Error("Can't parse token payload: "+c[1]);if(!Object.prototype.hasOwnProperty.call(t,n.kid))throw Error("No pem found for envelope: "+JSON.stringify(n));let g=t[n.kid];if("ES256"===n.alg&&(f=l.joseToDer(f,"ES256").toString("base64")),!await a.verify(g,h,f))throw Error("Invalid token signature: "+e);if(!o.iat)throw Error("No issue time in token: "+JSON.stringify(o));if(!o.exp)throw Error("No expiration time in token: "+JSON.stringify(o));let y=Number(o.iat);if(isNaN(y))throw Error("iat field using invalid format");let m=Number(o.exp);if(isNaN(m))throw Error("exp field using invalid format");let v=new Date().getTime()/1e3;if(m>=v+s)throw Error("Expiration time too far in future: "+JSON.stringify(o));let _=y-p.CLOCK_SKEW_SECS_,E=m+p.CLOCK_SKEW_SECS_;if(v<_)throw Error("Token used too early, "+v+" < "+_+": "+JSON.stringify(o));if(v>E)throw Error("Token used too late, "+v+" > "+E+": "+JSON.stringify(o));if(i&&0>i.indexOf(o.iss))throw Error("Invalid issuer, expected one of ["+i+"], but got "+o.iss);if(null!=r){let e=o.aud;if(!(r.constructor===Array?r.indexOf(e)>-1:e===r))throw Error("Wrong recipient, payload audience != requiredAudience")}return new d.LoginTicket(n,o)}async processAndValidateRefreshHandler(){if(this.refreshHandler){let e=await this.refreshHandler();if(!e.access_token)throw Error("No access token is returned by the refreshHandler callback.");return e}}isTokenExpiring(){let e=this.credentials.expiry_date;return!!e&&e<=new Date().getTime()+this.eagerRefreshThresholdMillis}}t.OAuth2Client=p,p.GOOGLE_TOKEN_INFO_URL="https://oauth2.googleapis.com/tokeninfo",p.CLOCK_SKEW_SECS_=300,p.DEFAULT_MAX_TOKEN_LIFETIME_SECS_=86400},42937:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OAuthClientAuthHandler=void 0,t.getErrorFromOAuthErrorResponse=function(e,t){let r=e.error,i=e.error_description,s=e.error_uri,n=`Error code ${r}`;void 0!==i&&(n+=`: ${i}`),void 0!==s&&(n+=` - ${s}`);let o=Error(n);if(t){let e=Object.keys(t);t.stack&&e.push("stack"),e.forEach(e=>{"message"!==e&&Object.defineProperty(o,e,{value:t[e],writable:!1,enumerable:!0})})}return o};let i=r(63477),s=r(83365),n=["PUT","POST","PATCH"];class o{constructor(e){this.clientAuthentication=e,this.crypto=(0,s.createCrypto)()}applyClientAuthenticationOptions(e,t){this.injectAuthenticatedHeaders(e,t),t||this.injectAuthenticatedRequestBody(e)}injectAuthenticatedHeaders(e,t){var r;if(t)e.headers=e.headers||{},Object.assign(e.headers,{Authorization:`Bearer ${t}}`});else if((null===(r=this.clientAuthentication)||void 0===r?void 0:r.confidentialClientType)==="basic"){e.headers=e.headers||{};let t=this.clientAuthentication.clientId,r=this.clientAuthentication.clientSecret||"",i=this.crypto.encodeBase64StringUtf8(`${t}:${r}`);Object.assign(e.headers,{Authorization:`Basic ${i}`})}}injectAuthenticatedRequestBody(e){var t;if((null===(t=this.clientAuthentication)||void 0===t?void 0:t.confidentialClientType)==="request-body"){let t=(e.method||"GET").toUpperCase();if(-1!==n.indexOf(t)){let t;let r=e.headers||{};for(let e in r)if("content-type"===e.toLowerCase()&&r[e]){t=r[e].toLowerCase();break}if("application/x-www-form-urlencoded"===t){e.data=e.data||"";let t=i.parse(e.data);Object.assign(t,{client_id:this.clientAuthentication.clientId,client_secret:this.clientAuthentication.clientSecret||""}),e.data=i.stringify(t)}else if("application/json"===t)e.data=e.data||{},Object.assign(e.data,{client_id:this.clientAuthentication.clientId,client_secret:this.clientAuthentication.clientSecret||""});else throw Error(`${t} content-types are not supported with ${this.clientAuthentication.confidentialClientType} client authentication`)}else throw Error(`${t} HTTP method does not support ${this.clientAuthentication.confidentialClientType} client authentication`)}}static get RETRY_CONFIG(){return{retry:!0,retryConfig:{httpMethodsToRetry:["GET","PUT","POST","HEAD","OPTIONS","DELETE"]}}}}t.OAuthClientAuthHandler=o},37722:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PassThroughClient=void 0;let i=r(85292);class s extends i.AuthClient{async request(e){return this.transporter.request(e)}async getAccessToken(){return{}}async getRequestHeaders(){return{}}}t.PassThroughClient=s,new s().getAccessToken()},17612:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PluggableAuthClient=t.ExecutableError=void 0;let i=r(45966),s=r(96882),n=r(65678);class o extends Error{constructor(e,t){super(`The executable failed with exit code: ${t} and error message: ${e}.`),this.code=t,Object.setPrototypeOf(this,new.target.prototype)}}t.ExecutableError=o;class a extends i.BaseExternalAccountClient{constructor(e,t){if(super(e,t),!e.credential_source.executable||(this.command=e.credential_source.executable.command,!this.command))throw Error('No valid Pluggable Auth "credential_source" provided.');if(void 0===e.credential_source.executable.timeout_millis)this.timeoutMillis=3e4;else if(this.timeoutMillis=e.credential_source.executable.timeout_millis,this.timeoutMillis<5e3||this.timeoutMillis>12e4)throw Error("Timeout must be between 5000120000 milliseconds.");this.outputFile=e.credential_source.executable.output_file,this.handler=new n.PluggableAuthHandler({command:this.command,timeoutMillis:this.timeoutMillis,outputFile:this.outputFile}),this.credentialSourceType="executable"}async retrieveSubjectToken(){let e;if("1"!==process.env.GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES)throw Error("Pluggable Auth executables need to be explicitly allowed to run by setting the GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES environment Variable to 1.");if(this.outputFile&&(e=await this.handler.retrieveCachedResponse()),!e){let t=new Map;t.set("GOOGLE_EXTERNAL_ACCOUNT_AUDIENCE",this.audience),t.set("GOOGLE_EXTERNAL_ACCOUNT_TOKEN_TYPE",this.subjectTokenType),t.set("GOOGLE_EXTERNAL_ACCOUNT_INTERACTIVE","0"),this.outputFile&&t.set("GOOGLE_EXTERNAL_ACCOUNT_OUTPUT_FILE",this.outputFile);let r=this.getServiceAccountEmail();r&&t.set("GOOGLE_EXTERNAL_ACCOUNT_IMPERSONATED_EMAIL",r),e=await this.handler.retrieveResponseFromExecutable(t)}if(e.version>1)throw Error("Version of executable is not currently supported, maximum supported version is 1.");if(!e.success)throw new o(e.errorMessage,e.errorCode);if(this.outputFile&&!e.expirationTime)throw new s.InvalidExpirationTimeFieldError("The executable response must contain the `expiration_time` field for successful responses when an output_file has been specified in the configuration.");if(e.isExpired())throw Error("Executable response is expired.");return e.subjectToken}}t.PluggableAuthClient=a},65678:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PluggableAuthHandler=void 0;let i=r(17612),s=r(96882),n=r(32081),o=r(57147);class a{constructor(e){if(!e.command)throw Error("No command provided.");if(this.commandComponents=a.parseCommand(e.command),this.timeoutMillis=e.timeoutMillis,!this.timeoutMillis)throw Error("No timeoutMillis provided.");this.outputFile=e.outputFile}retrieveResponseFromExecutable(e){return new Promise((t,r)=>{let o=n.spawn(this.commandComponents[0],this.commandComponents.slice(1),{env:{...process.env,...Object.fromEntries(e)}}),a="";o.stdout.on("data",e=>{a+=e}),o.stderr.on("data",e=>{a+=e});let c=setTimeout(()=>(o.removeAllListeners(),o.kill(),r(Error("The executable failed to finish within the timeout specified."))),this.timeoutMillis);o.on("close",e=>{if(clearTimeout(c),0!==e)return r(new i.ExecutableError(a,e.toString()));try{let e=JSON.parse(a),r=new s.ExecutableResponse(e);return t(r)}catch(e){if(e instanceof s.ExecutableResponseError)return r(e);return r(new s.ExecutableResponseError(`The executable returned an invalid response: ${a}`))}})})}async retrieveCachedResponse(){let e;if(!this.outputFile||0===this.outputFile.length)return;try{e=await o.promises.realpath(this.outputFile)}catch(e){return}if(!(await o.promises.lstat(e)).isFile())return;let t=await o.promises.readFile(e,{encoding:"utf8"});if(""!==t)try{let e=JSON.parse(t);if(new s.ExecutableResponse(e).isValid())return new s.ExecutableResponse(e);return}catch(e){if(e instanceof s.ExecutableResponseError)throw e;throw new s.ExecutableResponseError(`The output file contained an invalid response: ${t}`)}}static parseCommand(e){let t=e.match(/(?:[^\s"]+|"[^"]*")+/g);if(!t)throw Error(`Provided command: "${e}" could not be parsed.`);for(let e=0;e<t.length;e++)'"'===t[e][0]&&'"'===t[e].slice(-1)&&(t[e]=t[e].slice(1,-1));return t}}t.PluggableAuthHandler=a},95314:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserRefreshClient=t.USER_REFRESH_ACCOUNT_TYPE=void 0;let i=r(57170),s=r(63477);t.USER_REFRESH_ACCOUNT_TYPE="authorized_user";class n extends i.OAuth2Client{constructor(e,t,r,i,s){let n=e&&"object"==typeof e?e:{clientId:e,clientSecret:t,refreshToken:r,eagerRefreshThresholdMillis:i,forceRefreshOnFailure:s};super(n),this._refreshToken=n.refreshToken,this.credentials.refresh_token=n.refreshToken}async refreshTokenNoCache(e){return super.refreshTokenNoCache(this._refreshToken)}async fetchIdToken(e){return(await this.transporter.request({...n.RETRY_CONFIG,url:this.endpoints.oauth2TokenUrl,headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",data:(0,s.stringify)({client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token",refresh_token:this._refreshToken,target_audience:e})})).data.id_token}fromJSON(e){if(!e)throw Error("Must pass in a JSON object containing the user refresh token");if("authorized_user"!==e.type)throw Error('The incoming JSON object does not have the "authorized_user" type');if(!e.client_id)throw Error("The incoming JSON object does not contain a client_id field");if(!e.client_secret)throw Error("The incoming JSON object does not contain a client_secret field");if(!e.refresh_token)throw Error("The incoming JSON object does not contain a refresh_token field");this._clientId=e.client_id,this._clientSecret=e.client_secret,this._refreshToken=e.refresh_token,this.credentials.refresh_token=e.refresh_token,this.quotaProjectId=e.quota_project_id,this.universeDomain=e.universe_domain||this.universeDomain}fromStream(e,t){if(!t)return this.fromStreamAsync(e);this.fromStreamAsync(e).then(()=>t(),t)}async fromStreamAsync(e){return new Promise((t,r)=>{if(!e)return r(Error("Must pass in a stream containing the user refresh token."));let i="";e.setEncoding("utf8").on("error",r).on("data",e=>i+=e).on("end",()=>{try{let e=JSON.parse(i);return this.fromJSON(e),t()}catch(e){return r(e)}})})}static fromJSON(e){let t=new n;return t.fromJSON(e),t}}t.UserRefreshClient=n},58440:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StsCredentials=void 0;let i=r(49741),s=r(63477),n=r(43273),o=r(42937);class a extends o.OAuthClientAuthHandler{constructor(e,t){super(t),this.tokenExchangeEndpoint=e,this.transporter=new n.DefaultTransporter}async exchangeToken(e,t,r){var n,c,l;let u={grant_type:e.grantType,resource:e.resource,audience:e.audience,scope:null===(n=e.scope)||void 0===n?void 0:n.join(" "),requested_token_type:e.requestedTokenType,subject_token:e.subjectToken,subject_token_type:e.subjectTokenType,actor_token:null===(c=e.actingParty)||void 0===c?void 0:c.actorToken,actor_token_type:null===(l=e.actingParty)||void 0===l?void 0:l.actorTokenType,options:r&&JSON.stringify(r)};Object.keys(u).forEach(e=>{void 0===u[e]&&delete u[e]});let h={"Content-Type":"application/x-www-form-urlencoded"};Object.assign(h,t||{});let d={...a.RETRY_CONFIG,url:this.tokenExchangeEndpoint.toString(),method:"POST",headers:h,data:s.stringify(u),responseType:"json"};this.applyClientAuthenticationOptions(d);try{let e=await this.transporter.request(d),t=e.data;return t.res=e,t}catch(e){if(e instanceof i.GaxiosError&&e.response)throw(0,o.getErrorFromOAuthErrorResponse)(e.response.data,e);throw e}}}t.StsCredentials=a},48486:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UrlSubjectTokenSupplier=void 0;class r{constructor(e){this.url=e.url,this.formatType=e.formatType,this.subjectTokenFieldName=e.subjectTokenFieldName,this.headers=e.headers,this.additionalGaxiosOptions=e.additionalGaxiosOptions}async getSubjectToken(e){let t;let r={...this.additionalGaxiosOptions,url:this.url,method:"GET",headers:this.headers,responseType:this.formatType};if("text"===this.formatType?t=(await e.transporter.request(r)).data:"json"===this.formatType&&this.subjectTokenFieldName&&(t=(await e.transporter.request(r)).data[this.subjectTokenFieldName]),!t)throw Error("Unable to parse the subject_token from the credential_source URL");return t}}t.UrlSubjectTokenSupplier=r},55517:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserCrypto=void 0;let i=r(73083),s=r(83365);class n{constructor(){throw Error("SubtleCrypto not found. Make sure it's an https:// website.")}async sha256DigestBase64(e){let t=new TextEncoder().encode(e),r=await window.crypto.subtle.digest("SHA-256",t);return i.fromByteArray(new Uint8Array(r))}randomBytesBase64(e){let t=new Uint8Array(e);return window.crypto.getRandomValues(t),i.fromByteArray(t)}static padBase64(e){for(;e.length%4!=0;)e+="=";return e}async verify(e,t,r){let s={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},o=new TextEncoder().encode(t),a=i.toByteArray(n.padBase64(r)),c=await window.crypto.subtle.importKey("jwk",e,s,!0,["verify"]);return await window.crypto.subtle.verify(s,c,a,o)}async sign(e,t){let r={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},s=new TextEncoder().encode(t),n=await window.crypto.subtle.importKey("jwk",e,r,!0,["sign"]),o=await window.crypto.subtle.sign(r,n,s);return i.fromByteArray(new Uint8Array(o))}decodeBase64StringUtf8(e){let t=i.toByteArray(n.padBase64(e));return new TextDecoder().decode(t)}encodeBase64StringUtf8(e){let t=new TextEncoder().encode(e);return i.fromByteArray(t)}async sha256DigestHex(e){let t=new TextEncoder().encode(e),r=await window.crypto.subtle.digest("SHA-256",t);return(0,s.fromArrayBufferToHex)(r)}async signWithHmacSha256(e,t){let r="string"==typeof e?e:String.fromCharCode(...new Uint16Array(e)),i=new TextEncoder,s=await window.crypto.subtle.importKey("raw",i.encode(r),{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);return window.crypto.subtle.sign("HMAC",s,i.encode(t))}}t.BrowserCrypto=n},83365:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCrypto=function(){return new s.NodeCrypto},t.hasBrowserCrypto=function(){return!1},t.fromArrayBufferToHex=function(e){return Array.from(new Uint8Array(e)).map(e=>e.toString(16).padStart(2,"0")).join("")};let i=r(55517),s=r(77e3)},77e3:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeCrypto=void 0;let i=r(6113);class s{async sha256DigestBase64(e){return i.createHash("sha256").update(e).digest("base64")}randomBytesBase64(e){return i.randomBytes(e).toString("base64")}async verify(e,t,r){let s=i.createVerify("RSA-SHA256");return s.update(t),s.end(),s.verify(e,r,"base64")}async sign(e,t){let r=i.createSign("RSA-SHA256");return r.update(t),r.end(),r.sign(e,"base64")}decodeBase64StringUtf8(e){return Buffer.from(e,"base64").toString("utf-8")}encodeBase64StringUtf8(e){return Buffer.from(e,"utf-8").toString("base64")}async sha256DigestHex(e){return i.createHash("sha256").update(e).digest("hex")}async signWithHmacSha256(e,t){var r;let s="string"==typeof e?e:Buffer.from(e);return(r=i.createHmac("sha256",s).update(t).digest()).buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}}t.NodeCrypto=s},84554:(e,t,r)=>{"use strict";t.lv=void 0;let i=r(27090);r(21394),r(49741),r(85292),r(42977),r(75698),r(29309),r(79376),r(68946),r(97536),r(14625);var s=r(57170);Object.defineProperty(t,"lv",{enumerable:!0,get:function(){return s.OAuth2Client}}),r(72159),r(95314),r(99130),r(54409),r(36157),r(45643),r(45966),r(39200),r(17612),r(37722),r(43273),new i.GoogleAuth},79019:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validate=function(e){for(let t of[{invalid:"uri",expected:"url"},{invalid:"json",expected:"data"},{invalid:"qs",expected:"params"}])if(e[t.invalid])throw Error(`'${t.invalid}' is not a valid configuration option. Please use '${t.expected}' instead. This library is using Axios for requests. Please see https://github.com/axios/axios to learn more about the valid request options.`)}},43273:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultTransporter=void 0;let i=r(49741),s=r(79019),n=r(78688),o="google-api-nodejs-client";class a{constructor(){this.instance=new i.Gaxios}configure(e={}){e.headers=e.headers||{};{let t=e.headers["User-Agent"];if(t?t.includes(`${o}/`)||(e.headers["User-Agent"]=`${t} ${a.USER_AGENT}`):e.headers["User-Agent"]=a.USER_AGENT,!e.headers["x-goog-api-client"]){let t=process.version.replace(/^v/,"");e.headers["x-goog-api-client"]=`gl-node/${t}`}}return e}request(e){return e=this.configure(e),(0,s.validate)(e),this.instance.request(e).catch(e=>{throw this.processError(e)})}get defaults(){return this.instance.defaults}set defaults(e){this.instance.defaults=e}processError(e){let t=e.response,r=t?t.data:null;return t&&r&&r.error&&200!==t.status?"string"==typeof r.error?(e.message=r.error,e.status=t.status):Array.isArray(r.error.errors)?(e.message=r.error.errors.map(e=>e.message).join("\n"),e.code=r.error.code,e.errors=r.error.errors):(e.message=r.error.message,e.code=r.error.code):t&&t.status>=400&&(e.message=r,e.status=t.status),e}}t.DefaultTransporter=a,a.USER_AGENT=`${o}/${n.version}`},44598:(e,t)=>{"use strict";var r,i,s,n,o=function(e,t,r,i){if("a"===r&&!i)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};function a(e){return e.replace(/([_][^_])/g,e=>e.slice(1).toUpperCase())}Object.defineProperty(t,"__esModule",{value:!0}),t.LRUCache=void 0,t.snakeToCamel=a,t.originalOrCamelOptions=function(e){return{get:function(t){var r;let i=e||{};return null!==(r=i[t])&&void 0!==r?r:i[a(t)]}}};class c{constructor(e){r.add(this),i.set(this,new Map),this.capacity=e.capacity,this.maxAge=e.maxAge}set(e,t){o(this,r,"m",s).call(this,e,t),o(this,r,"m",n).call(this)}get(e){let t=o(this,i,"f").get(e);if(t)return o(this,r,"m",s).call(this,e,t.value),o(this,r,"m",n).call(this),t.value}}t.LRUCache=c,i=new WeakMap,r=new WeakSet,s=function(e,t){o(this,i,"f").delete(e),o(this,i,"f").set(e,{value:t,lastAccessed:Date.now()})},n=function(){let e=this.maxAge?Date.now()-this.maxAge:0,t=o(this,i,"f").entries().next();for(;!t.done&&(o(this,i,"f").size>this.capacity||t.value[1].lastAccessed<e);)o(this,i,"f").delete(t.value[0]),t=o(this,i,"f").entries().next()}},95497:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GCE_LINUX_BIOS_PATHS=void 0,t.isGoogleCloudServerless=o,t.isGoogleComputeEngineLinux=a,t.isGoogleComputeEngineMACAddress=c,t.isGoogleComputeEngine=l,t.detectGCPResidency=function(){return o()||l()};let i=r(57147),s=r(22037);t.GCE_LINUX_BIOS_PATHS={BIOS_DATE:"/sys/class/dmi/id/bios_date",BIOS_VENDOR:"/sys/class/dmi/id/bios_vendor"};let n=/^42:01/;function o(){return!!(process.env.CLOUD_RUN_JOB||process.env.FUNCTION_NAME||process.env.K_SERVICE)}function a(){if("linux"!==(0,s.platform)())return!1;try{(0,i.statSync)(t.GCE_LINUX_BIOS_PATHS.BIOS_DATE);let e=(0,i.readFileSync)(t.GCE_LINUX_BIOS_PATHS.BIOS_VENDOR,"utf8");return/Google/.test(e)}catch(e){return!1}}function c(){for(let e of Object.values((0,s.networkInterfaces)()))if(e){for(let{mac:t}of e)if(n.test(t))return!0}return!1}function l(){return a()||c()}},21394:(e,t,r)=>{"use strict";let i;var s=Object.create?function(e,t,r,i){void 0===i&&(i=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,s)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]};Object.defineProperty(t,"__esModule",{value:!0}),t.gcpResidencyCache=t.METADATA_SERVER_DETECTION=t.HEADERS=t.HEADER_VALUE=t.HEADER_NAME=t.SECONDARY_HOST_ADDRESS=t.HOST_ADDRESS=t.BASE_PATH=void 0,t.instance=function(e){return h("instance",e)},t.project=function(e){return h("project",e)},t.universe=function(e){return h("universe",e)},t.bulk=p,t.isAvailable=f,t.resetIsAvailableCache=function(){i=void 0},t.getGCPResidency=g,t.setGCPResidency=y,t.requestTimeout=m;let n=r(49741),o=r(29532),a=r(95497),c=r(52501);t.BASE_PATH="/computeMetadata/v1",t.HOST_ADDRESS="http://169.254.169.254",t.SECONDARY_HOST_ADDRESS="http://metadata.google.internal.",t.HEADER_NAME="Metadata-Flavor",t.HEADER_VALUE="Google",t.HEADERS=Object.freeze({[t.HEADER_NAME]:t.HEADER_VALUE});let l=c.log("gcp metadata");function u(e){return e||(e=process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST||t.HOST_ADDRESS),/^https?:\/\//.test(e)||(e=`http://${e}`),new URL(t.BASE_PATH,e).href}async function h(e,r={},i=3,s=!1){let a="",c={},h={};"object"==typeof e?(a=e.metadataKey,c=e.params||c,h=e.headers||h,i=e.noResponseRetries||i,s=e.fastFail||s):a=e,"string"==typeof r?a+=`/${r}`:(function(e){Object.keys(e).forEach(e=>{switch(e){case"params":case"property":case"headers":break;case"qs":throw Error("'qs' is not a valid configuration option. Please use 'params' instead.");default:throw Error(`'${e}' is not a valid configuration option.`)}})}(r),r.property&&(a+=`/${r.property}`),h=r.headers||h,c=r.params||c);let p=s?d:n.request,f={url:`${u()}/${a}`,headers:{...t.HEADERS,...h},retryConfig:{noResponseRetries:i},params:c,responseType:"text",timeout:m()};l.info("instance request %j",f);let g=await p(f);if(l.info("instance metadata is %s",g.data),g.headers[t.HEADER_NAME.toLowerCase()]!==t.HEADER_VALUE)throw Error(`Invalid response from metadata service: incorrect ${t.HEADER_NAME} header. Expected '${t.HEADER_VALUE}', got ${g.headers[t.HEADER_NAME.toLowerCase()]?`'${g.headers[t.HEADER_NAME.toLowerCase()]}'`:"no header"}`);if("string"==typeof g.data)try{return o.parse(g.data)}catch(e){}return g.data}async function d(e){var r;let i={...e,url:null===(r=e.url)||void 0===r?void 0:r.toString().replace(u(),u(t.SECONDARY_HOST_ADDRESS))},s=!1,o=(0,n.request)(e).then(e=>(s=!0,e)).catch(e=>{if(s)return a;throw s=!0,e}),a=(0,n.request)(i).then(e=>(s=!0,e)).catch(e=>{if(s)return o;throw s=!0,e});return Promise.race([o,a])}async function p(e){let t={};return await Promise.all(e.map(e=>(async()=>{let r=await h(e);t[e.metadataKey]=r})())),t}async function f(){if(process.env.METADATA_SERVER_DETECTION){let e=process.env.METADATA_SERVER_DETECTION.trim().toLocaleLowerCase();if(!(e in t.METADATA_SERVER_DETECTION))throw RangeError(`Unknown \`METADATA_SERVER_DETECTION\` env variable. Got \`${e}\`, but it should be \`${Object.keys(t.METADATA_SERVER_DETECTION).join("`, `")}\`, or unset`);switch(e){case"assume-present":return!0;case"none":return!1;case"bios-only":return g()}}try{return void 0===i&&(i=h("instance",void 0,process.env.DETECT_GCP_RETRIES?Number(process.env.DETECT_GCP_RETRIES):0,!(process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST))),await i,!0}catch(e){if(process.env.DEBUG_AUTH&&console.info(e),"request-timeout"===e.type||e.response&&404===e.response.status)return!1;if(!(e.response&&404===e.response.status)&&(!e.code||!["EHOSTDOWN","EHOSTUNREACH","ENETUNREACH","ENOENT","ENOTFOUND","ECONNREFUSED"].includes(e.code))){let t="UNKNOWN";e.code&&(t=e.code),process.emitWarning(`received unexpected error = ${e.message} code = ${t}`,"MetadataLookupWarning")}return!1}}function g(){return null===t.gcpResidencyCache&&y(),t.gcpResidencyCache}function y(e=null){t.gcpResidencyCache=null!==e?e:(0,a.detectGCPResidency)()}function m(){return g()?0:3e3}t.METADATA_SERVER_DETECTION=Object.freeze({"assume-present":"don't try to ping the metadata server, but assume it's present",none:"don't try to ping the metadata server, but don't try to use it either","bios-only":"treat the result of a BIOS probe as canonical (don't fall back to pinging)","ping-only":"skip the BIOS probe, and go straight to pinging"}),t.gcpResidencyCache=null,function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||s(t,e,r)}(r(95497),t)},67199:(e,t,r)=>{"use strict";var i,s=r(59026).Buffer,n=r(6113),o=r(28516),a=r(73837),c="secret must be a string or buffer",l="key must be a string or a buffer",u="function"==typeof n.createPublicKey;function h(e){if(!s.isBuffer(e)&&"string"!=typeof e&&(!u||"object"!=typeof e||"string"!=typeof e.type||"string"!=typeof e.asymmetricKeyType||"function"!=typeof e.export))throw g(l)}function d(e){if(!s.isBuffer(e)&&"string"!=typeof e&&"object"!=typeof e)throw g("key must be a string, a buffer or an object")}function p(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function f(e){var t=4-(e=e.toString()).length%4;if(4!==t)for(var r=0;r<t;++r)e+="=";return e.replace(/\-/g,"+").replace(/_/g,"/")}function g(e){var t=[].slice.call(arguments,1);return TypeError(a.format.bind(a,e).apply(null,t))}function y(e){var t;return t=e,s.isBuffer(t)||"string"==typeof t||(e=JSON.stringify(e)),e}function m(e){return function(t,r){(function(e){if(!s.isBuffer(e)&&"string"!=typeof e&&(!u||"object"!=typeof e||"secret"!==e.type||"function"!=typeof e.export))throw g(c)})(r),t=y(t);var i=n.createHmac("sha"+e,r);return p((i.update(t),i.digest("base64")))}}u&&(l+=" or a KeyObject",c+="or a KeyObject");var v="timingSafeEqual"in n?function(e,t){return e.byteLength===t.byteLength&&n.timingSafeEqual(e,t)}:function(e,t){return i||(i=r(69756)),i(e,t)};function _(e){return function(t,r,i){var n=m(e)(t,i);return v(s.from(r),s.from(n))}}function E(e){return function(t,r){d(r),t=y(t);var i=n.createSign("RSA-SHA"+e);return p((i.update(t),i.sign(r,"base64")))}}function w(e){return function(t,r,i){h(i),t=y(t),r=f(r);var s=n.createVerify("RSA-SHA"+e);return s.update(t),s.verify(i,r,"base64")}}function A(e){return function(t,r){d(r),t=y(t);var i=n.createSign("RSA-SHA"+e);return p((i.update(t),i.sign({key:r,padding:n.constants.RSA_PKCS1_PSS_PADDING,saltLength:n.constants.RSA_PSS_SALTLEN_DIGEST},"base64")))}}function T(e){return function(t,r,i){h(i),t=y(t),r=f(r);var s=n.createVerify("RSA-SHA"+e);return s.update(t),s.verify({key:i,padding:n.constants.RSA_PKCS1_PSS_PADDING,saltLength:n.constants.RSA_PSS_SALTLEN_DIGEST},r,"base64")}}function b(e){var t=E(e);return function(){var r=t.apply(null,arguments);return o.derToJose(r,"ES"+e)}}function S(e){var t=w(e);return function(r,i,s){return t(r,i=o.joseToDer(i,"ES"+e).toString("base64"),s)}}function k(){return function(){return""}}function O(){return function(e,t){return""===t}}e.exports=function(e){var t=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/);if(!t)throw g('"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',e);var r=(t[1]||t[3]).toLowerCase(),i=t[2];return{sign:({hs:m,rs:E,ps:A,es:b,none:k})[r](i),verify:({hs:_,rs:w,ps:T,es:S,none:O})[r](i)}}},30826:(e,t,r)=>{var i=r(7175),s=r(61335);t.ALGORITHMS=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"],t.sign=i.sign,t.verify=s.verify,t.decode=s.decode,t.isValid=s.isValid,t.createSign=function(e){return new i(e)},t.createVerify=function(e){return new s(e)}},94399:(e,t,r)=>{"use strict";var i=r(59026).Buffer,s=r(12781);function n(e){if(this.buffer=null,this.writable=!0,this.readable=!0,!e)return this.buffer=i.alloc(0),this;if("function"==typeof e.pipe)return this.buffer=i.alloc(0),e.pipe(this),this;if(e.length||"object"==typeof e)return this.buffer=e,this.writable=!1,process.nextTick((function(){this.emit("end",e),this.readable=!1,this.emit("close")}).bind(this)),this;throw TypeError("Unexpected data type ("+typeof e+")")}r(73837).inherits(n,s),n.prototype.write=function(e){this.buffer=i.concat([this.buffer,i.from(e)]),this.emit("data",e)},n.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1},e.exports=n},7175:(e,t,r)=>{"use strict";var i=r(59026).Buffer,s=r(94399),n=r(67199),o=r(12781),a=r(23717),c=r(73837);function l(e,t){return i.from(e,t).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function u(e){var t,r,i,s=e.header,o=e.payload,u=e.secret||e.privateKey,h=e.encoding,d=n(s.alg),p=(t=(t=h)||"utf8",r=l(a(s),"binary"),i=l(a(o),t),c.format("%s.%s",r,i)),f=d.sign(p,u);return c.format("%s.%s",p,f)}function h(e){var t=new s(e.secret||e.privateKey||e.key);this.readable=!0,this.header=e.header,this.encoding=e.encoding,this.secret=this.privateKey=this.key=t,this.payload=new s(e.payload),this.secret.once("close",(function(){!this.payload.writable&&this.readable&&this.sign()}).bind(this)),this.payload.once("close",(function(){!this.secret.writable&&this.readable&&this.sign()}).bind(this))}c.inherits(h,o),h.prototype.sign=function(){try{var e=u({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},h.sign=u,e.exports=h},23717:(e,t,r)=>{"use strict";var i=r(14300).Buffer;e.exports=function(e){return"string"==typeof e?e:"number"==typeof e||i.isBuffer(e)?e.toString():JSON.stringify(e)}},61335:(e,t,r)=>{"use strict";var i=r(59026).Buffer,s=r(94399),n=r(67199),o=r(12781),a=r(23717),c=r(73837),l=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function u(e){var t=e.split(".",1)[0];return function(e){if("[object Object]"===Object.prototype.toString.call(e))return e;try{return JSON.parse(e)}catch(e){return}}(i.from(t,"base64").toString("binary"))}function h(e){return e.split(".")[2]}function d(e){return l.test(e)&&!!u(e)}function p(e,t,r){if(!t){var i=Error("Missing algorithm parameter for jws.verify");throw i.code="MISSING_ALGORITHM",i}var s=h(e=a(e)),o=e.split(".",2).join(".");return n(t).verify(o,s,r)}function f(e,t){if(t=t||{},!d(e=a(e)))return null;var r,s,n=u(e);if(!n)return null;var o=(r=r||"utf8",s=e.split(".")[1],i.from(s,"base64").toString(r));return("JWT"===n.typ||t.json)&&(o=JSON.parse(o,t.encoding)),{header:n,payload:o,signature:h(e)}}function g(e){var t=new s((e=e||{}).secret||e.publicKey||e.key);this.readable=!0,this.algorithm=e.algorithm,this.encoding=e.encoding,this.secret=this.publicKey=this.key=t,this.signature=new s(e.signature),this.secret.once("close",(function(){!this.signature.writable&&this.readable&&this.verify()}).bind(this)),this.signature.once("close",(function(){!this.secret.writable&&this.readable&&this.verify()}).bind(this))}c.inherits(g,o),g.prototype.verify=function(){try{var e=p(this.signature.buffer,this.algorithm,this.key.buffer),t=f(this.signature.buffer,this.encoding);return this.emit("done",e,t),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},g.decode=f,g.isValid=d,g.verify=p,e.exports=g},67258:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Colours=void 0;class r{static isEnabled(e){return e.isTTY&&("function"!=typeof e.getColorDepth||e.getColorDepth()>2)}static refresh(){r.enabled=r.isEnabled(process.stderr),this.enabled?(r.reset="\x1b[0m",r.bright="\x1b[1m",r.dim="\x1b[2m",r.red="\x1b[31m",r.green="\x1b[32m",r.yellow="\x1b[33m",r.blue="\x1b[34m",r.magenta="\x1b[35m",r.cyan="\x1b[36m",r.white="\x1b[37m",r.grey="\x1b[90m"):(r.reset="",r.bright="",r.dim="",r.red="",r.green="",r.yellow="",r.blue="",r.magenta="",r.cyan="",r.white="",r.grey="")}}t.Colours=r,r.enabled=!1,r.reset="",r.bright="",r.dim="",r.red="",r.green="",r.yellow="",r.blue="",r.magenta="",r.cyan="",r.white="",r.grey="",r.refresh()},52501:(e,t,r)=>{"use strict";var i=Object.create?function(e,t,r,i){void 0===i&&(i=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,s)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]};Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)}(r(42269),t)},42269:(e,t,r)=>{"use strict";let i;var s,n=Object.create?function(e,t,r,i){void 0===i&&(i=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,s)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]},o=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.env=t.DebugLogBackendBase=t.placeholder=t.AdhocDebugLogger=t.LogSeverity=void 0,t.getNodeBackend=g,t.getDebugBackend=function(e){return new y(e)},t.getStructuredBackend=function(e){return new m(e)},t.setBackend=function(e){i=e,v.clear()},t.log=_;let c=r(15673),l=a(r(97742)),u=a(r(47261)),h=r(67258);!function(e){e.DEFAULT="DEFAULT",e.DEBUG="DEBUG",e.INFO="INFO",e.WARNING="WARNING",e.ERROR="ERROR"}(s||(t.LogSeverity=s={}));class d extends c.EventEmitter{constructor(e,t){super(),this.namespace=e,this.upstream=t,this.func=Object.assign(this.invoke.bind(this),{instance:this,on:(e,t)=>this.on(e,t)}),this.func.debug=(...e)=>this.invokeSeverity(s.DEBUG,...e),this.func.info=(...e)=>this.invokeSeverity(s.INFO,...e),this.func.warn=(...e)=>this.invokeSeverity(s.WARNING,...e),this.func.error=(...e)=>this.invokeSeverity(s.ERROR,...e),this.func.sublog=e=>_(e,this.func)}invoke(e,...t){this.upstream&&this.upstream(e,...t),this.emit("log",e,t)}invokeSeverity(e,...t){this.invoke({severity:e},...t)}}t.AdhocDebugLogger=d,t.placeholder=new d("",()=>{}).func;class p{constructor(){var e;this.cached=new Map,this.filters=[],this.filtersSet=!1;let r=null!==(e=l.env[t.env.nodeEnables])&&void 0!==e?e:"*";"all"===r&&(r="*"),this.filters=r.split(",")}log(e,t,...r){try{this.filtersSet||(this.setFilters(),this.filtersSet=!0);let i=this.cached.get(e);i||(i=this.makeLogger(e),this.cached.set(e,i)),i(t,...r)}catch(e){console.error(e)}}}t.DebugLogBackendBase=p;class f extends p{constructor(){super(...arguments),this.enabledRegexp=/.*/g}isEnabled(e){return this.enabledRegexp.test(e)}makeLogger(e){return this.enabledRegexp.test(e)?(t,...r)=>{var i;let n;let o=`${h.Colours.green}${e}${h.Colours.reset}`,a=`${h.Colours.yellow}${l.pid}${h.Colours.reset}`;switch(t.severity){case s.ERROR:n=`${h.Colours.red}${t.severity}${h.Colours.reset}`;break;case s.INFO:n=`${h.Colours.magenta}${t.severity}${h.Colours.reset}`;break;case s.WARNING:n=`${h.Colours.yellow}${t.severity}${h.Colours.reset}`;break;default:n=null!==(i=t.severity)&&void 0!==i?i:s.DEFAULT}let c=u.formatWithOptions({colors:h.Colours.enabled},...r),d=Object.assign({},t);delete d.severity;let p=Object.getOwnPropertyNames(d).length?JSON.stringify(d):"",f=p?`${h.Colours.grey}${p}${h.Colours.reset}`:"";console.error("%s [%s|%s] %s%s",a,o,n,c,p?` ${f}`:"")}:()=>{}}setFilters(){let e=this.filters.join(",").replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^");this.enabledRegexp=RegExp(`^${e}$`,"i")}}function g(){return new f}class y extends p{constructor(e){super(),this.debugPkg=e}makeLogger(e){let t=this.debugPkg(e);return(e,...r)=>{t(r[0],...r.slice(1))}}setFilters(){var e;let t=null!==(e=l.env.NODE_DEBUG)&&void 0!==e?e:"";l.env.NODE_DEBUG=`${t}${t?",":""}${this.filters.join(",")}`}}class m extends p{constructor(e){super(),this.upstream=null!=e?e:new f}makeLogger(e){let t=this.upstream.makeLogger(e);return(e,...r)=>{var i;let n=JSON.stringify(Object.assign({severity:null!==(i=e.severity)&&void 0!==i?i:s.INFO,message:u.format(...r)},e));t(e,n)}}setFilters(){this.upstream.setFilters()}}t.env={nodeEnables:"GOOGLE_SDK_NODE_LOGGING"};let v=new Map;function _(e,r){let s;if(!l.env[t.env.nodeEnables]||!e)return t.placeholder;r&&(e=`${r.instance.namespace}:${e}`);let n=v.get(e);if(n)return n.func;if(null===i)return t.placeholder;void 0===i&&(i=g());let o=new d(e,(t,...r)=>{if(s!==i){if(null===i)return;void 0===i&&(i=g()),s=i}null==i||i.log(e,t,...r)});return v.set(e,o),o.func}},63184:(e,t,r)=>{"use strict";var i,s,n,o,a,c,l,u,h=function(e,t,r,i){if("a"===r&&!i)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)},d=function(e,t,r,i,s){if("m"===i)throw TypeError("Private method is not writable");if("a"===i&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?s.call(e,r):s?s.value=r:t.set(e,r),r};Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleToken=void 0;let p=r(57147),f=r(49741),g=r(55506),y=r(71017),m=r(73837),v=p.readFile?(0,m.promisify)(p.readFile):async()=>{throw new E("use key rather than keyFile.","MISSING_CREDENTIALS")},_="https://www.googleapis.com/oauth2/v4/token";class E extends Error{constructor(e,t){super(e),this.code=t}}class w{get accessToken(){return this.rawToken?this.rawToken.access_token:void 0}get idToken(){return this.rawToken?this.rawToken.id_token:void 0}get tokenType(){return this.rawToken?this.rawToken.token_type:void 0}get refreshToken(){return this.rawToken?this.rawToken.refresh_token:void 0}constructor(e){i.add(this),this.transporter={request:e=>(0,f.request)(e)},s.set(this,void 0),h(this,i,"m",l).call(this,e)}hasExpired(){let e=new Date().getTime();return!this.rawToken||!this.expiresAt||e>=this.expiresAt}isTokenExpiring(){var e;let t=new Date().getTime(),r=null!==(e=this.eagerRefreshThresholdMillis)&&void 0!==e?e:0;return!this.rawToken||!this.expiresAt||this.expiresAt<=t+r}getToken(e,t={}){if("object"==typeof e&&(t=e,e=void 0),t=Object.assign({forceRefresh:!1},t),e){let r=e;h(this,i,"m",n).call(this,t).then(e=>r(null,e),e);return}return h(this,i,"m",n).call(this,t)}async getCredentials(e){switch(y.extname(e)){case".json":{let t=JSON.parse(await v(e,"utf8")),r=t.private_key,i=t.client_email;if(!r||!i)throw new E("private_key and client_email are required.","MISSING_CREDENTIALS");return{privateKey:r,clientEmail:i}}case".der":case".crt":case".pem":return{privateKey:await v(e,"utf8")};case".p12":case".pfx":throw new E("*.p12 certificates are not supported after v6.1.2. Consider utilizing *.json format or converting *.p12 to *.pem using the OpenSSL CLI.","UNKNOWN_CERTIFICATE_TYPE");default:throw new E("Unknown certificate type. Type is determined based on file extension. Current supported extensions are *.json, and *.pem.","UNKNOWN_CERTIFICATE_TYPE")}}revokeToken(e){if(e){h(this,i,"m",c).call(this).then(()=>e(),e);return}return h(this,i,"m",c).call(this)}}t.GoogleToken=w,s=new WeakMap,i=new WeakSet,n=async function(e){if(h(this,s,"f")&&!e.forceRefresh)return h(this,s,"f");try{return await d(this,s,h(this,i,"m",o).call(this,e),"f")}finally{d(this,s,void 0,"f")}},o=async function(e){if(!1===this.isTokenExpiring()&&!1===e.forceRefresh)return Promise.resolve(this.rawToken);if(!this.key&&!this.keyFile)throw Error("No key or keyFile set.");if(!this.key&&this.keyFile){let e=await this.getCredentials(this.keyFile);this.key=e.privateKey,this.iss=e.clientEmail||this.iss,e.clientEmail||h(this,i,"m",a).call(this)}return h(this,i,"m",u).call(this)},a=function(){if(!this.iss)throw new E("email is required.","MISSING_CREDENTIALS")},c=async function(){if(!this.accessToken)throw Error("No token to revoke.");let e="https://accounts.google.com/o/oauth2/revoke?token="+this.accessToken;await this.transporter.request({url:e,retry:!0}),h(this,i,"m",l).call(this,{email:this.iss,sub:this.sub,key:this.key,keyFile:this.keyFile,scope:this.scope,additionalClaims:this.additionalClaims})},l=function(e={}){this.keyFile=e.keyFile,this.key=e.key,this.rawToken=void 0,this.iss=e.email||e.iss,this.sub=e.sub,this.additionalClaims=e.additionalClaims,"object"==typeof e.scope?this.scope=e.scope.join(" "):this.scope=e.scope,this.eagerRefreshThresholdMillis=e.eagerRefreshThresholdMillis,e.transporter&&(this.transporter=e.transporter)},u=async function(){var e,t;let r=Math.floor(new Date().getTime()/1e3),i=this.additionalClaims||{},s=Object.assign({iss:this.iss,scope:this.scope,aud:_,exp:r+3600,iat:r,sub:this.sub},i),n=g.sign({header:{alg:"RS256"},payload:s,secret:this.key});try{let e=await this.transporter.request({method:"POST",url:_,data:{grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:n},headers:{"Content-Type":"application/x-www-form-urlencoded"},responseType:"json",retryConfig:{httpMethodsToRetry:["POST"]}});return this.rawToken=e.data,this.expiresAt=null===e.data.expires_in||void 0===e.data.expires_in?void 0:(r+e.data.expires_in)*1e3,this.rawToken}catch(i){this.rawToken=void 0,this.tokenExpires=void 0;let r=i.response&&(null===(e=i.response)||void 0===e?void 0:e.data)?null===(t=i.response)||void 0===t?void 0:t.data:{};if(r.error){let e=r.error_description?`: ${r.error_description}`:"";i.message=`${r.error}${e}`}throw i}}},73256:(e,t,r)=>{"use strict";var i,s=r(59026).Buffer,n=r(6113),o=r(28516),a=r(73837),c="secret must be a string or buffer",l="key must be a string or a buffer",u="function"==typeof n.createPublicKey;function h(e){if(!s.isBuffer(e)&&"string"!=typeof e&&(!u||"object"!=typeof e||"string"!=typeof e.type||"string"!=typeof e.asymmetricKeyType||"function"!=typeof e.export))throw g(l)}function d(e){if(!s.isBuffer(e)&&"string"!=typeof e&&"object"!=typeof e)throw g("key must be a string, a buffer or an object")}function p(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function f(e){var t=4-(e=e.toString()).length%4;if(4!==t)for(var r=0;r<t;++r)e+="=";return e.replace(/\-/g,"+").replace(/_/g,"/")}function g(e){var t=[].slice.call(arguments,1);return TypeError(a.format.bind(a,e).apply(null,t))}function y(e){var t;return t=e,s.isBuffer(t)||"string"==typeof t||(e=JSON.stringify(e)),e}function m(e){return function(t,r){(function(e){if(!s.isBuffer(e)&&"string"!=typeof e&&(!u||"object"!=typeof e||"secret"!==e.type||"function"!=typeof e.export))throw g(c)})(r),t=y(t);var i=n.createHmac("sha"+e,r);return p((i.update(t),i.digest("base64")))}}u&&(l+=" or a KeyObject",c+="or a KeyObject");var v="timingSafeEqual"in n?function(e,t){return e.byteLength===t.byteLength&&n.timingSafeEqual(e,t)}:function(e,t){return i||(i=r(69756)),i(e,t)};function _(e){return function(t,r,i){var n=m(e)(t,i);return v(s.from(r),s.from(n))}}function E(e){return function(t,r){d(r),t=y(t);var i=n.createSign("RSA-SHA"+e);return p((i.update(t),i.sign(r,"base64")))}}function w(e){return function(t,r,i){h(i),t=y(t),r=f(r);var s=n.createVerify("RSA-SHA"+e);return s.update(t),s.verify(i,r,"base64")}}function A(e){return function(t,r){d(r),t=y(t);var i=n.createSign("RSA-SHA"+e);return p((i.update(t),i.sign({key:r,padding:n.constants.RSA_PKCS1_PSS_PADDING,saltLength:n.constants.RSA_PSS_SALTLEN_DIGEST},"base64")))}}function T(e){return function(t,r,i){h(i),t=y(t),r=f(r);var s=n.createVerify("RSA-SHA"+e);return s.update(t),s.verify({key:i,padding:n.constants.RSA_PKCS1_PSS_PADDING,saltLength:n.constants.RSA_PSS_SALTLEN_DIGEST},r,"base64")}}function b(e){var t=E(e);return function(){var r=t.apply(null,arguments);return o.derToJose(r,"ES"+e)}}function S(e){var t=w(e);return function(r,i,s){return t(r,i=o.joseToDer(i,"ES"+e).toString("base64"),s)}}function k(){return function(){return""}}function O(){return function(e,t){return""===t}}e.exports=function(e){var t=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/);if(!t)throw g('"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',e);var r=(t[1]||t[3]).toLowerCase(),i=t[2];return{sign:({hs:m,rs:E,ps:A,es:b,none:k})[r](i),verify:({hs:_,rs:w,ps:T,es:S,none:O})[r](i)}}},55506:(e,t,r)=>{var i=r(25462),s=r(31139);t.ALGORITHMS=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"],t.sign=i.sign,t.verify=s.verify,t.decode=s.decode,t.isValid=s.isValid,t.createSign=function(e){return new i(e)},t.createVerify=function(e){return new s(e)}},18394:(e,t,r)=>{"use strict";var i=r(59026).Buffer,s=r(12781);function n(e){if(this.buffer=null,this.writable=!0,this.readable=!0,!e)return this.buffer=i.alloc(0),this;if("function"==typeof e.pipe)return this.buffer=i.alloc(0),e.pipe(this),this;if(e.length||"object"==typeof e)return this.buffer=e,this.writable=!1,process.nextTick((function(){this.emit("end",e),this.readable=!1,this.emit("close")}).bind(this)),this;throw TypeError("Unexpected data type ("+typeof e+")")}r(73837).inherits(n,s),n.prototype.write=function(e){this.buffer=i.concat([this.buffer,i.from(e)]),this.emit("data",e)},n.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1},e.exports=n},25462:(e,t,r)=>{"use strict";var i=r(59026).Buffer,s=r(18394),n=r(73256),o=r(12781),a=r(9820),c=r(73837);function l(e,t){return i.from(e,t).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function u(e){var t,r,i,s=e.header,o=e.payload,u=e.secret||e.privateKey,h=e.encoding,d=n(s.alg),p=(t=(t=h)||"utf8",r=l(a(s),"binary"),i=l(a(o),t),c.format("%s.%s",r,i)),f=d.sign(p,u);return c.format("%s.%s",p,f)}function h(e){var t=new s(e.secret||e.privateKey||e.key);this.readable=!0,this.header=e.header,this.encoding=e.encoding,this.secret=this.privateKey=this.key=t,this.payload=new s(e.payload),this.secret.once("close",(function(){!this.payload.writable&&this.readable&&this.sign()}).bind(this)),this.payload.once("close",(function(){!this.secret.writable&&this.readable&&this.sign()}).bind(this))}c.inherits(h,o),h.prototype.sign=function(){try{var e=u({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},h.sign=u,e.exports=h},9820:(e,t,r)=>{"use strict";var i=r(14300).Buffer;e.exports=function(e){return"string"==typeof e?e:"number"==typeof e||i.isBuffer(e)?e.toString():JSON.stringify(e)}},31139:(e,t,r)=>{"use strict";var i=r(59026).Buffer,s=r(18394),n=r(73256),o=r(12781),a=r(9820),c=r(73837),l=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function u(e){var t=e.split(".",1)[0];return function(e){if("[object Object]"===Object.prototype.toString.call(e))return e;try{return JSON.parse(e)}catch(e){return}}(i.from(t,"base64").toString("binary"))}function h(e){return e.split(".")[2]}function d(e){return l.test(e)&&!!u(e)}function p(e,t,r){if(!t){var i=Error("Missing algorithm parameter for jws.verify");throw i.code="MISSING_ALGORITHM",i}var s=h(e=a(e)),o=e.split(".",2).join(".");return n(t).verify(o,s,r)}function f(e,t){if(t=t||{},!d(e=a(e)))return null;var r,s,n=u(e);if(!n)return null;var o=(r=r||"utf8",s=e.split(".")[1],i.from(s,"base64").toString(r));return("JWT"===n.typ||t.json)&&(o=JSON.parse(o,t.encoding)),{header:n,payload:o,signature:h(e)}}function g(e){var t=new s((e=e||{}).secret||e.publicKey||e.key);this.readable=!0,this.algorithm=e.algorithm,this.encoding=e.encoding,this.secret=this.publicKey=this.key=t,this.signature=new s(e.signature),this.secret.once("close",(function(){!this.signature.writable&&this.readable&&this.verify()}).bind(this)),this.signature.once("close",(function(){!this.secret.writable&&this.readable&&this.verify()}).bind(this))}c.inherits(g,o),g.prototype.verify=function(){try{var e=p(this.signature.buffer,this.algorithm,this.key.buffer),t=f(this.signature.buffer,this.encoding);return this.emit("done",e,t),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},g.decode=f,g.isValid=d,g.verify=p,e.exports=g},46489:(e,t,r)=>{"use strict";var i=Object.create?function(e,t,r,i){void 0===i&&(i=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,s)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]},s=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return s(t,e),t},o=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.HttpsProxyAgent=void 0;let a=n(r(41808)),c=n(r(24404)),l=o(r(39491)),u=o(r(7901)),h=r(43041),d=r(57310),p=r(7989),f=(0,u.default)("https-proxy-agent"),g=e=>void 0===e.servername&&e.host&&!a.isIP(e.host)?{...e,servername:e.host}:e;class y extends h.Agent{constructor(e,t){super(t),this.options={path:void 0},this.proxy="string"==typeof e?new d.URL(e):e,this.proxyHeaders=t?.headers??{},f("Creating new HttpsProxyAgent instance: %o",this.proxy.href);let r=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),i=this.proxy.port?parseInt(this.proxy.port,10):"https:"===this.proxy.protocol?443:80;this.connectOpts={ALPNProtocols:["http/1.1"],...t?v(t,"headers"):null,host:r,port:i}}async connect(e,t){let r;let{proxy:i}=this;if(!t.host)throw TypeError('No "host" provided');"https:"===i.protocol?(f("Creating `tls.Socket`: %o",this.connectOpts),r=c.connect(g(this.connectOpts))):(f("Creating `net.Socket`: %o",this.connectOpts),r=a.connect(this.connectOpts));let s="function"==typeof this.proxyHeaders?this.proxyHeaders():{...this.proxyHeaders},n=a.isIPv6(t.host)?`[${t.host}]`:t.host,o=`CONNECT ${n}:${t.port} HTTP/1.1\r
`;if(i.username||i.password){let e=`${decodeURIComponent(i.username)}:${decodeURIComponent(i.password)}`;s["Proxy-Authorization"]=`Basic ${Buffer.from(e).toString("base64")}`}for(let e of(s.Host=`${n}:${t.port}`,s["Proxy-Connection"]||(s["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close"),Object.keys(s)))o+=`${e}: ${s[e]}\r
`;let u=(0,p.parseProxyResponse)(r);r.write(`${o}\r
`);let{connect:h,buffered:d}=await u;if(e.emit("proxyConnect",h),this.emit("proxyConnect",h,e),200===h.statusCode)return(e.once("socket",m),t.secureEndpoint)?(f("Upgrading socket connection to TLS"),c.connect({...v(g(t),"host","path","port"),socket:r})):r;r.destroy();let y=new a.Socket({writable:!1});return y.readable=!0,e.once("socket",e=>{f("Replaying proxy buffer for failed request"),(0,l.default)(e.listenerCount("data")>0),e.push(d),e.push(null)}),y}}function m(e){e.resume()}function v(e,...t){let r;let i={};for(r in e)t.includes(r)||(i[r]=e[r]);return i}y.protocols=["http","https"],t.HttpsProxyAgent=y},7989:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseProxyResponse=void 0;let i=(0,function(e){return e&&e.__esModule?e:{default:e}}(r(7901)).default)("https-proxy-agent:parse-proxy-response");t.parseProxyResponse=function(e){return new Promise((t,r)=>{let s=0,n=[];function o(){let c=e.read();c?function(c){n.push(c),s+=c.length;let l=Buffer.concat(n,s),u=l.indexOf("\r\n\r\n");if(-1===u){i("have not received end of HTTP headers yet..."),o();return}let h=l.slice(0,u).toString("ascii").split("\r\n"),d=h.shift();if(!d)return e.destroy(),r(Error("No header received from proxy CONNECT response"));let p=d.split(" "),f=+p[1],g=p.slice(2).join(" "),y={};for(let t of h){if(!t)continue;let i=t.indexOf(":");if(-1===i)return e.destroy(),r(Error(`Invalid header from proxy CONNECT response: "${t}"`));let s=t.slice(0,i).toLowerCase(),n=t.slice(i+1).trimStart(),o=y[s];"string"==typeof o?y[s]=[o,n]:Array.isArray(o)?o.push(n):y[s]=n}i("got proxy server response: %o %o",d,y),a(),t({connect:{statusCode:f,statusText:g,headers:y},buffered:l})}(c):e.once("readable",o)}function a(){e.removeListener("end",c),e.removeListener("error",l),e.removeListener("readable",o)}function c(){a(),i("onend"),r(Error("Proxy connection ended before receiving CONNECT response"))}function l(e){a(),i("onerror %o",e),r(e)}e.on("error",l),e.on("end",c),o()})}},50761:e=>{"use strict";let t=e=>null!==e&&"object"==typeof e&&"function"==typeof e.pipe;t.writable=e=>t(e)&&!1!==e.writable&&"function"==typeof e._write&&"object"==typeof e._writableState,t.readable=e=>t(e)&&!1!==e.readable&&"function"==typeof e._read&&"object"==typeof e._readableState,t.duplex=e=>t.writable(e)&&t.readable(e),t.transform=e=>t.duplex(e)&&"function"==typeof e._transform,e.exports=t},29532:(e,t,r)=>{"use strict";var i=r(17693).stringify,s=r(19719);e.exports=function(e){return{parse:s(e),stringify:i}},e.exports.parse=s(),e.exports.stringify=i},19719:(e,t,r)=>{"use strict";var i=null;let s=/(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])/,n=/(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)/;e.exports=function(e){var t={strict:!1,storeAsString:!1,alwaysParseAsBig:!1,useNativeBigInt:!1,protoAction:"error",constructorAction:"error"};if(null!=e){if(!0===e.strict&&(t.strict=!0),!0===e.storeAsString&&(t.storeAsString=!0),t.alwaysParseAsBig=!0===e.alwaysParseAsBig&&e.alwaysParseAsBig,t.useNativeBigInt=!0===e.useNativeBigInt&&e.useNativeBigInt,void 0!==e.constructorAction){if("error"===e.constructorAction||"ignore"===e.constructorAction||"preserve"===e.constructorAction)t.constructorAction=e.constructorAction;else throw Error(`Incorrect value for constructorAction option, must be "error", "ignore" or undefined but passed ${e.constructorAction}`)}if(void 0!==e.protoAction){if("error"===e.protoAction||"ignore"===e.protoAction||"preserve"===e.protoAction)t.protoAction=e.protoAction;else throw Error(`Incorrect value for protoAction option, must be "error", "ignore" or undefined but passed ${e.protoAction}`)}}var o,a,c,l,u={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},h=function(e){throw{name:"SyntaxError",message:e,at:o,text:c}},d=function(e){return e&&e!==a&&h("Expected '"+e+"' instead of '"+a+"'"),a=c.charAt(o),o+=1,a},p=function(){var e,s="";for("-"===a&&(s="-",d("-"));a>="0"&&a<="9";)s+=a,d();if("."===a)for(s+=".";d()&&a>="0"&&a<="9";)s+=a;if("e"===a||"E"===a)for(s+=a,d(),("-"===a||"+"===a)&&(s+=a,d());a>="0"&&a<="9";)s+=a,d();if(isFinite(e=+s))return(null==i&&(i=r(69146)),s.length>15)?t.storeAsString?s:t.useNativeBigInt?BigInt(s):new i(s):t.alwaysParseAsBig?t.useNativeBigInt?BigInt(e):new i(e):e;h("Bad number")},f=function(){var e,t,r,i="";if('"'===a)for(var s=o;d();){if('"'===a)return o-1>s&&(i+=c.substring(s,o-1)),d(),i;if("\\"===a){if(o-1>s&&(i+=c.substring(s,o-1)),d(),"u"===a){for(t=0,r=0;t<4&&isFinite(e=parseInt(d(),16));t+=1)r=16*r+e;i+=String.fromCharCode(r)}else if("string"==typeof u[a])i+=u[a];else break;s=o}}h("Bad string")},g=function(){for(;a&&a<=" ";)d()},y=function(){switch(a){case"t":return d("t"),d("r"),d("u"),d("e"),!0;case"f":return d("f"),d("a"),d("l"),d("s"),d("e"),!1;case"n":return d("n"),d("u"),d("l"),d("l"),null}h("Unexpected '"+a+"'")},m=function(){var e=[];if("["===a){if(d("["),g(),"]"===a)return d("]"),e;for(;a;){if(e.push(l()),g(),"]"===a)return d("]"),e;d(","),g()}}h("Bad array")},v=function(){var e,r=Object.create(null);if("{"===a){if(d("{"),g(),"}"===a)return d("}"),r;for(;a;){if(e=f(),g(),d(":"),!0===t.strict&&Object.hasOwnProperty.call(r,e)&&h('Duplicate key "'+e+'"'),!0===s.test(e)?"error"===t.protoAction?h("Object contains forbidden prototype property"):"ignore"===t.protoAction?l():r[e]=l():!0===n.test(e)?"error"===t.constructorAction?h("Object contains forbidden constructor property"):"ignore"===t.constructorAction?l():r[e]=l():r[e]=l(),g(),"}"===a)return d("}"),r;d(","),g()}}h("Bad object")};return l=function(){switch(g(),a){case"{":return v();case"[":return m();case'"':return f();case"-":return p();default:return a>="0"&&a<="9"?p():y()}},function(e,t){var r;return c=e+"",o=0,a=" ",r=l(),g(),a&&h("Syntax error"),"function"==typeof t?function e(r,i){var s,n=r[i];return n&&"object"==typeof n&&Object.keys(n).forEach(function(t){void 0!==(s=e(n,t))?n[t]=s:delete n[t]}),t.call(r,i,n)}({"":r},""):r}}},17693:(e,t,r)=>{"use strict";var i=r(69146),s=e.exports;!function(){var e,t,r,n=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,o={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function a(e){return n.lastIndex=0,n.test(e)?'"'+e.replace(n,function(e){var t=o[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}"function"!=typeof s.stringify&&(s.stringify=function(s,n,o){var c;if(e="",t="","number"==typeof o)for(c=0;c<o;c+=1)t+=" ";else"string"==typeof o&&(t=o);if(r=n,n&&"function"!=typeof n&&("object"!=typeof n||"number"!=typeof n.length))throw Error("JSON.stringify");return function s(n,o){var c,l,u,h,d,p=e,f=o[n],g=null!=f&&(f instanceof i||i.isBigNumber(f));switch(f&&"object"==typeof f&&"function"==typeof f.toJSON&&(f=f.toJSON(n)),"function"==typeof r&&(f=r.call(o,n,f)),typeof f){case"string":if(g)return f;return a(f);case"number":return isFinite(f)?String(f):"null";case"boolean":case"null":case"bigint":return String(f);case"object":if(!f)return"null";if(e+=t,d=[],"[object Array]"===Object.prototype.toString.apply(f)){for(c=0,h=f.length;c<h;c+=1)d[c]=s(c,f)||"null";return u=0===d.length?"[]":e?"[\n"+e+d.join(",\n"+e)+"\n"+p+"]":"["+d.join(",")+"]",e=p,u}if(r&&"object"==typeof r)for(c=0,h=r.length;c<h;c+=1)"string"==typeof r[c]&&(u=s(l=r[c],f))&&d.push(a(l)+(e?": ":":")+u);else Object.keys(f).forEach(function(t){var r=s(t,f);r&&d.push(a(t)+(e?": ":":")+r)});return u=0===d.length?"{}":e?"{\n"+e+d.join(",\n"+e)+"\n"+p+"}":"{"+d.join(",")+"}",e=p,u}}("",{"":s})})}()},81494:(e,t,r)=>{"use strict";r.d(t,{_:()=>s});var i=r(53524);let s=globalThis.prisma??new i.PrismaClient({log:["query","error","warn"],datasources:{db:{url:process.env.DATABASE_URL}}});(async(e=3,t=1e3)=>{for(let r=0;r<e;r++)try{await s.$connect(),console.log("Successfully connected to MongoDB via Prisma");return}catch(i){console.error(`Failed to connect to database (attempt ${r+1}/${e}):`,i),r===e-1&&(console.error("Max retries reached. Exiting process..."),process.exit(1)),console.log(`Retrying in ${t}ms...`),await new Promise(e=>setTimeout(e,t))}})()},17408:e=>{"use strict";e.exports=JSON.parse('{"name":"gaxios","version":"6.7.1","description":"A simple common HTTP client specifically for Google APIs and services.","main":"build/src/index.js","types":"build/src/index.d.ts","files":["build/src"],"scripts":{"lint":"gts check","test":"c8 mocha build/test","presystem-test":"npm run compile","system-test":"mocha build/system-test --timeout 80000","compile":"tsc -p .","fix":"gts fix","prepare":"npm run compile","pretest":"npm run compile","webpack":"webpack","prebrowser-test":"npm run compile","browser-test":"node build/browser-test/browser-test-runner.js","docs":"compodoc src/","docs-test":"linkinator docs","predocs-test":"npm run docs","samples-test":"cd samples/ && npm link ../ && npm test && cd ../","prelint":"cd samples; npm link ../; npm install","clean":"gts clean","precompile":"gts clean"},"repository":"googleapis/gaxios","keywords":["google"],"engines":{"node":">=14"},"author":"Google, LLC","license":"Apache-2.0","devDependencies":{"@babel/plugin-proposal-private-methods":"^7.18.6","@compodoc/compodoc":"1.1.19","@types/cors":"^2.8.6","@types/express":"^4.16.1","@types/extend":"^3.0.1","@types/mocha":"^9.0.0","@types/multiparty":"0.0.36","@types/mv":"^2.1.0","@types/ncp":"^2.0.1","@types/node":"^20.0.0","@types/node-fetch":"^2.5.7","@types/sinon":"^17.0.0","@types/tmp":"0.2.6","@types/uuid":"^10.0.0","abort-controller":"^3.0.0","assert":"^2.0.0","browserify":"^17.0.0","c8":"^8.0.0","cheerio":"1.0.0-rc.10","cors":"^2.8.5","execa":"^5.0.0","express":"^4.16.4","form-data":"^4.0.0","gts":"^5.0.0","is-docker":"^2.0.0","karma":"^6.0.0","karma-chrome-launcher":"^3.0.0","karma-coverage":"^2.0.0","karma-firefox-launcher":"^2.0.0","karma-mocha":"^2.0.0","karma-remap-coverage":"^0.1.5","karma-sourcemap-loader":"^0.4.0","karma-webpack":"5.0.0","linkinator":"^3.0.0","mocha":"^8.0.0","multiparty":"^4.2.1","mv":"^2.1.1","ncp":"^2.0.0","nock":"^13.0.0","null-loader":"^4.0.0","puppeteer":"^19.0.0","sinon":"^18.0.0","stream-browserify":"^3.0.0","tmp":"0.2.3","ts-loader":"^8.0.0","typescript":"^5.1.6","webpack":"^5.35.0","webpack-cli":"^4.0.0"},"dependencies":{"extend":"^3.0.2","https-proxy-agent":"^7.0.1","is-stream":"^2.0.0","node-fetch":"^2.6.9","uuid":"^9.0.1"}}')},78688:e=>{"use strict";e.exports=JSON.parse('{"name":"google-auth-library","version":"9.15.1","author":"Google Inc.","description":"Google APIs Authentication Client Library for Node.js","engines":{"node":">=14"},"main":"./build/src/index.js","types":"./build/src/index.d.ts","repository":"googleapis/google-auth-library-nodejs.git","keywords":["google","api","google apis","client","client library"],"dependencies":{"base64-js":"^1.3.0","ecdsa-sig-formatter":"^1.0.11","gaxios":"^6.1.1","gcp-metadata":"^6.1.0","gtoken":"^7.0.0","jws":"^4.0.0"},"devDependencies":{"@types/base64-js":"^1.2.5","@types/chai":"^4.1.7","@types/jws":"^3.1.0","@types/mocha":"^9.0.0","@types/mv":"^2.1.0","@types/ncp":"^2.0.1","@types/node":"^20.4.2","@types/sinon":"^17.0.0","assert-rejects":"^1.0.0","c8":"^8.0.0","chai":"^4.2.0","cheerio":"1.0.0-rc.12","codecov":"^3.0.2","engine.io":"6.6.2","gts":"^5.0.0","is-docker":"^2.0.0","jsdoc":"^4.0.0","jsdoc-fresh":"^3.0.0","jsdoc-region-tag":"^3.0.0","karma":"^6.0.0","karma-chrome-launcher":"^3.0.0","karma-coverage":"^2.0.0","karma-firefox-launcher":"^2.0.0","karma-mocha":"^2.0.0","karma-sourcemap-loader":"^0.4.0","karma-webpack":"5.0.0","keypair":"^1.0.4","linkinator":"^4.0.0","mocha":"^9.2.2","mv":"^2.1.1","ncp":"^2.0.0","nock":"^13.0.0","null-loader":"^4.0.0","pdfmake":"0.2.12","puppeteer":"^21.0.0","sinon":"^18.0.0","ts-loader":"^8.0.0","typescript":"^5.1.6","webpack":"^5.21.2","webpack-cli":"^4.0.0"},"files":["build/src","!build/src/**/*.map"],"scripts":{"test":"c8 mocha build/test","clean":"gts clean","prepare":"npm run compile","lint":"gts check","compile":"tsc -p .","fix":"gts fix","pretest":"npm run compile -- --sourceMap","docs":"jsdoc -c .jsdoc.json","samples-setup":"cd samples/ && npm link ../ && npm run setup && cd ../","samples-test":"cd samples/ && npm link ../ && npm test && cd ../","system-test":"mocha build/system-test --timeout 60000","presystem-test":"npm run compile -- --sourceMap","webpack":"webpack","browser-test":"karma start","docs-test":"linkinator docs","predocs-test":"npm run docs","prelint":"cd samples; npm link ../; npm install","precompile":"gts clean"},"license":"Apache-2.0"}')}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[1638,6206,6082,319,7901],()=>r(87951));module.exports=i})();