"use strict";(()=>{var e={};e.id=146,e.ids=[146],e.modules={53524:e=>{e.exports=require("@prisma/client")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},60965:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>m,originalPathname:()=>w,patchFetch:()=>v,requestAsyncStorage:()=>p,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>f});var a={};t.r(a),t.d(a,{GET:()=>l,POST:()=>c});var n=t(95419),o=t(69108),s=t(99678),i=t(78070),u=t(81494);async function l(e){try{let{searchParams:r}=new URL(e.url),t=r.get("userId"),a=parseInt(r.get("page")||"1"),n=parseInt(r.get("limit")||"10");if(!t)return i.Z.json({error:"User ID is required"},{status:400});let o=await u._.preferences.findUnique({where:{userId:t}});if(!o)return i.Z.json({error:"User preferences not found"},{status:404});let s={AND:[{user:{dob:{gte:new Date(new Date().setFullYear(new Date().getFullYear()-(o.ageTo||100))),lte:new Date(new Date().setFullYear(new Date().getFullYear()-(o.ageFrom||18)))},gender:o.maritalStatus||void 0}},{NOT:{userId:t}}]},[l,c]=await Promise.all([u._.profile.findMany({where:s,include:{user:{include:{photos:{where:{isProfile:!0},take:1}}}},skip:(a-1)*n,take:n}),u._.profile.count({where:s})]);return i.Z.json({profiles:l,total:c,page:a,totalPages:Math.ceil(c/n)})}catch(e){return console.error("Error fetching dating profiles:",e),i.Z.json({error:"Internal server error"},{status:500})}}async function c(e){try{let{userId:r,restaurant:t,date:a,time:n}=await e.json();if(!r||!t||!a||!n)return i.Z.json({error:"Missing required fields"},{status:400});return i.Z.json({error:"Restaurant booking functionality not implemented yet"},{status:501})}catch(e){return console.error("Error creating restaurant booking:",e),i.Z.json({error:"Internal server error"},{status:500})}}let d=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/dating/route",pathname:"/api/dating",filename:"route",bundlePath:"app/api/dating/route"},resolvedPagePath:"/home/subvivah/htdocs/subvivah.com/src/app/api/dating/route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:p,staticGenerationAsyncStorage:g,serverHooks:h,headerHooks:m,staticGenerationBailout:f}=d,w="/api/dating/route";function v(){return(0,s.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:g})}},81494:(e,r,t)=>{t.d(r,{_:()=>n});var a=t(53524);let n=globalThis.prisma??new a.PrismaClient({log:["query","error","warn"],datasources:{db:{url:process.env.DATABASE_URL}}});(async(e=3,r=1e3)=>{for(let t=0;t<e;t++)try{await n.$connect(),console.log("Successfully connected to MongoDB via Prisma");return}catch(a){console.error(`Failed to connect to database (attempt ${t+1}/${e}):`,a),t===e-1&&(console.error("Max retries reached. Exiting process..."),process.exit(1)),console.log(`Retrying in ${r}ms...`),await new Promise(e=>setTimeout(e,r))}})()}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[1638,6206],()=>t(60965));module.exports=a})();