(()=>{var e={};e.id=638,e.ids=[638],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},71017:e=>{"use strict";e.exports=require("path")},57310:e=>{"use strict";e.exports=require("url")},16202:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>o.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>d,routeModule:()=>h,tree:()=>c});var r=s(50482),a=s(69108),l=s(62563),o=s.n(l),i=s(68300),n={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>i[e]);s.d(t,n);let c=["",{children:["profile",{children:["photos",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,71549)),"/home/subvivah/htdocs/subvivah.com/src/app/profile/photos/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,36107)),"/home/subvivah/htdocs/subvivah.com/src/app/layout.tsx"],error:[()=>Promise.resolve().then(s.bind(s,24117)),"/home/subvivah/htdocs/subvivah.com/src/app/error.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,69361,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["/home/subvivah/htdocs/subvivah.com/src/app/profile/photos/page.tsx"],p="/profile/photos/page",u={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/profile/photos/page",pathname:"/profile/photos",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},25376:(e,t,s)=>{Promise.resolve().then(s.bind(s,48091))},51765:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(97075).Z)("camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},89410:(e,t,s)=>{"use strict";s.d(t,{default:()=>a.a});var r=s(37412),a=s.n(r)},37412:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{getImageProps:function(){return i},default:function(){return n}});let r=s(22098),a=s(83855),l=s(31900),o=r._(s(74931)),i=e=>{let{props:t}=(0,a.getImgProps)(e,{defaultLoader:o.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0}});for(let[e,s]of Object.entries(t))void 0===s&&delete t[e];return{props:t}},n=l.Image},48091:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var r=s(95344),a=s(3729),l=s(89410),o=s(8428),i=s(54540),n=s(97075);let c=(0,n.Z)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),d=(0,n.Z)("upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),p=(0,n.Z)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var u=s(51354);let h=(0,n.Z)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var x=s(14513),m=s(51765);let f=(0,i.Z)(function(){let[e,t]=(0,a.useState)(null),[s,i]=(0,a.useState)(!0),[n,f]=(0,a.useState)(null),[g,b]=(0,a.useState)(!1),[v,y]=(0,a.useState)(null),[j,w]=(0,a.useState)(""),[N,k]=(0,a.useState)(!1),[P,C]=(0,a.useState)(null),[S,z]=(0,a.useState)(new Set),[_,q]=(0,a.useState)(0),[E,M]=(0,a.useState)("idle"),Z=(0,o.useRouter)();(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/auth/me");if(e.ok){let s=await e.json();t(s.user)}}catch(e){console.error("Error fetching user:",e)}finally{i(!1)}})()},[]);let U=()=>{f(null)},A=t=>{t.stopPropagation(),null!==n&&e?.photos&&f((n-1+e.photos.length)%e.photos.length)},D=t=>{t.stopPropagation(),null!==n&&e?.photos&&f((n+1)%e.photos.length)},G=async()=>{if(v){k(!0),M("uploading");try{let e=new FormData;if(e.append("file",v),e.append("caption",j),(await fetch("/api/photos/upload",{method:"POST",body:e})).ok){M("success");let e=await fetch("/api/auth/me");if(e.ok){let s=await e.json();t(s.user)}b(!1),y(null),w("")}else M("error")}catch(e){M("error"),console.error("Error uploading photo:",e)}finally{k(!1)}}},L=async s=>{if(e?.photos)try{if((await fetch("/api/photos/delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({photoUrl:e.photos[s].url})})).ok){let e=await fetch("/api/auth/me");if(e.ok){let s=await e.json();t(s.user)}f(null)}}catch(e){console.error("Error deleting photo:",e)}},O=e=>{z(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})};if(s)return(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-indigo-950 via-purple-900 to-indigo-950 flex items-center justify-center relative overflow-hidden",children:[r.jsx("div",{className:"absolute inset-0 backdrop-blur-md z-0"}),(0,r.jsxs)("div",{className:"relative z-10 flex flex-col items-center",children:[(0,r.jsxs)("svg",{className:"animate-spin h-14 w-14 text-purple-300 mb-4",viewBox:"0 0 50 50",children:[r.jsx("circle",{className:"opacity-20",cx:"25",cy:"25",r:"20",stroke:"currentColor",strokeWidth:"5",fill:"none"}),r.jsx("circle",{className:"opacity-70",cx:"25",cy:"25",r:"20",stroke:"currentColor",strokeWidth:"5",fill:"none",strokeDasharray:"31.4 94.2"})]}),r.jsx("span",{className:"text-purple-200 text-lg font-medium animate-pulse",children:"Loading photos..."})]})]});if(!e)return null;let T=e.photos||[];return T[_],(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-indigo-950 via-purple-900 to-indigo-950 py-10 flex flex-col items-center relative overflow-hidden",children:[r.jsx("div",{className:"absolute top-4 right-8 animate-pulse text-amber-200 text-4xl z-10",children:"\uD83D\uDCF8"}),(0,r.jsxs)("div",{className:"w-full max-w-2xl mx-auto px-2 sm:px-4 lg:px-6",children:[(0,r.jsxs)("div",{className:"mb-8 flex flex-col gap-2 items-start w-full",children:[(0,r.jsxs)("button",{onClick:()=>Z.back(),className:"flex items-center text-purple-200 hover:text-purple-100 mb-1 transition-colors",children:[r.jsx(c,{className:"w-5 h-5 mr-1"}),"Back to Profile"]}),(0,r.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,r.jsxs)("div",{className:"text-left",children:[r.jsx("h1",{className:"text-3xl font-bold text-white",children:"Photo Gallery"}),r.jsx("p",{className:"text-purple-200 mt-1 text-base",children:"Swipe or use arrows to browse your photos"})]}),(0,r.jsxs)("button",{onClick:()=>b(!0),className:"flex items-center gap-2 px-4 py-2 bg-purple-500/20 text-purple-200 rounded-lg hover:bg-purple-500/30 transition-colors border border-purple-400/30 shadow-md",children:[r.jsx(d,{className:"w-5 h-5"}),"Upload Photo"]})]})]}),T.length>0?r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-6",children:T.map((e,t)=>(0,r.jsxs)("div",{className:"relative group rounded-xl overflow-hidden shadow-lg bg-white/10 hover:shadow-xl transition-all cursor-pointer flex flex-col border border-purple-400/30 hover:bg-white/20",onClick:()=>f(t),children:[r.jsx("div",{className:"relative w-full aspect-square bg-gradient-to-br from-purple-500/20 to-pink-500/20",children:r.jsx(l.default,{src:e.url,alt:`Photo ${t+1}`,fill:!0,className:"object-cover w-full h-full transition-transform duration-200 group-hover:scale-105",sizes:"300px"})}),r.jsx("div",{className:"p-2 text-center bg-gradient-to-t from-purple-900/90 to-purple-900/60 backdrop-blur-sm",children:r.jsx("p",{className:"text-sm text-purple-200 truncate min-h-[1.5em]",children:e.caption||r.jsx("span",{className:"text-purple-300/50",children:"No caption"})})})]},t))}):r.jsx("div",{className:"text-center text-gray-400 py-12",children:"No photos uploaded yet."}),null!==n&&T.length>0&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",onClick:U,children:(0,r.jsxs)("div",{className:"relative flex flex-col items-center bg-gradient-to-br from-indigo-950/95 via-purple-900/95 to-indigo-950/95 backdrop-blur-lg rounded-2xl shadow-xl p-4 transition-all duration-300 max-w-2xl w-full border border-purple-400/30",onClick:e=>e.stopPropagation(),onTouchStart:e=>{C(e.touches[0].clientX)},onTouchEnd:e=>{if(!P)return;let t=P-e.changedTouches[0].clientX;Math.abs(t)>50&&(t>0?D(e):A(e)),C(null)},style:{minHeight:"480px"},children:[T.length>1&&r.jsx("div",{className:"absolute left-0 top-1/2 -translate-y-1/2 w-1/4 h-3/4 flex items-center justify-end z-10 pointer-events-none",style:{filter:"blur(4px)",opacity:.5},children:(0,r.jsxs)("div",{className:"relative w-24 h-40 rounded-xl overflow-hidden bg-gradient-to-br from-purple-100 to-pink-100 shadow-md",children:[r.jsx(l.default,{src:T[(n-1+T.length)%T.length].url,alt:"Previous",fill:!0,className:"object-cover",sizes:"100px"}),r.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/80 to-transparent"})]})}),T.length>1&&r.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 w-1/4 h-3/4 flex items-center justify-start z-10 pointer-events-none",style:{filter:"blur(4px)",opacity:.5},children:(0,r.jsxs)("div",{className:"relative w-24 h-40 rounded-xl overflow-hidden bg-gradient-to-br from-purple-100 to-pink-100 shadow-md",children:[r.jsx(l.default,{src:T[(n+1)%T.length].url,alt:"Next",fill:!0,className:"object-cover",sizes:"100px"}),r.jsx("div",{className:"absolute inset-0 bg-gradient-to-l from-white/80 to-transparent"})]})}),r.jsx("button",{className:"absolute left-2 top-1/2 -translate-y-1/2 bg-white/80 hover:bg-purple-100 text-purple-700 rounded-full p-2 z-20 shadow-md",onClick:A,"aria-label":"Previous photo",style:{transition:"background 0.2s"},children:r.jsx(c,{className:"w-8 h-8"})}),r.jsx("button",{className:"absolute right-2 top-1/2 -translate-y-1/2 bg-white/80 hover:bg-purple-100 text-purple-700 rounded-full p-2 z-20 shadow-md",onClick:D,"aria-label":"Next photo",style:{transition:"background 0.2s"},children:r.jsx(p,{className:"w-8 h-8"})}),r.jsx("div",{className:"w-full aspect-[4/5] max-h-[400px] relative bg-gradient-to-br from-purple-100 to-pink-100 rounded-xl overflow-hidden flex items-center justify-center transition-all duration-300",children:r.jsx(l.default,{src:T[n].url,alt:`Photo ${n+1}`,fill:!0,className:"object-contain",sizes:"400px",priority:!0})}),r.jsx("button",{className:`mt-6 mb-2 bg-white/80 rounded-full p-3 shadow-md hover:bg-pink-100 transition-colors ${S.has(n)?"text-pink-600":"text-gray-400"}`,onClick:()=>O(n),"aria-label":"Like photo",children:r.jsx(u.Z,{className:`w-8 h-8 transition-transform ${S.has(n)?"scale-110 fill-pink-500":""}`,fill:S.has(n)?"#ec4899":"none"})}),r.jsx("div",{className:"w-full text-center px-2",children:r.jsx("p",{className:"text-lg text-gray-800 font-medium min-h-[2em] break-words whitespace-pre-line bg-gradient-to-t from-white/80 to-transparent rounded-lg py-2 px-3 shadow-sm inline-block",children:T[n].caption||r.jsx("span",{className:"text-gray-400",children:"No caption"})})}),(0,r.jsxs)("div",{className:"mt-2 text-sm text-gray-400",children:[n+1," / ",T.length]}),(0,r.jsxs)("button",{className:"mt-4 flex items-center gap-2 px-4 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors",onClick:()=>L(n),children:[r.jsx(h,{className:"w-5 h-5"}),"Delete Photo"]}),r.jsx("button",{className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700 bg-white/80 rounded-full p-2 z-30",onClick:U,"aria-label":"Close modal",children:r.jsx(x.Z,{className:"w-6 h-6"})})]})}),g&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h2",{className:"text-xl font-semibold",children:"Upload Photo"}),r.jsx("button",{onClick:()=>b(!1),className:"text-gray-500 hover:text-gray-700",children:r.jsx(x.Z,{className:"w-6 h-6"})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:v?(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx("div",{className:"relative w-[200px] h-[200px] mx-auto",children:r.jsx(l.default,{src:URL.createObjectURL(v),alt:"Preview",fill:!0,className:"rounded-lg object-cover",sizes:"200px"})}),r.jsx("p",{className:"text-sm text-gray-600",children:v.name})]}):(0,r.jsxs)("label",{className:"cursor-pointer",children:[r.jsx(m.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),r.jsx("p",{className:"text-gray-600",children:"Click to select a photo"}),r.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:e=>{let t=e.target.files?.[0];t&&y(t)}})]})}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Caption"}),r.jsx("textarea",{value:j,onChange:e=>w(e.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500",rows:3,placeholder:"Add a caption to your photo..."})]}),r.jsx("button",{onClick:G,disabled:!v||N,className:"w-full py-2 px-4 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed",children:N?"Uploading...":"Upload Photo"}),"uploading"===E&&r.jsx("div",{className:"text-center text-purple-600 my-2",children:"Uploading..."}),"success"===E&&r.jsx("div",{className:"text-center text-green-600 my-2",children:"Upload successful!"}),"error"===E&&r.jsx("div",{className:"text-center text-red-600 my-2",children:"Upload failed. Please try again."})]})]})})]})]})})},54540:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var r=s(95344),a=s(3729),l=s(8428);function o(e){return function(t){let[s,o]=(0,a.useState)(!0),[i,n]=(0,a.useState)(!1),[c,d]=(0,a.useState)(null);return((0,l.useRouter)(),(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/auth/me"),t=await e.json();t.isAuthenticated&&t.user?(n(!0),d(t.user)):(n(!1),d(null))}catch(e){console.error("Auth check error:",e),n(!1),d(null)}finally{o(!1)}})()},[]),s)?(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-indigo-950 via-purple-900 to-indigo-950 flex items-center justify-center relative overflow-hidden",children:[r.jsx("div",{className:"absolute inset-0 backdrop-blur-md z-0"}),(0,r.jsxs)("div",{className:"relative z-10 flex flex-col items-center",children:[(0,r.jsxs)("svg",{className:"animate-spin h-14 w-14 text-purple-300 mb-4",viewBox:"0 0 50 50",children:[r.jsx("circle",{className:"opacity-20",cx:"25",cy:"25",r:"20",stroke:"currentColor",strokeWidth:"5",fill:"none"}),r.jsx("circle",{className:"opacity-70",cx:"25",cy:"25",r:"20",stroke:"currentColor",strokeWidth:"5",fill:"none",strokeDasharray:"31.4 94.2"})]}),r.jsx("span",{className:"text-purple-200 text-lg font-medium animate-pulse",children:"Loading..."})]})]}):i&&c?r.jsx(e,{...t,user:c}):null}}},71549:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>l,__esModule:()=>a,default:()=>o});let r=(0,s(86843).createProxy)(String.raw`/home/subvivah/htdocs/subvivah.com/src/app/profile/photos/page.tsx`),{__esModule:a,$$typeof:l}=r,o=r.default},73881:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var r=s(70337);let a=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,r.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[1638,5547,337,1900,4522],()=>s(16202));module.exports=r})();